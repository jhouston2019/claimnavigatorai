<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Response Center - ClaimNavigatorAI</title>
  <meta name="description" content="AI-powered claim response center with document library, AI response generation, and claim analysis tools.">
  <style>
    :root {
      --primary: #1e40af;
      --accent: #3b82f6;
      --border: #e5e7eb;
      --text-secondary: #6b7280;
      --bg-light: #f9fafb;
    }
    body { font-family: Arial, sans-serif; margin:0; padding:0; background:#fff; }
    header { background:#0f172a; padding:1rem; color:#fff; position:sticky; top:0; }
    nav { display:flex; justify-content:space-between; align-items:center; }
    .nav-links { display:flex; gap:1rem; }
    .nav-links a { color:#fff; text-decoration:none; }
    .main-content { padding:2rem; }
    .tabs { display:flex; border-bottom:2px solid var(--border); margin-bottom:1.5rem; }
    .tab { padding:1rem; cursor:pointer; }
    .tab.active { border-bottom:3px solid var(--primary); font-weight:bold; }
    .tab-content { display:none; }
    .tab-content.active { display:block; }
    .btn-primary { background:var(--primary); color:#fff; border:none; border-radius:0.5rem; padding:0.5rem 1rem; cursor:pointer; }
    .btn-secondary { background:var(--accent); color:#fff; border:none; border-radius:0.5rem; padding:0.5rem 1rem; cursor:pointer; }
    .tool-grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(320px,1fr)); gap:1rem; }
    .tool-card { background:var(--bg-light); padding:1rem; border:1px solid var(--border); border-radius:0.5rem; }
    .tool-title { font-weight:bold; margin-bottom:0.5rem; }
    .tool-desc { font-size:0.9rem; color:var(--text-secondary); margin-bottom:0.5rem; }
    .tool-output { display:none; background:#fff; border:1px solid var(--border); border-radius:0.5rem; padding:0.75rem; white-space:pre-wrap; margin-top:0.5rem; min-height:80px; }
    .action-buttons { display:flex; gap:0.5rem; flex-wrap:wrap; margin-top:0.5rem; }
    .spinner { border:3px solid #f3f3f3; border-top:3px solid var(--primary); border-radius:50%; width:18px; height:18px; animation:spin 1s linear infinite; display:inline-block; }
    @keyframes spin { 0% { transform:rotate(0deg);} 100%{ transform:rotate(360deg);} }
  </style>
</head>
<body>
  <header>
    <nav>
      <div class="logo">ClaimNavigatorAI</div>
      <div class="nav-links">
        <a href="../index.html">Home</a>
        <a href="../product.html">Product</a>
        <a href="response-center.html">Response Center</a>
        <a href="settings.html">Settings</a>
        <a href="#" onclick="logout()">Logout</a>
      </div>
    </nav>
  </header>

  <main class="main-content">
    <h1>Response Center</h1>
    <p>AI-powered tools to strengthen your claim and generate professional responses</p>

    <!-- Tabs -->
    <div class="tabs">
      <button class="tab active" onclick="switchTab('ai-agent')">AI Response & Analysis Agent</button>
      <button class="tab" onclick="switchTab('my-documents')">My Documents</button>
      <button class="tab" onclick="switchTab('analysis-tools')">Claim Analysis Tools</button>
      <button class="tab" onclick="switchTab('settings')">Settings</button>
    </div>

    <!-- AI Agent -->
    <div id="ai-agent" class="tab-content active">
      <textarea id="input-text" class="tool-output" style="display:block; min-height:120px;" placeholder="Paste insurer correspondence..."></textarea>
      <div class="action-buttons">
        <button class="btn-primary" onclick="generateResponse()">Generate Response</button>
        <button class="btn-primary" onclick="exportDoc('docx')">Export DOCX</button>
        <button class="btn-primary" onclick="exportDoc('pdf')">Export PDF</button>
        <button class="btn-primary" onclick="saveDraft()">Save to My Documents</button>
        <select id="language-select" onchange="setLanguage()" style="padding:0.5rem; border-radius:0.5rem;">
          <option value="en">English</option>
          <option value="es">Espa√±ol</option>
        </select>
      </div>
      <div id="ai-output" class="tool-output"></div>
      <div id="confidence-meter" style="margin-top:0.5rem; font-size:0.9rem; color:var(--text-secondary);"></div>
      <h3>Session History</h3>
      <div id="session-history"></div>
    </div>

    <!-- My Documents -->
    <div id="my-documents" class="tab-content">
      <input type="text" id="doc-search" placeholder="Search documents..." oninput="filterDocuments()" style="width:100%; margin-bottom:1rem; padding:0.5rem;">
      <input type="file" id="doc-upload" onchange="uploadDocument()" style="margin-bottom:1rem;">
      <div id="documents-container"></div>
    </div>

    <!-- Claim Analysis Tools -->
    <div id="analysis-tools" class="tab-content">
      <h2>Claim Analysis Tools</h2>
      <div class="tool-grid">
        <!-- Existing 10 + 4 new -->
        <div class="tool-card"><div class="tool-title">Reserve Inquiry Letter</div><div class="tool-desc">Request insurer reserve information.</div><button class="btn-primary" onclick="runTool('reserve-inquiry')">Generate</button><div id="reserve-inquiry-output" class="tool-output"></div><div id="reserve-inquiry-actions" class="action-buttons" style="display:none;"><button class="btn-primary" onclick="copyToolOutput('reserve-inquiry')">Copy</button><button class="btn-primary" onclick="downloadToolOutput('reserve-inquiry')">Download</button><button class="btn-primary" onclick="clearOutput('reserve-inquiry')">Clear</button></div></div>
        <div class="tool-card"><div class="tool-title">Coverage Letter Analyzer</div><div class="tool-desc">Analyze insurer coverage letters.</div><button class="btn-primary" onclick="runTool('coverage-analyzer')">Generate</button><div id="coverage-analyzer-output" class="tool-output"></div><div id="coverage-analyzer-actions" class="action-buttons" style="display:none;"><button class="btn-primary" onclick="copyToolOutput('coverage-analyzer')">Copy</button><button class="btn-primary" onclick="downloadToolOutput('coverage-analyzer')">Download</button><button class="btn-primary" onclick="clearOutput('coverage-analyzer')">Clear</button></div></div>
        <div class="tool-card"><div class="tool-title">Supplement Request Draft</div><div class="tool-desc">Request additional scope items.</div><button class="btn-primary" onclick="runTool('supplement-request')">Generate</button><div id="supplement-request-output" class="tool-output"></div><div id="supplement-request-actions" class="action-buttons" style="display:none;"><button class="btn-primary" onclick="copyToolOutput('supplement-request')">Copy</button><button class="btn-primary" onclick="downloadToolOutput('supplement-request')">Download</button><button class="btn-primary" onclick="clearOutput('supplement-request')">Clear</button></div></div>
        <div class="tool-card"><div class="tool-title">Proof of Loss Checklist</div><div class="tool-desc">Checklist of Proof of Loss requirements.</div><button class="btn-primary" onclick="runTool('pol-checklist')">Generate</button><div id="pol-checklist-output" class="tool-output"></div><div id="pol-checklist-actions" class="action-buttons" style="display:none;"><button class="btn-primary" onclick="copyToolOutput('pol-checklist')">Copy</button><button class="btn-primary" onclick="downloadToolOutput('pol-checklist')">Download</button><button class="btn-primary" onclick="clearOutput('pol-checklist')">Clear</button></div></div>
        <div class="tool-card"><div class="tool-title">Depreciation Release Request</div><div class="tool-desc">Request release of recoverable depreciation.</div><button class="btn-primary" onclick="runTool('depreciation-release')">Generate</button><div id="depreciation-release-output" class="tool-output"></div><div id="depreciation-release-actions" class="action-buttons" style="display:none;"><button class="btn-primary" onclick="copyToolOutput('depreciation-release')">Copy</button><button class="btn-primary" onclick="downloadToolOutput('depreciation-release')">Download</button><button class="btn-primary" onclick="clearOutput('depreciation-release')">Clear</button></div></div>
        <div class="tool-card"><div class="tool-title">ALE Extension Letter</div><div class="tool-desc">Request ALE extension.</div><button class="btn-primary" onclick="runTool('ale-extension')">Generate</button><div id="ale-extension-output" class="tool-output"></div><div id="ale-extension-actions" class="action-buttons" style="display:none;"><button class="btn-primary" onclick="copyToolOutput('ale-extension')">Copy</button><button class="btn-primary" onclick="downloadToolOutput('ale-extension')">Download</button><button class="btn-primary" onclick="clearOutput('ale-extension')">Clear</button></div></div>
        <div class="tool-card"><div class="tool-title">Settlement Analyzer</div><div class="tool-desc">Analyze insurer settlement offers.</div><button class="btn-primary" onclick="runTool('settlement-analyzer')">Generate</button><div id="settlement-analyzer-output" class="tool-output"></div><div id="settlement-analyzer-actions" class="action-buttons" style="display:none;"><button class="btn-primary" onclick="copyToolOutput('settlement-analyzer')">Copy</button><button class="btn-primary" onclick="downloadToolOutput('settlement-analyzer')">Download</button><button class="btn-primary" onclick="clearOutput('settlement-analyzer')">Clear</button></div></div>
        <div class="tool-card"><div class="tool-title">Bad Faith Checker</div><div class="tool-desc">Check for bad faith indicators.</div><button class="btn-primary" onclick="runTool('badfaith-checker')">Generate</button><div id="badfaith-checker-output" class="tool-output"></div><div id="badfaith-checker-actions" class="action-buttons" style="display:none;"><button class="btn-primary" onclick="copyToolOutput('badfaith-checker')">Copy</button><button class="btn-primary" onclick="downloadToolOutput('badfaith-checker')">Download</button><button class="btn-primary" onclick="clearOutput('badfaith-checker')">Clear</button></div></div>
        <div class="tool-card"><div class="tool-title">Escalation Drafts</div><div class="tool-desc">Generate escalation drafts.</div><button class="btn-primary" onclick="runTool('escalation-drafts')">Generate</button><div id="escalation-drafts-output" class="tool-output"></div><div id="escalation-drafts-actions" class="action-buttons" style="display:none;"><button class="btn-primary" onclick="copyToolOutput('escalation-drafts')">Copy</button><button class="btn-primary" onclick="downloadToolOutput('escalation-drafts')">Download</button><button class="btn-primary" onclick="clearOutput('escalation-drafts')">Clear</button></div></div>
        <div class="tool-card"><div class="tool-title">Timeline Builder</div><div class="tool-desc">Build claim event timelines.</div><button class="btn-primary" onclick="runTool('timeline-builder')">Generate</button><div id="timeline-builder-output" class="tool-output"></div><div id="timeline-builder-actions" class="action-buttons" style="display:none;"><button class="btn-primary" onclick="copyToolOutput('timeline-builder')">Copy</button><button class="btn-primary" onclick="downloadToolOutput('timeline-builder')">Download</button><button class="btn-primary" onclick="clearOutput('timeline-builder')">Clear</button><button class="btn-primary" onclick="exportTimeline()">Export CSV</button></div></div>
        <!-- New tools -->
        <div class="tool-card"><div class="tool-title">Policy Language Analyzer</div><div class="tool-desc">Explain policy language and exclusions.</div><button class="btn-primary" onclick="runTool('policy-analyzer')">Generate</button><div id="policy-analyzer-output" class="tool-output"></div><div id="policy-analyzer-actions" class="action-buttons" style="display:none;"><button class="btn-primary" onclick="copyToolOutput('policy-analyzer')">Copy</button><button class="btn-primary" onclick="downloadToolOutput('policy-analyzer')">Download</button><button class="btn-primary" onclick="clearOutput('policy-analyzer')">Clear</button></div></div>
        <div class="tool-card"><div class="tool-title">Demand Letter Generator</div><div class="tool-desc">Generate persuasive demand letters.</div><button class="btn-primary" onclick="runTool('demand-letter')">Generate</button><div id="demand-letter-output" class="tool-output"></div><div id="demand-letter-actions" class="action-buttons" style="display:none;"><button class="btn-primary" onclick="copyToolOutput('demand-letter')">Copy</button><button class="btn-primary" onclick="downloadToolOutput('demand-letter')">Download</button><button class="btn-primary" onclick="clearOutput('demand-letter')">Clear</button></div></div>
        <div class="tool-card"><div class="tool-title">Attorney Prep Sheet</div><div class="tool-desc">Summarize claim for attorneys.</div><button class="btn-primary" onclick="runTool('attorney-prep')">Generate</button><div id="attorney-prep-output" class="tool-output"></div><div id="attorney-prep-actions" class="action-buttons" style="display:none;"><button class="btn-primary" onclick="copyToolOutput('attorney-prep')">Copy</button><button class="btn-primary" onclick="downloadToolOutput('attorney-prep')">Download</button><button class="btn-primary" onclick="clearOutput('attorney-prep')">Clear</button></div></div>
        <div class="tool-card"><div class="tool-title">Bad Faith Complaint Letter</div><div class="tool-desc">Draft complaints to DOI.</div><button class="btn-primary" onclick="runTool('badfaith-complaint')">Generate</button><div id="badfaith-complaint-output" class="tool-output"></div><div id="badfaith-complaint-actions" class="action-buttons" style="display:none;"><button class="btn-primary" onclick="copyToolOutput('badfaith-complaint')">Copy</button><button class="btn-primary" onclick="downloadToolOutput('badfaith-complaint')">Download</button><button class="btn-primary" onclick="clearOutput('badfaith-complaint')">Clear</button></div></div>
      </div>
    </div>

    <!-- Settings -->
    <div id="settings" class="tab-content">
      <h2>Account Settings</h2>
      <div id="credit-log"></div>
      <button class="btn-secondary" onclick="downloadAllOutputs()">Download All Outputs (ZIP)</button>
    </div>
  </main>

  <script>
    function switchTab(tab){document.querySelectorAll('.tab-content').forEach(c=>c.classList.remove('active'));document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));document.getElementById(tab).classList.add('active');event.target.classList.add('active');}
    function logout(){localStorage.removeItem('userEmail');window.location.href='../index.html';}
    async function runTool(tool){const out=document.getElementById(`${tool}-output`);const actions=document.getElementById(`${tool}-actions`);out.style.display='block';out.innerHTML=`<div class="spinner"></div> Generating...`;actions.style.display='none';try{const res=await fetch('/.netlify/functions/generate-response',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({email:localStorage.getItem('userEmail'),mode:tool,inputText:`Run tool: ${tool}`})});const data=await res.json();if(res.ok&&data.draft){out.textContent=data.draft;actions.style.display='flex';document.getElementById('confidence-meter').innerText="Confidence: High";addToHistory(tool,data.draft);}else{out.textContent=data.error||"Failed.";}}catch(err){out.textContent="Error.";}}
    function copyToolOutput(t){const text=document.getElementById(`${t}-output`).innerText;if(!text)return alert("No content.");navigator.clipboard.writeText(text).then(()=>alert("Copied!"));}
    function downloadToolOutput(t){const text=document.getElementById(`${t}-output`).innerText;if(!text)return;const blob=new Blob([text],{type:'text/plain'});const link=document.createElement('a');link.href=URL.createObjectURL(blob);link.download=`${t}-output.txt`;link.click();}
    function clearOutput(t){document.getElementById(`${t}-output`).textContent='';document.getElementById(`${t}-actions`).style.display='none';}
    function exportDoc(type){alert("Export to "+type+" coming soon (backend hook).");}
    function saveDraft(){alert("Draft saved to My Documents (backend hook).");}
    function filterDocuments(){/* search filter logic */} 
    function uploadDocument(){/* file upload classification logic */} 
    function generateResponse(){/* AI response agent logic */} 
    function downloadAllOutputs(){alert("ZIP export coming soon.");}
    function exportTimeline(){alert("Timeline exported to CSV (backend hook).");}
    function setLanguage(){alert("Language switched (backend hook).");}
    function addToHistory(tool,text){const h=document.getElementById('session-history');const div=document.createElement('div');div.innerText=`${tool}: ${text.substring(0,100)}...`;h.prepend(div);if(h.childNodes.length>10)h.removeChild(h.lastChild);}
  </script>
</body>
</html>
