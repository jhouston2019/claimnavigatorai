<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Response Center - ClaimNavigatorAI</title>
  <meta name="description" content="AI-powered claim response center with document library, AI response generation, claim analysis tools, and playbook.">
  <style>
    :root {
      --primary: #1e40af;
      --accent: #3b82f6;
      --border: #e5e7eb;
      --text-secondary: #6b7280;
      --bg-light: #f9fafb;
    }
    body { font-family: Arial, sans-serif; margin:0; padding:0; background:#fff; }
    header { background:#0f172a; padding:1rem; color:#fff; position:sticky; top:0; }
    nav { display:flex; justify-content:space-between; align-items:center; }
    .nav-links { display:flex; gap:1rem; }
    .nav-links a { color:#fff; text-decoration:none; }
    .main-content { padding:2rem; }
    .tabs { display:flex; border-bottom:2px solid var(--border); margin-bottom:1.5rem; flex-wrap:wrap; }
    .tab { padding:1rem; cursor:pointer; }
    .tab.active { border-bottom:3px solid var(--primary); font-weight:bold; }
    .tab-content { display:none; }
    .tab-content.active { display:block; }
    .btn-primary { background:var(--primary); color:#fff; border:none; border-radius:0.5rem; padding:0.5rem 1rem; cursor:pointer; text-decoration:none; display:inline-block; }
    .btn-secondary { background:var(--accent); color:#fff; border:none; border-radius:0.5rem; padding:0.5rem 1rem; cursor:pointer; text-decoration:none; display:inline-block; }
    .tool-grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(320px,1fr)); gap:1rem; }
    .tool-card { background:var(--bg-light); padding:1rem; border:1px solid var(--border); border-radius:0.5rem; }
    .tool-title { font-weight:bold; margin-bottom:0.5rem; }
    .tool-desc { font-size:0.9rem; color:var(--text-secondary); margin-bottom:0.5rem; }
    .tool-output { display:none; background:#fff; border:1px solid var(--border); border-radius:0.5rem; padding:0.75rem; white-space:pre-wrap; margin-top:0.5rem; min-height:80px; }
    .action-buttons { display:flex; gap:0.5rem; flex-wrap:wrap; margin-top:0.5rem; }
    .spinner { border:3px solid #f3f3f3; border-top:3px solid var(--primary); border-radius:50%; width:18px; height:18px; animation:spin 1s linear infinite; display:inline-block; }
    @keyframes spin { 0% { transform:rotate(0deg);} 100%{ transform:rotate(360deg);} }

    /* Enhanced Claim Playbook Styles */
    .playbook-container { max-width: 1200px; margin: 0 auto; }
    .playbook-phase { background: #fff; border: 2px solid var(--border); border-radius: 12px; margin-bottom: 2rem; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
    .playbook-phase-header { background: linear-gradient(135deg, var(--primary), var(--accent)); color: white; padding: 1.5rem; cursor: pointer; display: flex; align-items: center; gap: 1rem; }
    .playbook-phase-number { background: rgba(255,255,255,0.2); border-radius: 50%; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 1.2rem; }
    .playbook-phase-title { font-size: 1.3rem; font-weight: 600; flex: 1; }
    .playbook-phase-toggle { font-size: 1.5rem; transition: transform 0.3s; }
    .playbook-phase.active .playbook-phase-toggle { transform: rotate(180deg); }
    .playbook-phase-body { display: none; padding: 2rem; background: #fafbfc; }
    .playbook-phase.active .playbook-phase-body { display: block; }
    
    .playbook-overview { background: linear-gradient(135deg, #f0f9ff, #e0f2fe); padding: 1.5rem; border-radius: 12px; margin-bottom: 2rem; border-left: 5px solid var(--primary); }
    .playbook-overview h3 { color: var(--primary); margin: 0 0 1rem 0; font-size: 1.4rem; }
    .playbook-overview p { margin: 0; color: #374151; line-height: 1.6; }
    
    .step-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem; margin-top: 1.5rem; }
    .step-card { background: white; border: 1px solid var(--border); border-radius: 8px; padding: 1.5rem; position: relative; }
    .step-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 4px; background: var(--primary); border-radius: 8px 8px 0 0; }
    .step-number { background: var(--primary); color: white; border-radius: 50%; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 0.9rem; margin-bottom: 1rem; }
    .step-title { font-weight: 600; color: var(--primary); margin-bottom: 0.5rem; font-size: 1.1rem; }
    .step-description { color: #6b7280; font-size: 0.95rem; line-height: 1.5; margin-bottom: 1rem; }
    .step-actions { background: #f8fafc; padding: 1rem; border-radius: 6px; border-left: 3px solid var(--accent); }
    .step-actions h4 { margin: 0 0 0.5rem 0; color: var(--primary); font-size: 0.95rem; }
    .step-actions ul { margin: 0; padding-left: 1.2rem; }
    .step-actions li { margin-bottom: 0.3rem; color: #374151; font-size: 0.9rem; }
    
    .timeline-indicator { display: flex; align-items: center; gap: 0.5rem; margin: 1rem 0; padding: 0.75rem; background: #f0f9ff; border-radius: 8px; border: 1px solid #bae6fd; }
    .timeline-dot { width: 12px; height: 12px; background: var(--primary); border-radius: 50%; }
    .timeline-text { color: var(--primary); font-weight: 500; font-size: 0.9rem; }
    
    .document-links { display: flex; gap: 0.5rem; flex-wrap: wrap; margin-top: 1rem; }
    .document-link { background: var(--accent); color: white; padding: 0.4rem 0.8rem; border-radius: 6px; text-decoration: none; font-size: 0.85rem; font-weight: 500; transition: background 0.2s; }
    .document-link:hover { background: var(--primary); }
    
    .warning-box { background: #fef3c7; border: 1px solid #f59e0b; border-radius: 8px; padding: 1rem; margin: 1rem 0; }
    .warning-box h4 { color: #92400e; margin: 0 0 0.5rem 0; font-size: 1rem; }
    .warning-box p { color: #92400e; margin: 0; font-size: 0.9rem; }
    
    .success-box { background: #d1fae5; border: 1px solid #10b981; border-radius: 8px; padding: 1rem; margin: 1rem 0; }
    .success-box h4 { color: #065f46; margin: 0 0 0.5rem 0; font-size: 1rem; }
    .success-box p { color: #065f46; margin: 0; font-size: 0.9rem; }

    /* Affiliate Tools Styles */
    .affiliate-disclosure { background:var(--bg-light); padding:1rem; border-radius:0.5rem; border-left:4px solid var(--primary); margin:2rem 0; font-size:0.875rem; color:var(--text-secondary); }
    .resource-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(300px,1fr)); gap:1rem; margin-top:1rem; }
    .resource-card { background:var(--bg-light); padding:1rem; border:1px solid var(--border); border-radius:0.5rem; }
    .resource-badge { background:var(--primary); color:#fff; padding:0.25rem 0.5rem; border-radius:0.25rem; font-size:0.75rem; font-weight:bold; text-transform:uppercase; }
    .resource-card h4 { color:#000; margin:0.5rem 0; font-size:1.1rem; }
    .resource-card p { color:var(--text-secondary); font-size:0.9rem; margin-bottom:1rem; }
    
    /* Credits Display */
    .credits-display {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin: 0 1rem;
    }
    .credits-display span {
      background: #f0f9ff;
      color: #0369a1;
      padding: 0.25rem 0.75rem;
      border-radius: 1rem;
      font-size: 0.875rem;
      font-weight: 600;
      border: 1px solid #0ea5e9;
    }
    .btn-buy-credits {
      background: #10b981;
      color: white;
      border: none;
      padding: 0.25rem 0.75rem;
      border-radius: 0.375rem;
      font-size: 0.875rem;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.2s;
    }
    .btn-buy-credits:hover {
      background: #059669;
    }
  </style>
</head>
<body>
  <header>
    <nav>
      <div class="logo">ClaimNavigatorAI</div>
      <div class="nav-links">
        <a href="../index.html">Home</a>
        <a href="../product.html">Product</a>
        <a href="response-center.html">Response Center</a>
        <a href="settings.html">Settings</a>
        <div class="credits-display">
          <span id="user-credits-display">Credits: Loading...</span>
          <button class="btn-buy-credits" onclick="buyMoreCredits()">Buy More</button>
        </div>
        <a href="#" onclick="logout()">Logout</a>
      </div>
    </nav>
  </header>

  <main class="main-content">
    <h1>Response Center</h1>
    <p>AI-powered tools to strengthen your claim and generate professional responses</p>

    <!-- Tabs -->
    <div class="tabs">
      <button class="tab active" onclick="switchTab(event,'ai-agent')">AI Response & Analysis Agent</button>
      <button class="tab" onclick="window.location.href='/app/claims.html'">My Claims</button>
            <button class="tab" onclick="switchTab(event,'my-documents')">Claim Document Library</button>
      <button class="tab" onclick="switchTab(event,'analysis-tools')">Claim Analysis Tools</button>
      <button class="tab" onclick="switchTab(event,'claim-playbook')">Claim Playbook</button>
      <button class="tab" onclick="switchTab(event,'claim-timeline-guide')">Claim Timeline & Sequence Guide</button>
      <button class="tab" onclick="switchTab(event,'claim-documentation-guides')">Claim Documentation Guides</button>
      <button class="tab" onclick="switchTab(event,'recommended-resources')">Recommended Resources</button>
      <button class="tab" onclick="switchTab(event,'settings')">Settings</button>
    </div>

    <!-- AI Agent -->
    <div id="ai-agent" class="tab-content active">
      <textarea id="input-text" style="width:100%; min-height:120px; margin-bottom:1rem;" placeholder="Paste insurer correspondence..."></textarea>
      <div class="action-buttons">
        <button class="btn-primary" onclick="generateResponse()">Generate Response</button>
        <button class="btn-primary" onclick="exportDoc('docx')">Export DOCX</button>
        <button class="btn-primary" onclick="exportDoc('pdf')">Export PDF</button>
        <button class="btn-primary" onclick="saveDraft()">Save to My Documents</button>
        <select id="language-select" style="padding:0.5rem; border-radius:0.5rem;">
          <option value="en">English</option>
          <option value="es">Español</option>
        </select>
      </div>
      <div id="ai-output" class="tool-output"></div>
      <div id="confidence-meter" style="margin-top:0.5rem; font-size:0.9rem; color:var(--text-secondary);"></div>
      <h3>Session History</h3>
      <div id="session-history"></div>
    </div>

    <!-- Claim Document Library -->
    <div id="my-documents" class="tab-content">
      <h2>Claim Document Library</h2>
      <div class="lang-toggle" style="margin-bottom:1rem;">
        <button id="lang-en" onclick="setLang('en')" class="btn-primary">English</button>
        <button id="lang-es" onclick="setLang('es')" class="btn-secondary">Español</button>
      </div>
      <input type="text" id="doc-search" placeholder="Search documents..."
        oninput="filterDocuments()" style="width:100%; margin-bottom:1rem; padding:0.5rem;">
      <input type="file" id="doc-upload" onchange="uploadDocument()" style="margin-bottom:1rem;">
      <div id="documents-container"></div>
    </div>

    <!-- Claim Analysis Tools -->
    <div id="analysis-tools" class="tab-content">
      <h2>Claim Analysis Tools</h2>
      <p>Professional tools to analyze your claim, review coverage, and assess damages</p>
      
      <div class="tool-grid" id="tool-grid">
        <!-- Policy Review Tool -->
        <div class="tool-card">
          <div class="tool-title">Policy Review & Coverage Analysis</div>
          <div class="tool-desc">Upload your policy documents for AI-powered coverage analysis and gap identification</div>
          <textarea id="policy-input" placeholder="Paste your policy information here or upload documents..." style="width: 100%; min-height: 80px; margin: 0.5rem 0; padding: 0.5rem; border: 1px solid #e5e7eb; border-radius: 0.5rem;"></textarea>
          <div class="action-buttons">
            <button class="btn-primary" onclick="analyzePolicy()">Analyze Policy</button>
            <button class="btn-secondary" onclick="downloadPolicyChecklist()">Download Checklist</button>
          </div>
          <div id="policy-analysis-output" class="tool-output"></div>
        </div>

        <!-- Damage Assessment Tool -->
        <div class="tool-card">
          <div class="tool-title">Damage Assessment Calculator</div>
          <div class="tool-desc">Calculate and document property damage with line-item estimates and depreciation analysis</div>
          <textarea id="damage-input" placeholder="Describe the damage, paste estimates, or upload photos..." style="width: 100%; min-height: 80px; margin: 0.5rem 0; padding: 0.5rem; border: 1px solid #e5e7eb; border-radius: 0.5rem;"></textarea>
          <div class="action-buttons">
            <button class="btn-primary" onclick="assessDamage()">Start Assessment</button>
            <button class="btn-secondary" onclick="downloadDamageForm()">Download Form</button>
          </div>
          <div id="damage-assessment-output" class="tool-output"></div>
        </div>

        <!-- Estimate Review Tool -->
        <div class="tool-card">
          <div class="tool-title">Estimate Review & Comparison</div>
          <div class="tool-desc">Compare contractor estimates with insurer estimates and identify discrepancies</div>
          <textarea id="estimate-input" placeholder="Paste contractor and insurer estimates for comparison..." style="width: 100%; min-height: 80px; margin: 0.5rem 0; padding: 0.5rem; border: 1px solid #e5e7eb; border-radius: 0.5rem;"></textarea>
          <div class="action-buttons">
            <button class="btn-primary" onclick="reviewEstimate()">Review Estimate</button>
            <button class="btn-secondary" onclick="downloadComparison()">Download Comparison</button>
          </div>
          <div id="estimate-review-output" class="tool-output"></div>
        </div>

        <!-- Business Interruption Tool -->
        <div class="tool-card">
          <div class="tool-title">Business Interruption Calculator</div>
          <div class="tool-desc">Calculate business interruption losses including lost revenue and extra expenses</div>
          <textarea id="bi-input" placeholder="Provide business financial information, revenue data, and expenses..." style="width: 100%; min-height: 80px; margin: 0.5rem 0; padding: 0.5rem; border: 1px solid #e5e7eb; border-radius: 0.5rem;"></textarea>
          <div class="action-buttons">
            <button class="btn-primary" onclick="calculateBI()">Calculate BI Loss</button>
            <button class="btn-secondary" onclick="downloadBICalc()">Download Calculator</button>
          </div>
          <div id="bi-calculator-output" class="tool-output"></div>
        </div>

        <!-- Expert Opinion Tool -->
        <div class="tool-card">
          <div class="tool-title">Expert Opinion Request Generator</div>
          <div class="tool-desc">Generate professional requests for expert opinions on damage assessment or policy interpretation</div>
          <textarea id="expert-input" placeholder="Describe the claim situation and type of expert opinion needed..." style="width: 100%; min-height: 80px; margin: 0.5rem 0; padding: 0.5rem; border: 1px solid #e5e7eb; border-radius: 0.5rem;"></textarea>
          <div class="action-buttons">
            <button class="btn-primary" onclick="requestExpertOpinion()">Generate Request</button>
            <button class="btn-secondary" onclick="downloadExpertForm()">Download Form</button>
          </div>
          <div id="expert-opinion-output" class="tool-output"></div>
        </div>

        <!-- Settlement Analysis Tool -->
        <div class="tool-card">
          <div class="tool-title">Settlement Analysis & Negotiation</div>
          <div class="tool-desc">Analyze settlement offers and generate negotiation strategies with supporting documentation</div>
          <textarea id="settlement-input" placeholder="Paste settlement offer details and your claim information..." style="width: 100%; min-height: 80px; margin: 0.5rem 0; padding: 0.5rem; border: 1px solid #e5e7eb; border-radius: 0.5rem;"></textarea>
          <div class="action-buttons">
            <button class="btn-primary" onclick="analyzeSettlement()">Analyze Settlement</button>
            <button class="btn-secondary" onclick="downloadNegotiation()">Download Strategy</button>
          </div>
          <div id="settlement-analysis-output" class="tool-output"></div>
        </div>
      </div>
    </div>

    <!-- Claim Playbook -->
    <div id="claim-playbook" class="tab-content">
      <h2>📋 Complete Claim Navigation Playbook</h2>
      
      <div class="playbook-overview">
        <h3>🎯 Your Step-by-Step Claim Success Roadmap</h3>
        <p>This comprehensive playbook guides you through every phase of your insurance claim with detailed steps, timelines, and actionable checklists. Each phase includes specific documents, tools, and strategies to maximize your settlement and avoid common pitfalls.</p>
      </div>

      <div class="playbook-container">

        <!-- Phase 1: Immediate Response -->
        <div class="playbook-phase active">
          <div class="playbook-phase-header" onclick="togglePlaybookPhase(this)">
            <div class="playbook-phase-number">1</div>
            <div class="playbook-phase-title">🚨 Immediate Response & Safety</div>
            <div class="playbook-phase-toggle">▼</div>
          </div>
          <div class="playbook-phase-body">
            <div class="timeline-indicator">
              <div class="timeline-dot"></div>
              <div class="timeline-text">Timeline: First 24-48 hours after loss</div>
            </div>
            
            <div class="step-grid">
              <div class="step-card">
                <div class="step-number">1</div>
                <div class="step-title">Ensure Safety First</div>
                <div class="step-description">Protect yourself and others from immediate danger</div>
                <div class="step-actions">
                  <h4>Critical Actions:</h4>
                  <ul>
                    <li>Evacuate if structural damage or gas leaks</li>
                    <li>Call 911 for emergencies</li>
                    <li>Turn off utilities if safe to do so</li>
                    <li>Do not re-enter damaged areas until cleared</li>
                  </ul>
                </div>
              </div>
              
              <div class="step-card">
                <div class="step-number">2</div>
                <div class="step-title">Secure the Property</div>
                <div class="step-description">Prevent further damage and protect your belongings</div>
                <div class="step-actions">
                  <h4>Immediate Steps:</h4>
                  <ul>
                    <li>Board up broken windows and doors</li>
                    <li>Cover roof damage with tarps</li>
                    <li>Move undamaged items to safe location</li>
                    <li>Document all protective measures taken</li>
                  </ul>
                </div>
              </div>
              
              <div class="step-card">
                <div class="step-number">3</div>
                <div class="step-title">Notify Your Insurance Company</div>
                <div class="step-description">Start the claims process immediately</div>
                <div class="step-actions">
                  <h4>Contact Information:</h4>
                  <ul>
                    <li>Call your insurance company's 24/7 hotline</li>
                    <li>Provide policy number and basic loss details</li>
                    <li>Get your claim number and adjuster contact</li>
                    <li>Ask about immediate assistance programs</li>
                  </ul>
                </div>
                <div class="document-links">
                  <a href="#" class="document-link" onclick="openDocument('en/initial-loss-notification-sample.pdf')">Initial Loss Notice</a>
                  <a href="#" class="document-link" onclick="openDocument('en/emergency-contact-log-sample.pdf')">Contact Log</a>
                </div>
              </div>
            </div>
            
            <div class="warning-box">
              <h4>⚠️ Critical Warning</h4>
              <p>Do not begin permanent repairs until your adjuster has inspected the damage. Temporary protective measures are acceptable and often required by your policy.</p>
            </div>
          </div>
        </div>

        <!-- Phase 2: Documentation & Evidence -->
        <div class="playbook-phase">
          <div class="playbook-phase-header" onclick="togglePlaybookPhase(this)">
            <div class="playbook-phase-number">2</div>
            <div class="playbook-phase-title">📸 Comprehensive Documentation</div>
            <div class="playbook-phase-toggle">▼</div>
          </div>
          <div class="playbook-phase-body">
            <div class="timeline-indicator">
              <div class="timeline-dot"></div>
              <div class="timeline-text">Timeline: First 7 days after loss</div>
            </div>
            
            <div class="step-grid">
              <div class="step-card">
                <div class="step-number">1</div>
                <div class="step-title">Photograph Everything</div>
                <div class="step-description">Create comprehensive visual evidence of all damage</div>
                <div class="step-actions">
                  <h4>Photo Documentation:</h4>
                  <ul>
                    <li>Take wide shots showing overall damage</li>
                    <li>Capture close-ups of specific damage</li>
                    <li>Include date/time stamps on photos</li>
                    <li>Document both damaged and undamaged areas</li>
                    <li>Take photos from multiple angles</li>
                  </ul>
                </div>
              </div>
              
              <div class="step-card">
                <div class="step-number">2</div>
                <div class="step-title">Create Detailed Inventory</div>
                <div class="step-description">Document all damaged and destroyed items</div>
                <div class="step-actions">
                  <h4>Inventory Process:</h4>
                  <ul>
                    <li>List every damaged item with descriptions</li>
                    <li>Include purchase dates and original costs</li>
                    <li>Note brand names, model numbers, serial numbers</li>
                    <li>Estimate current replacement costs</li>
                    <li>Gather receipts and proof of purchase</li>
                  </ul>
                </div>
                <div class="document-links">
                  <a href="#" class="document-link" onclick="openDocument('en/personal-property-inventory-sample.pdf')">Property Inventory</a>
                  <a href="#" class="document-link" onclick="openDocument('en/damage-assessment-form-sample.pdf')">Damage Assessment</a>
                </div>
              </div>
              
              <div class="step-card">
                <div class="step-number">3</div>
                <div class="step-title">Gather Supporting Documents</div>
                <div class="step-description">Collect all relevant paperwork and records</div>
                <div class="step-actions">
                  <h4>Essential Documents:</h4>
                  <ul>
                    <li>Insurance policy and declarations page</li>
                    <li>Police reports (if applicable)</li>
                    <li>Fire department reports</li>
                    <li>Weather service reports</li>
                    <li>Contractor estimates and invoices</li>
                    <li>Receipts for emergency repairs</li>
                  </ul>
                </div>
              </div>
            </div>
            
            <div class="success-box">
              <h4>✅ Pro Tip</h4>
              <p>Use your smartphone's voice memo feature to record detailed descriptions while walking through the damage. This creates an audio inventory that complements your photos.</p>
            </div>
          </div>
        </div>

        <!-- Phase 3: Adjuster Meeting -->
        <div class="playbook-phase">
          <div class="playbook-phase-header" onclick="togglePlaybookPhase(this)">
            <div class="playbook-phase-number">3</div>
            <div class="playbook-phase-title">🤝 Adjuster Inspection & Meeting</div>
            <div class="playbook-phase-toggle">▼</div>
          </div>
          <div class="playbook-phase-body">
            <div class="timeline-indicator">
              <div class="timeline-dot"></div>
              <div class="timeline-text">Timeline: 3-14 days after loss notification</div>
            </div>
            
            <div class="step-grid">
              <div class="step-card">
                <div class="step-number">1</div>
                <div class="step-title">Prepare for the Inspection</div>
                <div class="step-description">Get ready for the adjuster's visit</div>
                <div class="step-actions">
                  <h4>Pre-Inspection Checklist:</h4>
                  <ul>
                    <li>Schedule inspection at your convenience</li>
                    <li>Prepare all documentation in organized folders</li>
                    <li>Have contractor estimates ready</li>
                    <li>Ensure all damaged areas are accessible</li>
                    <li>Prepare a list of questions for the adjuster</li>
                  </ul>
                </div>
              </div>
              
              <div class="step-card">
                <div class="step-number">2</div>
                <div class="step-title">During the Inspection</div>
                <div class="step-description">Make the most of the adjuster's visit</div>
                <div class="step-actions">
                  <h4>Inspection Best Practices:</h4>
                  <ul>
                    <li>Accompany the adjuster throughout the inspection</li>
                    <li>Point out all damage, even minor issues</li>
                    <li>Take notes on what the adjuster says</li>
                    <li>Ask about coverage for specific items</li>
                    <li>Request a copy of the adjuster's report</li>
                  </ul>
                </div>
              </div>
              
              <div class="step-card">
                <div class="step-number">3</div>
                <div class="step-title">Post-Inspection Follow-up</div>
                <div class="step-description">Ensure nothing is missed after the inspection</div>
                <div class="step-actions">
                  <h4>Follow-up Actions:</h4>
                  <ul>
                    <li>Send thank you email to adjuster</li>
                    <li>Request written confirmation of inspection</li>
                    <li>Ask for timeline on estimate delivery</li>
                    <li>Document any additional damage discovered</li>
                    <li>Keep detailed records of all communications</li>
                  </ul>
                </div>
                <div class="document-links">
                  <a href="#" class="document-link" onclick="openDocument('en/adjuster-meeting-checklist-sample.pdf')">Meeting Checklist</a>
                  <a href="#" class="document-link" onclick="openDocument('en/inspection-follow-up-letter-sample.pdf')">Follow-up Letter</a>
                </div>
              </div>
            </div>
            
            <div class="warning-box">
              <h4>⚠️ Important Reminder</h4>
              <p>You have the right to hire your own independent adjuster or contractor to provide a second opinion. Don't rely solely on the insurance company's assessment.</p>
            </div>
          </div>
        </div>

        <!-- Phase 4: Estimate Analysis -->
        <div class="playbook-phase">
          <div class="playbook-phase-header" onclick="togglePlaybookPhase(this)">
            <div class="playbook-phase-number">4</div>
            <div class="playbook-phase-title">🔍 Estimate Review & Analysis</div>
            <div class="playbook-phase-toggle">▼</div>
          </div>
          <div class="playbook-phase-body">
            <div class="timeline-indicator">
              <div class="timeline-dot"></div>
              <div class="timeline-text">Timeline: 7-21 days after inspection</div>
            </div>
            
            <div class="step-grid">
              <div class="step-card">
                <div class="step-number">1</div>
                <div class="step-title">Obtain Multiple Estimates</div>
                <div class="step-description">Get independent contractor estimates for comparison</div>
                <div class="step-actions">
                  <h4>Estimate Collection:</h4>
                  <ul>
                    <li>Get at least 3 detailed contractor estimates</li>
                    <li>Ensure estimates include all damaged areas</li>
                    <li>Request line-item breakdowns</li>
                    <li>Verify contractor licensing and insurance</li>
                    <li>Ask about warranty and timeline</li>
                  </ul>
                </div>
              </div>
              
              <div class="step-card">
                <div class="step-number">2</div>
                <div class="step-title">Compare Estimates Line-by-Line</div>
                <div class="step-description">Analyze differences between insurance and contractor estimates</div>
                <div class="step-actions">
                  <h4>Analysis Process:</h4>
                  <ul>
                    <li>Compare labor rates and material costs</li>
                    <li>Check for missing items or scope</li>
                    <li>Verify code compliance requirements</li>
                    <li>Look for hidden or additional damage</li>
                    <li>Document all discrepancies found</li>
                  </ul>
                </div>
                <div class="document-links">
                  <a href="#" class="document-link" onclick="openDocument('en/estimate-comparison-worksheet-sample.pdf')">Comparison Worksheet</a>
                  <a href="#" class="document-link" onclick="openDocument('en/estimate-discrepancy-letter-sample.pdf')">Discrepancy Letter</a>
                </div>
              </div>
              
              <div class="step-card">
                <div class="step-number">3</div>
                <div class="step-title">Identify Coverage Issues</div>
                <div class="step-description">Review policy coverage and identify potential disputes</div>
                <div class="step-actions">
                  <h4>Coverage Review:</h4>
                  <ul>
                    <li>Review policy limits and deductibles</li>
                    <li>Check for coverage exclusions</li>
                    <li>Verify replacement cost vs. actual cash value</li>
                    <li>Understand depreciation calculations</li>
                    <li>Identify potential coverage disputes</li>
                  </ul>
                </div>
              </div>
            </div>
            
            <div class="success-box">
              <h4>✅ Pro Tip</h4>
              <p>Use our AI-powered estimate comparison tool to automatically identify discrepancies between estimates and generate professional dispute letters.</p>
            </div>
          </div>
        </div>

        <!-- Phase 5: Negotiation -->
        <div class="playbook-phase">
          <div class="playbook-phase-header" onclick="togglePlaybookPhase(this)">
            <div class="playbook-phase-number">5</div>
            <div class="playbook-phase-title">💬 Professional Negotiation</div>
            <div class="playbook-phase-toggle">▼</div>
          </div>
          <div class="playbook-phase-body">
            <div class="timeline-indicator">
              <div class="timeline-dot"></div>
              <div class="timeline-text">Timeline: Ongoing after estimate review</div>
            </div>
            
            <div class="step-grid">
              <div class="step-card">
                <div class="step-number">1</div>
                <div class="step-title">Prepare Negotiation Strategy</div>
                <div class="step-description">Develop a professional approach to settlement discussions</div>
                <div class="step-actions">
                  <h4>Strategy Development:</h4>
                  <ul>
                    <li>Document all discrepancies with evidence</li>
                    <li>Prepare professional dispute letters</li>
                    <li>Gather supporting documentation</li>
                    <li>Set realistic settlement goals</li>
                    <li>Plan your negotiation timeline</li>
                  </ul>
                </div>
              </div>
              
              <div class="step-card">
                <div class="step-number">2</div>
                <div class="step-title">Submit Formal Disputes</div>
                <div class="step-description">Present your case professionally and thoroughly</div>
                <div class="step-actions">
                  <h4>Dispute Process:</h4>
                  <ul>
                    <li>Send written disputes for all discrepancies</li>
                    <li>Include supporting documentation</li>
                    <li>Request written responses to disputes</li>
                    <li>Maintain professional tone in all communications</li>
                    <li>Keep detailed records of all correspondence</li>
                  </ul>
                </div>
                <div class="document-links">
                  <a href="#" class="document-link" onclick="openDocument('en/formal-dispute-letter-sample.pdf')">Dispute Letter</a>
                  <a href="#" class="document-link" onclick="openDocument('en/negotiation-timeline-sample.pdf')">Negotiation Timeline</a>
                </div>
              </div>
              
              <div class="step-card">
                <div class="step-number">3</div>
                <div class="step-title">Follow Up Systematically</div>
                <div class="step-description">Maintain momentum and pressure for fair settlement</div>
                <div class="step-actions">
                  <h4>Follow-up Strategy:</h4>
                  <ul>
                    <li>Set follow-up deadlines for responses</li>
                    <li>Escalate to supervisors when needed</li>
                    <li>Document all delays and unresponsiveness</li>
                    <li>Consider alternative dispute resolution</li>
                    <li>Prepare for formal escalation if necessary</li>
                  </ul>
                </div>
              </div>
            </div>
            
            <div class="warning-box">
              <h4>⚠️ Negotiation Warning</h4>
              <p>Never accept the first offer without thorough analysis. Insurance companies often start with low offers expecting negotiation. Be persistent but professional.</p>
            </div>
          </div>
        </div>

        <!-- Phase 6: Supplemental Claims -->
        <div class="playbook-phase">
          <div class="playbook-phase-header" onclick="togglePlaybookPhase(this)">
            <div class="playbook-phase-number">6</div>
            <div class="playbook-phase-title">📋 Supplemental Claims & Additional Damages</div>
            <div class="playbook-phase-toggle">▼</div>
          </div>
          <div class="playbook-phase-body">
            <div class="timeline-indicator">
              <div class="timeline-dot"></div>
              <div class="timeline-text">Timeline: Ongoing throughout claim process</div>
            </div>
            
            <div class="step-grid">
              <div class="step-card">
                <div class="step-number">1</div>
                <div class="step-title">Identify Additional Damage</div>
                <div class="step-description">Look for hidden or newly discovered damage</div>
                <div class="step-actions">
                  <h4>Damage Discovery:</h4>
                  <ul>
                    <li>Conduct thorough re-inspection</li>
                    <li>Look for water damage, mold, structural issues</li>
                    <li>Check for damage behind walls or under floors</li>
                    <li>Document any damage that worsens over time</li>
                    <li>Get professional assessments for hidden damage</li>
                  </ul>
                </div>
              </div>
              
              <div class="step-card">
                <div class="step-number">2</div>
                <div class="step-title">Document Additional Living Expenses</div>
                <div class="step-description">Track all costs related to displacement</div>
                <div class="step-actions">
                  <h4>ALE Documentation:</h4>
                  <ul>
                    <li>Keep receipts for temporary housing</li>
                    <li>Document increased food costs</li>
                    <li>Track transportation expenses</li>
                    <li>Record storage and moving costs</li>
                    <li>Calculate pet boarding and care costs</li>
                  </ul>
                </div>
                <div class="document-links">
                  <a href="#" class="document-link" onclick="openDocument('en/additional-living-expenses-ale-reimbursement-request-sample.pdf')">ALE Request</a>
                  <a href="#" class="document-link" onclick="openDocument('en/supplemental-claim-form-sample.pdf')">Supplemental Claim</a>
                </div>
              </div>
              
              <div class="step-card">
                <div class="step-number">3</div>
                <div class="step-title">Submit Supplemental Claims</div>
                <div class="step-description">Formally request additional coverage for new damage</div>
                <div class="step-actions">
                  <h4>Submission Process:</h4>
                  <ul>
                    <li>Prepare detailed supplemental claim forms</li>
                    <li>Include all supporting documentation</li>
                    <li>Provide contractor estimates for new damage</li>
                    <li>Request prompt review and response</li>
                    <li>Follow up on submission status</li>
                  </ul>
                </div>
              </div>
            </div>
            
            <div class="success-box">
              <h4>✅ Pro Tip</h4>
              <p>Many policyholders miss significant additional damage because they don't know what to look for. Consider hiring a public adjuster or independent contractor for a thorough assessment.</p>
            </div>
          </div>
        </div>

        <!-- Phase 7: Escalation -->
        <div class="playbook-phase">
          <div class="playbook-phase-header" onclick="togglePlaybookPhase(this)">
            <div class="playbook-phase-number">7</div>
            <div class="playbook-phase-title">⚖️ Formal Escalation & Dispute Resolution</div>
            <div class="playbook-phase-toggle">▼</div>
          </div>
          <div class="playbook-phase-body">
            <div class="timeline-indicator">
              <div class="timeline-dot"></div>
              <div class="timeline-text">Timeline: When negotiations stall or fail</div>
            </div>
            
            <div class="step-grid">
              <div class="step-card">
                <div class="step-number">1</div>
                <div class="step-title">Formal Demand Letter</div>
                <div class="step-description">Send a professional demand for fair settlement</div>
                <div class="step-actions">
                  <h4>Demand Letter Elements:</h4>
                  <ul>
                    <li>Clearly state your position and demands</li>
                    <li>Include all supporting evidence</li>
                    <li>Set reasonable deadline for response</li>
                    <li>Threaten further action if needed</li>
                    <li>Send via certified mail with return receipt</li>
                  </ul>
                </div>
                <div class="document-links">
                  <a href="#" class="document-link" onclick="openDocument('en/formal-demand-letter-sample.pdf')">Demand Letter</a>
                  <a href="#" class="document-link" onclick="openDocument('en/insurance-commissioner-complaint-sample.pdf')">Commissioner Complaint</a>
                </div>
              </div>
              
              <div class="step-card">
                <div class="step-number">2</div>
                <div class="step-title">File Insurance Commissioner Complaint</div>
                <div class="step-description">Escalate to state insurance regulator</div>
                <div class="step-actions">
                  <h4>Regulatory Process:</h4>
                  <ul>
                    <li>Research your state's insurance department</li>
                    <li>File formal complaint with supporting documents</li>
                    <li>Request investigation of unfair practices</li>
                    <li>Cooperate with regulatory investigation</li>
                    <li>Use regulatory findings in negotiations</li>
                  </ul>
                </div>
              </div>
              
              <div class="step-card">
                <div class="step-number">3</div>
                <div class="step-title">Consider Professional Help</div>
                <div class="step-description">Engage experts when needed</div>
                <div class="step-actions">
                  <h4>Professional Options:</h4>
                  <ul>
                    <li>Hire a public adjuster for complex claims</li>
                    <li>Consult with insurance attorneys</li>
                    <li>Engage independent appraisers</li>
                    <li>Consider mediation services</li>
                    <li>Evaluate litigation as last resort</li>
                  </ul>
                </div>
              </div>
            </div>
            
            <div class="warning-box">
              <h4>⚠️ Escalation Warning</h4>
              <p>Escalation should be used strategically. Document all attempts at resolution before escalating, as this strengthens your position in any formal proceedings.</p>
            </div>
          </div>
        </div>

        <!-- Phase 8: Appraisal & Mediation -->
        <div class="playbook-phase">
          <div class="playbook-phase-header" onclick="togglePlaybookPhase(this)">
            <div class="playbook-phase-number">8</div>
            <div class="playbook-phase-title">🏛️ Appraisal & Alternative Dispute Resolution</div>
            <div class="playbook-phase-toggle">▼</div>
          </div>
          <div class="playbook-phase-body">
            <div class="timeline-indicator">
              <div class="timeline-dot"></div>
              <div class="timeline-text">Timeline: When formal escalation is needed</div>
            </div>
            
            <div class="step-grid">
              <div class="step-card">
                <div class="step-number">1</div>
                <div class="step-title">Invoke Appraisal Clause</div>
                <div class="step-description">Use policy's appraisal process for value disputes</div>
                <div class="step-actions">
                  <h4>Appraisal Process:</h4>
                  <ul>
                    <li>Review your policy's appraisal clause</li>
                    <li>Formally invoke appraisal in writing</li>
                    <li>Select qualified independent appraiser</li>
                    <li>Prepare comprehensive documentation</li>
                    <li>Participate fully in appraisal process</li>
                  </ul>
                </div>
                <div class="document-links">
                  <a href="#" class="document-link" onclick="openDocument('en/appraisal-demand-letter-sample.pdf')">Appraisal Demand</a>
                  <a href="#" class="document-link" onclick="openDocument('en/appraisal-process-guide-sample.pdf')">Process Guide</a>
                </div>
              </div>
              
              <div class="step-card">
                <div class="step-number">2</div>
                <div class="step-title">Mediation Process</div>
                <div class="step-description">Engage neutral mediator for settlement</div>
                <div class="step-actions">
                  <h4>Mediation Steps:</h4>
                  <ul>
                    <li>Agree on qualified mediator</li>
                    <li>Prepare comprehensive settlement package</li>
                    <li>Present your case professionally</li>
                    <li>Be prepared to compromise reasonably</li>
                    <li>Document all agreements reached</li>
                  </ul>
                </div>
              </div>
              
              <div class="step-card">
                <div class="step-number">3</div>
                <div class="step-title">Prepare for Litigation</div>
                <div class="step-description">Get ready for court if other methods fail</div>
                <div class="step-actions">
                  <h4>Litigation Preparation:</h4>
                  <ul>
                    <li>Consult with experienced insurance attorneys</li>
                    <li>Preserve all evidence and documentation</li>
                    <li>Understand statute of limitations</li>
                    <li>Calculate potential damages and costs</li>
                    <li>Consider settlement vs. litigation costs</li>
                  </ul>
                </div>
              </div>
            </div>
            
            <div class="success-box">
              <h4>✅ Pro Tip</h4>
              <p>Appraisal is often faster and less expensive than litigation. Most policies require both parties to accept the umpire's decision, making it binding.</p>
            </div>
          </div>
        </div>

        <!-- Phase 9: Settlement & Closure -->
        <div class="playbook-phase">
          <div class="playbook-phase-header" onclick="togglePlaybookPhase(this)">
            <div class="playbook-phase-number">9</div>
            <div class="playbook-phase-title">✅ Final Settlement & Claim Closure</div>
            <div class="playbook-phase-toggle">▼</div>
          </div>
          <div class="playbook-phase-body">
            <div class="timeline-indicator">
              <div class="timeline-dot"></div>
              <div class="timeline-text">Timeline: Final phase of claim process</div>
            </div>
            
            <div class="step-grid">
              <div class="step-card">
                <div class="step-number">1</div>
                <div class="step-title">Review Final Settlement</div>
                <div class="step-description">Carefully analyze the final settlement offer</div>
                <div class="step-actions">
                  <h4>Settlement Review:</h4>
                  <ul>
                    <li>Compare settlement to your documentation</li>
                    <li>Verify all covered damages are included</li>
                    <li>Check calculations and deductions</li>
                    <li>Ensure ALE and additional expenses covered</li>
                    <li>Review any release or waiver language</li>
                  </ul>
                </div>
              </div>
              
              <div class="step-card">
                <div class="step-number">2</div>
                <div class="step-title">Payment Processing</div>
                <div class="step-description">Ensure proper payment and documentation</div>
                <div class="step-actions">
                  <h4>Payment Steps:</h4>
                  <ul>
                    <li>Confirm payment method and timeline</li>
                    <li>Verify payment amounts match settlement</li>
                    <li>Track payment processing and delivery</li>
                    <li>Document all payments received</li>
                    <li>Address any payment discrepancies immediately</li>
                  </ul>
                </div>
                <div class="document-links">
                  <a href="#" class="document-link" onclick="openDocument('en/settlement-review-checklist-sample.pdf')">Settlement Review</a>
                  <a href="#" class="document-link" onclick="openDocument('en/claim-closure-letter-sample.pdf')">Closure Letter</a>
                </div>
              </div>
              
              <div class="step-card">
                <div class="step-number">3</div>
                <div class="step-title">Archive & Learn</div>
                <div class="step-description">Properly close out and learn from the experience</div>
                <div class="step-actions">
                  <h4>Closure Process:</h4>
                  <ul>
                    <li>Archive all claim documents securely</li>
                    <li>Update your insurance coverage if needed</li>
                    <li>Review lessons learned from the process</li>
                    <li>Share feedback with insurance company</li>
                    <li>Consider preventive measures for future</li>
                  </ul>
                </div>
              </div>
            </div>
            
            <div class="success-box">
              <h4>🎉 Congratulations!</h4>
              <p>You've successfully navigated the complex insurance claim process. Your persistence and attention to detail have paid off. Consider this experience valuable knowledge for any future claims.</p>
            </div>
          </div>
        </div>

      </div>
    </div>

    <!-- Claim Timeline & Sequence Guide -->
    <div id="claim-timeline-guide" class="tab-content">
      <h2>📅 Claim Timeline & Sequence Guide</h2>
      <p>Your complete roadmap from loss to recovery. This guide covers every phase of the insurance claim process, with checklists, deadlines, escalation triggers, and success strategies.</p>

      <div class="playbook-overview">
        <h3>🎯 Your Complete Claim Success Timeline</h3>
        <p>Navigate every phase of your insurance claim with confidence. This comprehensive guide provides step-by-step timelines, critical deadlines, escalation strategies, and success tactics to maximize your settlement.</p>
      </div>

      <div class="playbook-container">
        <!-- Critical First Notice -->
        <div class="playbook-phase active">
          <div class="playbook-phase-header" onclick="togglePlaybookPhase(this)">
            <div class="playbook-phase-number">!</div>
            <div class="playbook-phase-title">🚨 Critical First Notice</div>
            <div class="playbook-phase-toggle">▼</div>
          </div>
          <div class="playbook-phase-body">
            <div class="step-grid">
              <div class="step-card">
                <div class="step-number">1</div>
                <div class="step-title">Safety First</div>
                <div class="step-description">Ensure safety, evacuate if necessary</div>
                <div class="step-actions">
                  <h4>Immediate Actions:</h4>
                  <ul>
                    <li>Call 911 for emergencies</li>
                    <li>Shut off utilities if compromised</li>
                    <li>Document everything before moving items</li>
                    <li>Secure property against further damage</li>
                  </ul>
                </div>
              </div>
            </div>

            <h3 style="color: var(--primary); margin: 2rem 0 1rem 0;">Time-Sensitive Deadlines by State</h3>
            <div style="overflow-x: auto; margin: 1rem 0;">
              <table style="width: 100%; border-collapse: collapse; border: 1px solid var(--border); font-size: 0.9rem;">
                <thead style="background: var(--bg-light);">
                  <tr>
                    <th style="border: 1px solid var(--border); padding: 0.5rem; text-align: left;">State</th>
                    <th style="border: 1px solid var(--border); padding: 0.5rem; text-align: left;">Notice of Loss</th>
                    <th style="border: 1px solid var(--border); padding: 0.5rem; text-align: left;">Proof of Loss</th>
                    <th style="border: 1px solid var(--border); padding: 0.5rem; text-align: left;">Inventory</th>
                    <th style="border: 1px solid var(--border); padding: 0.5rem; text-align: left;">Appraisal Demand</th>
                    <th style="border: 1px solid var(--border); padding: 0.5rem; text-align: left;">Suit Deadline</th>
                  </tr>
                </thead>
                <tbody>
                  <tr><td style="border: 1px solid var(--border); padding: 0.5rem;">CA</td><td style="border: 1px solid var(--border); padding: 0.5rem;">Immediately</td><td style="border: 1px solid var(--border); padding: 0.5rem;">60 days</td><td style="border: 1px solid var(--border); padding: 0.5rem;">60 days</td><td style="border: 1px solid var(--border); padding: 0.5rem;">Within POL</td><td style="border: 1px solid var(--border); padding: 0.5rem;">2 years</td></tr>
                  <tr><td style="border: 1px solid var(--border); padding: 0.5rem;">FL</td><td style="border: 1px solid var(--border); padding: 0.5rem;">Promptly</td><td style="border: 1px solid var(--border); padding: 0.5rem;">60 days*</td><td style="border: 1px solid var(--border); padding: 0.5rem;">60 days</td><td style="border: 1px solid var(--border); padding: 0.5rem;">60 days</td><td style="border: 1px solid var(--border); padding: 0.5rem;">5 yrs (3 hurricane)</td></tr>
                  <tr><td style="border: 1px solid var(--border); padding: 0.5rem;">TX</td><td style="border: 1px solid var(--border); padding: 0.5rem;">Promptly</td><td style="border: 1px solid var(--border); padding: 0.5rem;">91 days</td><td style="border: 1px solid var(--border); padding: 0.5rem;">91 days</td><td style="border: 1px solid var(--border); padding: 0.5rem;">60 days</td><td style="border: 1px solid var(--border); padding: 0.5rem;">2 years</td></tr>
                  <tr><td style="border: 1px solid var(--border); padding: 0.5rem;">NY</td><td style="border: 1px solid var(--border); padding: 0.5rem;">Promptly</td><td style="border: 1px solid var(--border); padding: 0.5rem;">60 days</td><td style="border: 1px solid var(--border); padding: 0.5rem;">60 days</td><td style="border: 1px solid var(--border); padding: 0.5rem;">60 days</td><td style="border: 1px solid var(--border); padding: 0.5rem;">3 years</td></tr>
                  <tr><td style="border: 1px solid var(--border); padding: 0.5rem;">IL</td><td style="border: 1px solid var(--border); padding: 0.5rem;">Promptly</td><td style="border: 1px solid var(--border); padding: 0.5rem;">60 days</td><td style="border: 1px solid var(--border); padding: 0.5rem;">60 days</td><td style="border: 1px solid var(--border); padding: 0.5rem;">60 days</td><td style="border: 1px solid var(--border); padding: 0.5rem;">2 years</td></tr>
                  <tr><td style="border: 1px solid var(--border); padding: 0.5rem;">GA</td><td style="border: 1px solid var(--border); padding: 0.5rem;">Promptly</td><td style="border: 1px solid var(--border); padding: 0.5rem;">60 days</td><td style="border: 1px solid var(--border); padding: 0.5rem;">60 days</td><td style="border: 1px solid var(--border); padding: 0.5rem;">60 days</td><td style="border: 1px solid var(--border); padding: 0.5rem;">2 years</td></tr>
                  <tr><td style="border: 1px solid var(--border); padding: 0.5rem;">NC</td><td style="border: 1px solid var(--border); padding: 0.5rem;">Promptly</td><td style="border: 1px solid var(--border); padding: 0.5rem;">60 days</td><td style="border: 1px solid var(--border); padding: 0.5rem;">60 days</td><td style="border: 1px solid var(--border); padding: 0.5rem;">60 days</td><td style="border: 1px solid var(--border); padding: 0.5rem;">3 years</td></tr>
                  <tr><td style="border: 1px solid var(--border); padding: 0.5rem;">SC</td><td style="border: 1px solid var(--border); padding: 0.5rem;">Promptly</td><td style="border: 1px solid var(--border); padding: 0.5rem;">60 days</td><td style="border: 1px solid var(--border); padding: 0.5rem;">60 days</td><td style="border: 1px solid var(--border); padding: 0.5rem;">60 days</td><td style="border: 1px solid var(--border); padding: 0.5rem;">3 years</td></tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- Phase 1: Immediate Response -->
        <div class="playbook-phase">
          <div class="playbook-phase-header" onclick="togglePlaybookPhase(this)">
            <div class="playbook-phase-number">1</div>
            <div class="playbook-phase-title">⚡ Phase 1: Immediate Response (0–24 Hours)</div>
            <div class="playbook-phase-toggle">▼</div>
          </div>
          <div class="playbook-phase-body">
            <div class="timeline-indicator">
              <div class="timeline-dot"></div>
              <div class="timeline-text">Timeline: First 24 hours after loss</div>
            </div>
            <div class="step-grid">
              <div class="step-card">
                <div class="step-number">1</div>
                <div class="step-title">Safety Secured</div>
                <div class="step-description">Ensure all safety measures are in place</div>
              </div>
              <div class="step-card">
                <div class="step-number">2</div>
                <div class="step-title">Insurance Notified</div>
                <div class="step-description">Report claim and obtain claim number</div>
              </div>
              <div class="step-card">
                <div class="step-number">3</div>
                <div class="step-title">Documentation Started</div>
                <div class="step-description">Photos taken before cleanup, claim diary begun</div>
              </div>
              <div class="step-card">
                <div class="step-number">4</div>
                <div class="step-title">Property Protected</div>
                <div class="step-description">Emergency contractors contacted, temporary shelter arranged</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Phase 2: Early Claim Stage -->
        <div class="playbook-phase">
          <div class="playbook-phase-header" onclick="togglePlaybookPhase(this)">
            <div class="playbook-phase-number">2</div>
            <div class="playbook-phase-title">📋 Phase 2: Early Claim Stage (Days 1–7)</div>
            <div class="playbook-phase-toggle">▼</div>
          </div>
          <div class="playbook-phase-body">
            <div class="timeline-indicator">
              <div class="timeline-dot"></div>
              <div class="timeline-text">Timeline: Days 1-7 after loss</div>
            </div>
            <p style="margin-bottom: 1rem; color: var(--text-secondary);">Documentation intensive period, engaging professionals, handling ALE (Additional Living Expenses), and preparing for adjuster meeting.</p>
            <div class="step-grid">
              <div class="step-card">
                <div class="step-number">1</div>
                <div class="step-title">Complete Damage List</div>
                <div class="step-description">Document all damage and collect receipts</div>
              </div>
              <div class="step-card">
                <div class="step-number">2</div>
                <div class="step-title">Start Inventory</div>
                <div class="step-description">Begin detailed personal property inventory</div>
              </div>
              <div class="step-card">
                <div class="step-number">3</div>
                <div class="step-title">Prepare Documentation</div>
                <div class="step-description">Create comprehensive package for adjuster meeting</div>
              </div>
              <div class="step-card">
                <div class="step-number">4</div>
                <div class="step-title">Watch for Red Flags</div>
                <div class="step-description">🚩 Monitor for lowball offers or undue pressure</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Phase 3: Investigation Stage -->
        <div class="playbook-phase">
          <div class="playbook-phase-header" onclick="togglePlaybookPhase(this)">
            <div class="playbook-phase-number">3</div>
            <div class="playbook-phase-title">🔍 Phase 3: Investigation Stage (Weeks 2–4)</div>
            <div class="playbook-phase-toggle">▼</div>
          </div>
          <div class="playbook-phase-body">
            <div class="timeline-indicator">
              <div class="timeline-dot"></div>
              <div class="timeline-text">Timeline: Weeks 2-4 after loss</div>
            </div>
            <div class="step-grid">
              <div class="step-card">
                <div class="step-number">1</div>
                <div class="step-title">Get Multiple Estimates</div>
                <div class="step-description">Obtain 2-3 detailed contractor estimates</div>
              </div>
              <div class="step-card">
                <div class="step-number">2</div>
                <div class="step-title">Verify Coverage</div>
                <div class="step-description">Confirm dwelling, ALE, code upgrades, mold, deductibles</div>
              </div>
              <div class="step-card">
                <div class="step-number">3</div>
                <div class="step-title">Submit Supplements</div>
                <div class="step-description">Promptly address discrepancies with supplements</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Phase 4: Negotiation Stage -->
        <div class="playbook-phase">
          <div class="playbook-phase-header" onclick="togglePlaybookPhase(this)">
            <div class="playbook-phase-number">4</div>
            <div class="playbook-phase-title">💬 Phase 4: Negotiation Stage (Months 2–3)</div>
            <div class="playbook-phase-toggle">▼</div>
          </div>
          <div class="playbook-phase-body">
            <div class="timeline-indicator">
              <div class="timeline-dot"></div>
              <div class="timeline-text">Timeline: Months 2-3 after loss</div>
            </div>
            <div class="step-grid">
              <div class="step-card">
                <div class="step-number">1</div>
                <div class="step-title">Never Accept First Offer</div>
                <div class="step-description">Always negotiate for better terms</div>
              </div>
              <div class="step-card">
                <div class="step-number">2</div>
                <div class="step-title">Compare Line Items</div>
                <div class="step-description">Match contractor estimates with insurer estimates</div>
              </div>
              <div class="step-card">
                <div class="step-number">3</div>
                <div class="step-title">Escalate When Needed</div>
                <div class="step-description">Adjuster → Supervisor → Manager → DOI/Appraisal</div>
              </div>
              <div class="step-card">
                <div class="step-number">4</div>
                <div class="step-title">Consider Public Adjuster</div>
                <div class="step-description">For large/complex claims, professional help may be needed</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Phase 5: Settlement Stage -->
        <div class="playbook-phase">
          <div class="playbook-phase-header" onclick="togglePlaybookPhase(this)">
            <div class="playbook-phase-number">5</div>
            <div class="playbook-phase-title">✅ Phase 5: Settlement Stage (Months 3–4)</div>
            <div class="playbook-phase-toggle">▼</div>
          </div>
          <div class="playbook-phase-body">
            <div class="timeline-indicator">
              <div class="timeline-dot"></div>
              <div class="timeline-text">Timeline: Months 3-4 after loss</div>
            </div>
            <div class="warning-box">
              <h4>⚠️ Before Signing Settlement</h4>
              <p>Confirm all damages included, code upgrades covered, depreciation recoverable, and release language protects your rights.</p>
            </div>
          </div>
        </div>

        <!-- Phase 6: Repair Stage -->
        <div class="playbook-phase">
          <div class="playbook-phase-header" onclick="togglePlaybookPhase(this)">
            <div class="playbook-phase-number">6</div>
            <div class="playbook-phase-title">🔨 Phase 6: Repair Stage (Months 4–8)</div>
            <div class="playbook-phase-toggle">▼</div>
          </div>
          <div class="playbook-phase-body">
            <div class="timeline-indicator">
              <div class="timeline-dot"></div>
              <div class="timeline-text">Timeline: Months 4-8 after loss</div>
            </div>
            <p>Pre-construction checklist, monitor weekly progress, and manage hidden damage/change orders with photos and supplements.</p>
          </div>
        </div>

        <!-- Phase 7: Completion Stage -->
        <div class="playbook-phase">
          <div class="playbook-phase-header" onclick="togglePlaybookPhase(this)">
            <div class="playbook-phase-number">7</div>
            <div class="playbook-phase-title">🏁 Phase 7: Completion Stage (Month 8+)</div>
            <div class="playbook-phase-toggle">▼</div>
          </div>
          <div class="playbook-phase-body">
            <div class="timeline-indicator">
              <div class="timeline-dot"></div>
              <div class="timeline-text">Timeline: Month 8+ after loss</div>
            </div>
            <div class="step-grid">
              <div class="step-card">
                <div class="step-number">1</div>
                <div class="step-title">Final Inspections</div>
                <div class="step-description">Complete punch list and final walkthrough</div>
              </div>
              <div class="step-card">
                <div class="step-number">2</div>
                <div class="step-title">Recover Depreciation</div>
                <div class="step-description">Submit invoices, proof of payment, photos</div>
              </div>
              <div class="step-card">
                <div class="step-number">3</div>
                <div class="step-title">Collect Documentation</div>
                <div class="step-description">Ensure lien waivers and warranties are collected</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Phase 8: Post-Settlement -->
        <div class="playbook-phase">
          <div class="playbook-phase-header" onclick="togglePlaybookPhase(this)">
            <div class="playbook-phase-number">8</div>
            <div class="playbook-phase-title">📁 Phase 8: Post-Settlement</div>
            <div class="playbook-phase-toggle">▼</div>
          </div>
          <div class="playbook-phase-body">
            <p>Confirm claim closure, archive documents, assess tax impacts, and review coverage needs for the future.</p>
          </div>
        </div>

        <!-- Special Circumstances -->
        <div class="playbook-phase">
          <div class="playbook-phase-header" onclick="togglePlaybookPhase(this)">
            <div class="playbook-phase-number">⚡</div>
            <div class="playbook-phase-title">🎯 Special Circumstances</div>
            <div class="playbook-phase-toggle">▼</div>
          </div>
          <div class="playbook-phase-body">
            <div class="step-grid">
              <div class="step-card">
                <div class="step-number">BI</div>
                <div class="step-title">Business Interruption</div>
                <div class="step-description">Monthly/quarterly documentation required</div>
              </div>
              <div class="step-card">
                <div class="step-number">CAT</div>
                <div class="step-title">Catastrophe Claims</div>
                <div class="step-description">Expect longer timelines due to volume</div>
              </div>
              <div class="step-card">
                <div class="step-number">TL</div>
                <div class="step-title">Total Loss Claims</div>
                <div class="step-description">Salvage, valuation, negotiation, payoff</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Escalation Triggers -->
        <div class="playbook-phase">
          <div class="playbook-phase-header" onclick="togglePlaybookPhase(this)">
            <div class="playbook-phase-number">⚠</div>
            <div class="playbook-phase-title">🚨 Escalation Triggers & Deadlines</div>
            <div class="playbook-phase-toggle">▼</div>
          </div>
          <div class="playbook-phase-body">
            <div class="warning-box">
              <h4>🚩 Critical Escalation Points</h4>
              <ul style="margin: 0; padding-left: 1.2rem;">
                <li>No adjuster contact in 72 hrs → escalate</li>
                <li>No inspection in 7 days → escalate</li>
                <li>No estimate in 14 days → escalate</li>
                <li>No settlement offer in 30 days → escalate</li>
                <li>Claim denied → escalate immediately</li>
              </ul>
            </div>
          </div>
        </div>

        <!-- Success Strategies -->
        <div class="playbook-phase">
          <div class="playbook-phase-header" onclick="togglePlaybookPhase(this)">
            <div class="playbook-phase-number">💡</div>
            <div class="playbook-phase-title">🎯 Success Strategies</div>
            <div class="playbook-phase-toggle">▼</div>
          </div>
          <div class="playbook-phase-body">
            <div class="success-box">
              <h4>✅ Key Success Factors</h4>
              <p>Document everything, act promptly, never rely on verbal promises, respond quickly, and know your rights.</p>
            </div>
          </div>
        </div>

        <!-- Common Pitfalls -->
        <div class="playbook-phase">
          <div class="playbook-phase-header" onclick="togglePlaybookPhase(this)">
            <div class="playbook-phase-number">⚠</div>
            <div class="playbook-phase-title">🚫 Common Pitfalls to Avoid</div>
            <div class="playbook-phase-toggle">▼</div>
          </div>
          <div class="playbook-phase-body">
            <div class="warning-box">
              <h4>🚩 Critical Mistakes to Avoid</h4>
              <ol style="margin: 0; padding-left: 1.2rem;">
                <li>Waiting to report claim</li>
                <li>Delaying mitigation</li>
                <li>Missing proof of loss deadline</li>
                <li>Accepting verbal promises</li>
                <li>Delaying contractor selection</li>
                <li>Ignoring correspondence</li>
                <li>Missing supplement windows</li>
                <li>Waiting for perfect documentation</li>
                <li>Missing statute of limitations</li>
              </ol>
            </div>
          </div>
        </div>

        <!-- Final Reminders -->
        <div class="playbook-phase">
          <div class="playbook-phase-header" onclick="togglePlaybookPhase(this)">
            <div class="playbook-phase-number">💎</div>
            <div class="playbook-phase-title">⭐ Final Success Reminders</div>
            <div class="playbook-phase-toggle">▼</div>
          </div>
          <div class="playbook-phase-body">
            <div class="success-box">
              <h4>🎯 Your Success Checklist</h4>
              <ul style="margin: 0; padding-left: 1.2rem;">
                <li>Document Everything – photos, receipts, conversations</li>
                <li>Act Promptly – but don't rush into bad decisions</li>
                <li>Know Your Policy</li>
                <li>Get Everything in Writing</li>
                <li>Be Persistent – don't accept "no" without reason</li>
                <li>Stay Organized</li>
                <li>Know Your Rights</li>
                <li>Get Help When Needed</li>
              </ul>
            </div>
          </div>
        </div>
      </div>

      <!-- PDF Download Section -->
      <div style="margin-top: 2rem; padding: 1.5rem; background: linear-gradient(135deg, #f0f9ff, #e0f2fe); border-radius: 12px; border-left: 5px solid var(--primary);">
        <h3 style="color: var(--primary); margin: 0 0 1rem 0; font-size: 1.2rem;">📄 Complete Guide Download</h3>
        <p style="margin: 0 0 1rem 0; color: #374151;">Access the complete detailed guide with additional tables, checklists, and reference materials.</p>
        <a href="/docs/en/claim-timeline-sequence-guide.pdf" 
           class="btn-primary" 
           target="_blank" 
           rel="noopener noreferrer"
           style="text-decoration: none;">
          📄 Download Full PDF Guide
        </a>
      </div>
    </div>

    <!-- Claim Documentation Guides -->
    <div id="claim-documentation-guides" class="tab-content">
      <h2>Claim Documentation Guides</h2>
      <p>Expert guidance and recommended tools for every stage of your claim</p>

      <!-- 10 Essential Apps Guide -->
      <div class="tool-card" style="margin-bottom: 2rem;">
        <div class="tool-title">📱 10 Essential Apps Every Policyholder Needs</div>
        <div class="tool-desc">From document scanning to photo evidence, these apps will help you build a stronger claim. Includes our top picks for iOS and Android.</div>
        
        <div style="margin-top: 1rem;">
          <h4 style="color: var(--primary); margin-bottom: 1rem;">Document Scanning & Organization</h4>
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem; margin-bottom: 1.5rem;">
            <div style="background: #f8fafc; padding: 1rem; border-radius: 8px; border-left: 4px solid var(--primary);">
              <div style="font-weight: 600; margin-bottom: 0.5rem;">📄 Adobe Scan</div>
              <div style="font-size: 0.9rem; color: #64748b; margin-bottom: 0.5rem;">Free PDF scanner with OCR text recognition</div>
              <div style="font-size: 0.85rem; color: var(--primary); margin-bottom: 0.5rem;"><strong>Best for:</strong> Converting paper documents to searchable PDFs</div>
              <a href="https://www.amazon.com/dp/B00X4WHP5E?tag=ash202500-20" target="_blank" rel="noopener noreferrer" style="font-size: 0.85rem; color: var(--primary); text-decoration: none; font-weight: 500;">Get Adobe Scan →</a>
            </div>
            <div style="background: #f8fafc; padding: 1rem; border-radius: 8px; border-left: 4px solid var(--primary);">
              <div style="font-weight: 600; margin-bottom: 0.5rem;">📁 Dropbox</div>
              <div style="font-size: 0.9rem; color: #64748b; margin-bottom: 0.5rem;">Cloud storage with automatic photo backup</div>
              <div style="font-size: 0.85rem; color: var(--primary); margin-bottom: 0.5rem;"><strong>Best for:</strong> Secure document storage and sharing</div>
              <a href="https://www.dropbox.com/business" target="_blank" rel="noopener noreferrer" style="font-size: 0.85rem; color: var(--primary); text-decoration: none; font-weight: 500;">Get Dropbox Business →</a>
            </div>
            <div style="background: #f8fafc; padding: 1rem; border-radius: 8px; border-left: 4px solid var(--primary);">
              <div style="font-weight: 600; margin-bottom: 0.5rem;">📝 Evernote</div>
              <div style="font-size: 0.9rem; color: #64748b; margin-bottom: 0.5rem;">Note-taking with document attachment</div>
              <div style="font-size: 0.85rem; color: var(--primary); margin-bottom: 0.5rem;"><strong>Best for:</strong> Creating searchable claim journals</div>
              <a href="https://evernote.com" target="_blank" rel="noopener noreferrer" style="font-size: 0.85rem; color: var(--primary); text-decoration: none; font-weight: 500;">Get Evernote →</a>
            </div>
          </div>

          <h4 style="color: var(--primary); margin-bottom: 1rem;">Photo Documentation</h4>
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem; margin-bottom: 1.5rem;">
            <div style="background: #f8fafc; padding: 1rem; border-radius: 8px; border-left: 4px solid var(--primary);">
              <div style="font-weight: 600; margin-bottom: 0.5rem;">📸 Camera+ 2</div>
              <div style="font-size: 0.9rem; color: #64748b; margin-bottom: 0.5rem;">Professional camera app with manual controls</div>
              <div style="font-size: 0.85rem; color: var(--primary); margin-bottom: 0.5rem;"><strong>Best for:</strong> High-quality damage photos with metadata</div>
              <a href="https://apps.apple.com/app/camera-2/id6444682319" target="_blank" rel="noopener noreferrer" style="font-size: 0.85rem; color: var(--primary); text-decoration: none; font-weight: 500;">Get Camera+ 2 →</a>
            </div>
            <div style="background: #f8fafc; padding: 1rem; border-radius: 8px; border-left: 4px solid var(--primary);">
              <div style="font-weight: 600; margin-bottom: 0.5rem;">📏 Photo Measures</div>
              <div style="font-size: 0.9rem; color: #64748b; margin-bottom: 0.5rem;">Add measurements and annotations to photos</div>
              <div style="font-size: 0.85rem; color: var(--primary); margin-bottom: 0.5rem;"><strong>Best for:</strong> Documenting damage dimensions</div>
              <a href="https://apps.apple.com/app/photo-measures/id337025123" target="_blank" rel="noopener noreferrer" style="font-size: 0.85rem; color: var(--primary); text-decoration: none; font-weight: 500;">Get Photo Measures →</a>
            </div>
            <div style="background: #f8fafc; padding: 1rem; border-radius: 8px; border-left: 4px solid var(--primary);">
              <div style="font-weight: 600; margin-bottom: 0.5rem;">🌧️ Moisture Meter</div>
              <div style="font-size: 0.9rem; color: #64748b; margin-bottom: 0.5rem;">Detect water damage with your phone</div>
              <div style="font-size: 0.85rem; color: var(--primary); margin-bottom: 0.5rem;"><strong>Best for:</strong> Water damage documentation</div>
              <a href="https://www.amazon.com/dp/B09B1DHP5F?tag=ash202500-20" target="_blank" rel="noopener noreferrer" style="font-size: 0.85rem; color: var(--primary); text-decoration: none; font-weight: 500;">Get Photo Evidence Kit →</a>
            </div>
          </div>

          <h4 style="color: var(--primary); margin-bottom: 1rem;">Communication & Tracking</h4>
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem; margin-bottom: 1.5rem;">
            <div style="background: #f8fafc; padding: 1rem; border-radius: 8px; border-left: 4px solid var(--primary);">
              <div style="font-weight: 600; margin-bottom: 0.5rem;">📞 Call Recorder</div>
              <div style="font-size: 0.9rem; color: #64748b; margin-bottom: 0.5rem;">Record phone calls with adjusters (check local laws)</div>
              <div style="font-size: 0.85rem; color: var(--primary); margin-bottom: 0.5rem;"><strong>Best for:</strong> Documenting conversations</div>
              <a href="https://apps.apple.com/app/tapeacall-call-recorder/id292990399" target="_blank" rel="noopener noreferrer" style="font-size: 0.85rem; color: var(--primary); text-decoration: none; font-weight: 500;">Get Call Recorder →</a>
            </div>
            <div style="background: #f8fafc; padding: 1rem; border-radius: 8px; border-left: 4px solid var(--primary);">
              <div style="font-weight: 600; margin-bottom: 0.5rem;">📅 Google Calendar</div>
              <div style="font-size: 0.9rem; color: #64748b; margin-bottom: 0.5rem;">Track deadlines and appointments</div>
              <div style="font-size: 0.85rem; color: var(--primary); margin-bottom: 0.5rem;"><strong>Best for:</strong> Meeting reminders and deadline tracking</div>
              <a href="https://calendar.google.com" target="_blank" rel="noopener noreferrer" style="font-size: 0.85rem; color: var(--primary); text-decoration: none; font-weight: 500;">Get Google Calendar →</a>
            </div>
            <div style="background: #f8fafc; padding: 1rem; border-radius: 8px; border-left: 4px solid var(--primary);">
              <div style="font-weight: 600; margin-bottom: 0.5rem;">📧 Gmail</div>
              <div style="font-size: 0.9rem; color: #64748b; margin-bottom: 0.5rem;">Email with automatic backup and search</div>
              <div style="font-size: 0.85rem; color: var(--primary); margin-bottom: 0.5rem;"><strong>Best for:</strong> Email correspondence tracking</div>
              <a href="https://gmail.com" target="_blank" rel="noopener noreferrer" style="font-size: 0.85rem; color: var(--primary); text-decoration: none; font-weight: 500;">Get Gmail →</a>
            </div>
          </div>

          <h4 style="color: var(--primary); margin-bottom: 1rem;">Financial Tracking</h4>
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem; margin-bottom: 1.5rem;">
            <div style="background: #f8fafc; padding: 1rem; border-radius: 8px; border-left: 4px solid var(--primary);">
              <div style="font-weight: 600; margin-bottom: 0.5rem;">💰 Mint</div>
              <div style="font-size: 0.9rem; color: #64748b; margin-bottom: 0.5rem;">Track expenses and receipts</div>
              <div style="font-size: 0.85rem; color: var(--primary); margin-bottom: 0.5rem;"><strong>Best for:</strong> Additional Living Expenses (ALE) tracking</div>
              <a href="https://mint.intuit.com" target="_blank" rel="noopener noreferrer" style="font-size: 0.85rem; color: var(--primary); text-decoration: none; font-weight: 500;">Get Mint →</a>
            </div>
            <div style="background: #f8fafc; padding: 1rem; border-radius: 8px; border-left: 4px solid var(--primary);">
              <div style="font-weight: 600; margin-bottom: 0.5rem;">🧾 Receipt Scanner</div>
              <div style="font-size: 0.9rem; color: #64748b; margin-bottom: 0.5rem;">Digitize and categorize receipts</div>
              <div style="font-size: 0.85rem; color: var(--primary); margin-bottom: 0.5rem;"><strong>Best for:</strong> Expense documentation</div>
              <a href="https://www.expensify.com" target="_blank" rel="noopener noreferrer" style="font-size: 0.85rem; color: var(--primary); text-decoration: none; font-weight: 500;">Get Expensify →</a>
            </div>
          </div>
        </div>
        
        <!-- Affiliate Disclosure -->
        <div style="background: #f1f5f9; padding: 1rem; border-radius: 8px; margin-top: 1.5rem; border-left: 4px solid #3b82f6;">
          <div style="font-size: 0.9rem; color: #475569;">
            <strong>Affiliate Disclosure:</strong> This section contains affiliate links. We may earn a commission at no extra cost to you if you purchase through these links. We only recommend tools we believe add value to your claim process.
          </div>
        </div>
      </div>

      <!-- Photography Guide -->
      <div class="tool-card" style="margin-bottom: 2rem;">
        <div class="tool-title">📸 How to Properly Photograph Property Damage</div>
        <div class="tool-desc">Professional techniques and equipment recommendations to document damage effectively. Plus our recommended photography kit.</div>
        
        <div style="margin-top: 1rem;">
          <h4 style="color: var(--primary); margin-bottom: 1rem;">Essential Photography Techniques</h4>
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem; margin-bottom: 1.5rem;">
            <div style="background: #f8fafc; padding: 1rem; border-radius: 0.5rem; border: 1px solid var(--border);">
              <h5 style="color: var(--primary); margin-bottom: 0.5rem;">📐 Wide Shots First</h5>
              <p style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 0.5rem;">Start with overall context shots</p>
              <ul style="font-size: 0.8rem; color: var(--text-secondary); margin: 0; padding-left: 1rem;">
                <li>Show entire room or area</li>
                <li>Include reference points</li>
                <li>Establish damage location</li>
              </ul>
            </div>
            <div style="background: #f8fafc; padding: 1rem; border-radius: 0.5rem; border: 1px solid var(--border);">
              <h5 style="color: var(--primary); margin-bottom: 0.5rem;">🔍 Close-up Details</h5>
              <p style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 0.5rem;">Document specific damage</p>
              <ul style="font-size: 0.8rem; color: var(--text-secondary); margin: 0; padding-left: 1rem;">
                <li>Show material damage clearly</li>
                <li>Include measuring tape for scale</li>
                <li>Multiple angles of same damage</li>
              </ul>
            </div>
            <div style="background: #f8fafc; padding: 1rem; border-radius: 0.5rem; border: 1px solid var(--border);">
              <h5 style="color: var(--primary); margin-bottom: 0.5rem;">💡 Proper Lighting</h5>
              <p style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 0.5rem;">Ensure clear, well-lit photos</p>
              <ul style="font-size: 0.8rem; color: var(--text-secondary); margin: 0; padding-left: 1rem;">
                <li>Use natural light when possible</li>
                <li>Add flash for dark areas</li>
                <li>Avoid harsh shadows</li>
              </ul>
            </div>
          </div>

          <h4 style="color: var(--primary); margin-bottom: 1rem;">Recommended Equipment</h4>
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem; margin-bottom: 1.5rem;">
            <div style="background: #f8fafc; padding: 1rem; border-radius: 0.5rem; border: 1px solid var(--border);">
              <h5 style="color: var(--primary); margin-bottom: 0.5rem;">📱 Smartphone Accessories</h5>
              <ul style="font-size: 0.9rem; color: var(--text-secondary); margin: 0; padding-left: 1rem;">
                <li>LED light attachment ($15-30)</li>
                <li>Wide-angle lens attachment ($20-50)</li>
                <li>Phone tripod mount ($10-25)</li>
                <li>Waterproof case for wet areas ($20-40)</li>
              </ul>
            </div>
            <div style="background: #f8fafc; padding: 1rem; border-radius: 0.5rem; border: 1px solid var(--border);">
              <h5 style="color: var(--primary); margin-bottom: 0.5rem;">📏 Measuring Tools</h5>
              <ul style="font-size: 0.9rem; color: var(--text-secondary); margin: 0; padding-left: 1rem;">
                <li>25-foot measuring tape ($10-20)</li>
                <li>6-inch ruler for close-ups ($5-10)</li>
                <li>Laser distance measurer ($30-60)</li>
                <li>Digital level app (free)</li>
              </ul>
            </div>
            <div style="background: #f8fafc; padding: 1rem; border-radius: 0.5rem; border: 1px solid var(--border);">
              <h5 style="color: var(--primary); margin-bottom: 0.5rem;">🔧 Professional Tools</h5>
              <ul style="font-size: 0.9rem; color: var(--text-secondary); margin: 0; padding-left: 1rem;">
                <li>Moisture meter ($50-150)</li>
                <li>Thermal imaging camera ($200-500)</li>
                <li>Digital camera with macro lens ($300-800)</li>
                <li>Portable lighting kit ($100-300)</li>
              </ul>
            </div>
          </div>

          <h4 style="color: var(--primary); margin-bottom: 1rem;">Storage & Organization Best Practices</h4>
          <div style="background: #f0f9ff; padding: 1rem; border-radius: 0.5rem; border: 1px solid #0ea5e9;">
            <ul style="font-size: 0.9rem; color: var(--text-primary); margin: 0; padding-left: 1rem;">
              <li><strong>File Naming:</strong> Use descriptive names like "Kitchen_Water_Damage_2024-01-15_001.jpg"</li>
              <li><strong>Cloud Backup:</strong> Upload to multiple services (Google Drive, Dropbox, iCloud)</li>
              <li><strong>Metadata:</strong> Enable GPS and timestamp data in camera settings</li>
              <li><strong>Organization:</strong> Create folders by room/area and date</li>
              <li><strong>Backup:</strong> Keep physical copies on external hard drive</li>
            </ul>
          </div>
        </div>
      </div>

      <!-- Document Organization & Management Guide -->
      <div class="tool-card" style="margin-bottom: 2rem;">
        <div class="tool-title">📋 Document Organization & Management System</div>
        <div class="tool-desc">Complete system for organizing, tracking, and managing all claim-related documents throughout the entire claims process.</div>
        
        <div style="margin-top: 1rem;">
          <h4 style="color: var(--primary); margin-bottom: 1rem;">Document Categories & Filing System</h4>
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem; margin-bottom: 1.5rem;">
            <div style="background: #f8fafc; padding: 1rem; border-radius: 0.5rem; border: 1px solid var(--border);">
              <h5 style="color: var(--primary); margin-bottom: 0.5rem;">📄 Policy Documents</h5>
              <ul style="font-size: 0.9rem; color: var(--text-secondary); margin: 0; padding-left: 1rem;">
                <li>Insurance policy declarations</li>
                <li>Endorsements and riders</li>
                <li>Coverage schedules</li>
                <li>Deductible information</li>
              </ul>
            </div>
            <div style="background: #f8fafc; padding: 1rem; border-radius: 0.5rem; border: 1px solid var(--border);">
              <h5 style="color: var(--primary); margin-bottom: 0.5rem;">📸 Evidence & Photos</h5>
              <ul style="font-size: 0.9rem; color: var(--text-secondary); margin: 0; padding-left: 1rem;">
                <li>Damage photographs</li>
                <li>Before/after comparisons</li>
                <li>Video documentation</li>
                <li>Drone footage (if applicable)</li>
              </ul>
            </div>
            <div style="background: #f8fafc; padding: 1rem; border-radius: 0.5rem; border: 1px solid var(--border);">
              <h5 style="color: var(--primary); margin-bottom: 0.5rem;">💰 Financial Records</h5>
              <ul style="font-size: 0.9rem; color: var(--text-secondary); margin: 0; padding-left: 1rem;">
                <li>Receipts and invoices</li>
                <li>Contractor estimates</li>
                <li>Bank statements</li>
                <li>Tax returns (for BI claims)</li>
              </ul>
            </div>
          </div>

          <h4 style="color: var(--primary); margin-bottom: 1rem;">Digital Organization Best Practices</h4>
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem; margin-bottom: 1.5rem;">
            <div style="background: #f8fafc; padding: 1rem; border-radius: 0.5rem; border: 1px solid var(--border);">
              <h5 style="color: var(--primary); margin-bottom: 0.5rem;">📁 Folder Structure</h5>
              <ul style="font-size: 0.9rem; color: var(--text-secondary); margin: 0; padding-left: 1rem;">
                <li>01_Policy_Documents</li>
                <li>02_Claim_Forms</li>
                <li>03_Photos_Evidence</li>
                <li>04_Estimates_Receipts</li>
                <li>05_Correspondence</li>
                <li>06_Expert_Reports</li>
              </ul>
            </div>
            <div style="background: #f8fafc; padding: 1rem; border-radius: 0.5rem; border: 1px solid var(--border);">
              <h5 style="color: var(--primary); margin-bottom: 0.5rem;">🏷️ Naming Convention</h5>
              <ul style="font-size: 0.9rem; color: var(--text-secondary); margin: 0; padding-left: 1rem;">
                <li>YYYY-MM-DD_Description_Type</li>
                <li>Example: 2024-01-15_Roof_Damage_Photo_001.jpg</li>
                <li>Example: 2024-01-20_Contractor_Estimate_Roof.pdf</li>
                <li>Use consistent abbreviations</li>
              </ul>
            </div>
            <div style="background: #f8fafc; padding: 1rem; border-radius: 0.5rem; border: 1px solid var(--border);">
              <h5 style="color: var(--primary); margin-bottom: 0.5rem;">☁️ Cloud Storage Setup</h5>
              <ul style="font-size: 0.9rem; color: var(--text-secondary); margin: 0; padding-left: 1rem;">
                <li>Google Drive or Dropbox</li>
                <li>Automatic photo backup</li>
                <li>Share folders with adjuster</li>
                <li>Version control for documents</li>
              </ul>
            </div>
          </div>

          <h4 style="color: var(--primary); margin-bottom: 1rem;">Document Tracking & Timeline</h4>
          <div style="background: #f0f9ff; padding: 1rem; border-radius: 0.5rem; border: 1px solid #0ea5e9;">
            <ul style="font-size: 0.9rem; color: var(--text-primary); margin: 0; padding-left: 1rem;">
              <li><strong>Document Log:</strong> Maintain a master list of all documents with dates submitted</li>
              <li><strong>Follow-up Tracking:</strong> Track which documents have been acknowledged by the insurer</li>
              <li><strong>Deadline Management:</strong> Set reminders for document submission deadlines</li>
              <li><strong>Backup Strategy:</strong> Keep physical copies and multiple digital backups</li>
              <li><strong>Access Control:</strong> Share documents securely with authorized parties only</li>
            </ul>
          </div>
        </div>
      </div>

      <!-- Business Interruption Tools Guide -->
      <div class="tool-card">
        <div class="tool-title">💼 Business Interruption Documentation Tools</div>
        <div class="tool-desc">Essential accounting software and financial tools to prove your business losses. Compare QuickBooks, Xero, and more.</div>
        
        <div style="margin-top: 1rem;">
          <h4 style="color: var(--primary); margin-bottom: 1rem;">Accounting Software Comparison</h4>
          <div style="overflow-x: auto; margin-bottom: 1.5rem;">
            <table style="width: 100%; border-collapse: collapse; font-size: 0.9rem;">
              <thead>
                <tr style="background: var(--bg-light);">
                  <th style="padding: 0.75rem; border: 1px solid var(--border); text-align: left;">Software</th>
                  <th style="padding: 0.75rem; border: 1px solid var(--border); text-align: left;">Monthly Cost</th>
                  <th style="padding: 0.75rem; border: 1px solid var(--border); text-align: left;">Best For</th>
                  <th style="padding: 0.75rem; border: 1px solid var(--border); text-align: left;">BI Features</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td style="padding: 0.75rem; border: 1px solid var(--border);"><strong>QuickBooks Online</strong></td>
                  <td style="padding: 0.75rem; border: 1px solid var(--border);">$30-200</td>
                  <td style="padding: 0.75rem; border: 1px solid var(--border);">Small to medium businesses</td>
                  <td style="padding: 0.75rem; border: 1px solid var(--border);">Comprehensive reporting, P&L statements</td>
                </tr>
                <tr style="background: #f8fafc;">
                  <td style="padding: 0.75rem; border: 1px solid var(--border);"><strong>Xero</strong></td>
                  <td style="padding: 0.75rem; border: 1px solid var(--border);">$15-65</td>
                  <td style="padding: 0.75rem; border: 1px solid var(--border);">Service businesses</td>
                  <td style="padding: 0.75rem; border: 1px solid var(--border);">Real-time reporting, bank reconciliation</td>
                </tr>
                <tr>
                  <td style="padding: 0.75rem; border: 1px solid var(--border);"><strong>FreshBooks</strong></td>
                  <td style="padding: 0.75rem; border: 1px solid var(--border);">$17-55</td>
                  <td style="padding: 0.75rem; border: 1px solid var(--border);">Freelancers & small businesses</td>
                  <td style="padding: 0.75rem; border: 1px solid var(--border);">Time tracking, expense management</td>
                </tr>
                <tr style="background: #f8fafc;">
                  <td style="padding: 0.75rem; border: 1px solid var(--border);"><strong>Wave</strong></td>
                  <td style="padding: 0.75rem; border: 1px solid var(--border);">Free</td>
                  <td style="padding: 0.75rem; border: 1px solid var(--border);">Small businesses, startups</td>
                  <td style="padding: 0.75rem; border: 1px solid var(--border);">Basic reporting, receipt scanning</td>
                </tr>
              </tbody>
            </table>
          </div>

          <h4 style="color: var(--primary); margin-bottom: 1rem;">Essential Financial Reports for BI Claims</h4>
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem; margin-bottom: 1.5rem;">
            <div style="background: #f8fafc; padding: 1rem; border-radius: 0.5rem; border: 1px solid var(--border);">
              <h5 style="color: var(--primary); margin-bottom: 0.5rem;">📊 Profit & Loss Statements</h5>
              <p style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 0.5rem;">Monthly P&L for 12 months prior to loss</p>
              <ul style="font-size: 0.8rem; color: var(--text-secondary); margin: 0; padding-left: 1rem;">
                <li>Revenue trends and seasonality</li>
                <li>Operating expenses breakdown</li>
                <li>Net profit margins</li>
                <li>Year-over-year comparisons</li>
              </ul>
            </div>
            <div style="background: #f8fafc; padding: 1rem; border-radius: 0.5rem; border: 1px solid var(--border);">
              <h5 style="color: var(--primary); margin-bottom: 0.5rem;">💰 Cash Flow Statements</h5>
              <p style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 0.5rem;">Track money in and out of business</p>
              <ul style="font-size: 0.8rem; color: var(--text-secondary); margin: 0; padding-left: 1rem;">
                <li>Operating cash flow</li>
                <li>Investment activities</li>
                <li>Financing activities</li>
                <li>Working capital changes</li>
              </ul>
            </div>
            <div style="background: #f8fafc; padding: 1rem; border-radius: 0.5rem; border: 1px solid var(--border);">
              <h5 style="color: var(--primary); margin-bottom: 0.5rem;">📈 Revenue Analysis</h5>
              <p style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 0.5rem;">Detailed revenue breakdown and trends</p>
              <ul style="font-size: 0.8rem; color: var(--text-secondary); margin: 0; padding-left: 1rem;">
                <li>Daily/weekly revenue patterns</li>
                <li>Customer acquisition costs</li>
                <li>Average transaction values</li>
                <li>Seasonal adjustments</li>
              </ul>
            </div>
          </div>

          <h4 style="color: var(--primary); margin-bottom: 1rem;">Additional Documentation Tools</h4>
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem; margin-bottom: 1.5rem;">
            <div style="background: #f8fafc; padding: 1rem; border-radius: 0.5rem; border: 1px solid var(--border);">
              <h5 style="color: var(--primary); margin-bottom: 0.5rem;">📋 Expense Tracking</h5>
              <ul style="font-size: 0.9rem; color: var(--text-secondary); margin: 0; padding-left: 1rem;">
                <li><strong>Expensify:</strong> Receipt scanning and categorization</li>
                <li><strong>Receipt Bank:</strong> Automated expense management</li>
                <li><strong>MileIQ:</strong> Track business mileage</li>
                <li><strong>Concur:</strong> Corporate expense management</li>
              </ul>
            </div>
            <div style="background: #f8fafc; padding: 1rem; border-radius: 0.5rem; border: 1px solid var(--border);">
              <h5 style="color: var(--primary); margin-bottom: 0.5rem;">📊 Analytics & Reporting</h5>
              <ul style="font-size: 0.9rem; color: var(--text-secondary); margin: 0; padding-left: 1rem;">
                <li><strong>Tableau:</strong> Advanced data visualization</li>
                <li><strong>Power BI:</strong> Microsoft business intelligence</li>
                <li><strong>Google Analytics:</strong> Web traffic and conversion data</li>
                <li><strong>HubSpot:</strong> Customer relationship management</li>
              </ul>
            </div>
            <div style="background: #f8fafc; padding: 1rem; border-radius: 0.5rem; border: 1px solid var(--border);">
              <h5 style="color: var(--primary); margin-bottom: 0.5rem;">💳 Payment Processing</h5>
              <ul style="font-size: 0.9rem; color: var(--text-secondary); margin: 0; padding-left: 1rem;">
                <li><strong>Square:</strong> Point-of-sale and payment processing</li>
                <li><strong>PayPal:</strong> Online payment tracking</li>
                <li><strong>Stripe:</strong> E-commerce payment analytics</li>
                <li><strong>QuickBooks Payments:</strong> Integrated payment processing</li>
              </ul>
            </div>
          </div>

          <h4 style="color: var(--primary); margin-bottom: 1rem;">BI Claim Documentation Checklist</h4>
          <div style="background: #f0f9ff; padding: 1rem; border-radius: 0.5rem; border: 1px solid #0ea5e9;">
            <ul style="font-size: 0.9rem; color: var(--text-primary); margin: 0; padding-left: 1rem;">
              <li><strong>Financial Records:</strong> 3 years of tax returns, P&L statements, balance sheets</li>
              <li><strong>Bank Statements:</strong> 12 months of business bank account statements</li>
              <li><strong>Customer Records:</strong> Contracts, invoices, payment histories</li>
              <li><strong>Vendor Records:</strong> Supplier contracts, purchase orders, payment records</li>
              <li><strong>Employee Records:</strong> Payroll records, timesheets, employment contracts</li>
              <li><strong>Marketing Data:</strong> Advertising expenses, customer acquisition costs</li>
              <li><strong>Industry Benchmarks:</strong> Industry reports, competitor analysis</li>
              <li><strong>Recovery Plans:</strong> Business continuity plans, alternative arrangements</li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <!-- Recommended Resources -->
    <div id="recommended-resources" class="tab-content">
      <h2>Recommended Resources</h2>
      <p>Essential tools and services to help you build a stronger claim</p>
      
      <!-- Affiliate Disclosure -->
      <div style="background: #f1f5f9; padding: 1rem; border-radius: 8px; margin-bottom: 2rem; border-left: 4px solid #3b82f6;">
        <div style="font-size: 0.9rem; color: #475569;">
          <strong>Affiliate Disclosure:</strong> This page contains affiliate links. We may earn a commission at no extra cost to you if you purchase through these links. We only recommend tools we believe add value to your claim process.
        </div>
      </div>

      <!-- Resource Grid -->
      <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem;">
        <!-- Documentation Tools -->
        <div style="background: #f8fafc; padding: 1.5rem; border-radius: 8px; border: 1px solid var(--border);">
          <div style="background: var(--primary); color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600; display: inline-block; margin-bottom: 1rem;">DOCUMENTATION</div>
          <h4 style="color: var(--primary); margin-bottom: 0.5rem;">Adobe Scan</h4>
          <p style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 1rem;">Scan receipts and paperwork instantly with your phone.</p>
          <a href="https://www.amazon.com/dp/B00X4WHP5E?tag=ash202500-20" target="_blank" rel="noopener noreferrer" class="btn-secondary" style="text-decoration: none;" onclick="trackAffiliateClick('Adobe Scan', 'Amazon')">Learn More →</a>
        </div>

        <!-- Storage Tools -->
        <div style="background: #f8fafc; padding: 1.5rem; border-radius: 8px; border: 1px solid var(--border);">
          <div style="background: var(--primary); color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600; display: inline-block; margin-bottom: 1rem;">STORAGE</div>
          <h4 style="color: var(--primary); margin-bottom: 0.5rem;">Dropbox Business</h4>
          <p style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 1rem;">Secure cloud backup for all claim files with version history.</p>
          <a href="https://www.dropbox.com/business" target="_blank" rel="noopener noreferrer" class="btn-secondary" style="text-decoration: none;">Learn More →</a>
        </div>

        <!-- Organization Tools -->
        <div style="background: #f8fafc; padding: 1.5rem; border-radius: 8px; border: 1px solid var(--border);">
          <div style="background: var(--primary); color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600; display: inline-block; margin-bottom: 1rem;">ORGANIZATION</div>
          <h4 style="color: var(--primary); margin-bottom: 0.5rem;">Evernote</h4>
          <p style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 1rem;">Organize notes, communications, and claim timelines.</p>
          <a href="https://evernote.com" target="_blank" rel="noopener noreferrer" class="btn-secondary" style="text-decoration: none;">Learn More →</a>
        </div>

        <!-- Accounting Tools -->
        <div style="background: #f8fafc; padding: 1.5rem; border-radius: 8px; border: 1px solid var(--border);">
          <div style="background: var(--primary); color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600; display: inline-block; margin-bottom: 1rem;">ACCOUNTING</div>
          <h4 style="color: var(--primary); margin-bottom: 0.5rem;">QuickBooks</h4>
          <p style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 1rem;">Track ALE expenses, repairs, and reimbursements.</p>
          <a href="https://quickbooks.intuit.com" target="_blank" rel="noopener noreferrer" class="btn-secondary" style="text-decoration: none;">Learn More →</a>
        </div>

        <!-- Finance Tools -->
        <div style="background: #f8fafc; padding: 1.5rem; border-radius: 8px; border: 1px solid var(--border);">
          <div style="background: var(--primary); color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600; display: inline-block; margin-bottom: 1rem;">FINANCE</div>
          <h4 style="color: var(--primary); margin-bottom: 0.5rem;">Expensify</h4>
          <p style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 1rem;">Track meals, hotels, and receipts for reimbursement.</p>
          <a href="https://www.expensify.com" target="_blank" rel="noopener noreferrer" class="btn-secondary" style="text-decoration: none;">Learn More →</a>
        </div>

        <!-- Inventory Tools -->
        <div style="background: #f8fafc; padding: 1.5rem; border-radius: 8px; border: 1px solid var(--border);">
          <div style="background: var(--primary); color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600; display: inline-block; margin-bottom: 1rem;">INVENTORY</div>
          <h4 style="color: var(--primary); margin-bottom: 0.5rem;">Encircle</h4>
          <p style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 1rem;">Document personal property before and after a loss.</p>
          <a href="https://www.getencircle.com" target="_blank" rel="noopener noreferrer" class="btn-secondary" style="text-decoration: none;">Learn More →</a>
        </div>

        <!-- 3D Imaging Tools -->
        <div style="background: #f8fafc; padding: 1.5rem; border-radius: 8px; border: 1px solid var(--border);">
          <div style="background: var(--primary); color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600; display: inline-block; margin-bottom: 1rem;">3D IMAGING</div>
          <h4 style="color: var(--primary); margin-bottom: 0.5rem;">Matterport Pro2 3D Camera</h4>
          <p style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 1rem;">Capture immersive 3D scans of property damage.</p>
          <a href="https://www.amazon.com/dp/B072PC3K1W?tag=ash202500-20" target="_blank" rel="noopener noreferrer" class="btn-secondary" style="text-decoration: none;">Learn More →</a>
        </div>

        <!-- Contractor Services -->
        <div style="background: #f8fafc; padding: 1.5rem; border-radius: 8px; border: 1px solid var(--border);">
          <div style="background: var(--primary); color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600; display: inline-block; margin-bottom: 1rem;">CONTRACTORS</div>
          <h4 style="color: var(--primary); margin-bottom: 0.5rem;">Angi (Angie's List)</h4>
          <p style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 1rem;">Find vetted local contractors for repairs and restoration.</p>
          <a href="https://www.angi.com" target="_blank" rel="noopener noreferrer" class="btn-secondary" style="text-decoration: none;">Learn More →</a>
        </div>

        <!-- Contractor Services 2 -->
        <div style="background: #f8fafc; padding: 1.5rem; border-radius: 8px; border: 1px solid var(--border);">
          <div style="background: var(--primary); color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600; display: inline-block; margin-bottom: 1rem;">CONTRACTORS</div>
          <h4 style="color: var(--primary); margin-bottom: 0.5rem;">HomeAdvisor</h4>
          <p style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 1rem;">Connect with local contractors for roofing, HVAC, and repairs.</p>
          <a href="https://www.homeadvisor.com" target="_blank" rel="noopener noreferrer" class="btn-secondary" style="text-decoration: none;">Learn More →</a>
        </div>

        <!-- Photography Tools -->
        <div style="background: #f8fafc; padding: 1.5rem; border-radius: 8px; border: 1px solid var(--border);">
          <div style="background: var(--primary); color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600; display: inline-block; margin-bottom: 1rem;">PHOTOGRAPHY</div>
          <h4 style="color: var(--primary); margin-bottom: 0.5rem;">Photo Evidence Kit</h4>
          <p style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 1rem;">Tools for moisture testing, measurement, and damage documentation.</p>
          <a href="https://www.amazon.com/dp/B09B1DHP5F?tag=ash202500-20" target="_blank" rel="noopener noreferrer" class="btn-secondary" style="text-decoration: none;">Learn More →</a>
        </div>

        <!-- Security Tools -->
        <div style="background: #f8fafc; padding: 1.5rem; border-radius: 8px; border: 1px solid var(--border);">
          <div style="background: var(--primary); color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600; display: inline-block; margin-bottom: 1rem;">SECURITY</div>
          <h4 style="color: var(--primary); margin-bottom: 0.5rem;">Ring Security Camera</h4>
          <p style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 1rem;">Document property condition with continuous video evidence.</p>
          <a href="https://www.amazon.com/dp/B08F6GPQQ7?tag=ash202500-20" target="_blank" rel="noopener noreferrer" class="btn-secondary" style="text-decoration: none;">Learn More →</a>
        </div>

        <!-- Tools & Equipment -->
        <div style="background: #f8fafc; padding: 1.5rem; border-radius: 8px; border: 1px solid var(--border);">
          <div style="background: var(--primary); color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600; display: inline-block; margin-bottom: 1rem;">TOOLS & EQUIPMENT</div>
          <h4 style="color: var(--primary); margin-bottom: 0.5rem;">Home Depot</h4>
          <p style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 1rem;">Emergency supplies, tarps, tools, dehumidifiers, and fans.</p>
          <a href="https://www.homedepot.com" target="_blank" rel="noopener noreferrer" class="btn-secondary" style="text-decoration: none;">Learn More →</a>
        </div>

        <!-- Additional Resources (to reach 20 total) -->
        <div style="background: #f8fafc; padding: 1.5rem; border-radius: 8px; border: 1px solid var(--border);">
          <div style="background: var(--primary); color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600; display: inline-block; margin-bottom: 1rem;">DOCUMENTATION</div>
          <h4 style="color: var(--primary); margin-bottom: 0.5rem;">Google Drive</h4>
          <p style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 1rem;">Free cloud storage with 15GB space for document backup.</p>
          <a href="https://drive.google.com" target="_blank" rel="noopener noreferrer" class="btn-secondary" style="text-decoration: none;">Learn More →</a>
        </div>

        <div style="background: #f8fafc; padding: 1.5rem; border-radius: 8px; border: 1px solid var(--border);">
          <div style="background: var(--primary); color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600; display: inline-block; margin-bottom: 1rem;">PHOTOGRAPHY</div>
          <h4 style="color: var(--primary); margin-bottom: 0.5rem;">Adobe Lightroom Mobile</h4>
          <p style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 1rem;">Professional photo editing and organization on mobile.</p>
          <a href="https://apps.apple.com/app/adobe-lightroom-mobile/id804177739" target="_blank" rel="noopener noreferrer" class="btn-secondary" style="text-decoration: none;">Learn More →</a>
        </div>

        <div style="background: #f8fafc; padding: 1.5rem; border-radius: 8px; border: 1px solid var(--border);">
          <div style="background: var(--primary); color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600; display: inline-block; margin-bottom: 1rem;">FINANCE</div>
          <h4 style="color: var(--primary); margin-bottom: 0.5rem;">Mint</h4>
          <p style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 1rem;">Free personal finance tracking and budgeting app.</p>
          <a href="https://mint.intuit.com" target="_blank" rel="noopener noreferrer" class="btn-secondary" style="text-decoration: none;">Learn More →</a>
        </div>

        <div style="background: #f8fafc; padding: 1.5rem; border-radius: 8px; border: 1px solid var(--border);">
          <div style="background: var(--primary); color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600; display: inline-block; margin-bottom: 1rem;">COMMUNICATION</div>
          <h4 style="color: var(--primary); margin-bottom: 0.5rem;">Zoom</h4>
          <p style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 1rem;">Video calls with adjusters and contractors for remote meetings.</p>
          <a href="https://zoom.us" target="_blank" rel="noopener noreferrer" class="btn-secondary" style="text-decoration: none;">Learn More →</a>
        </div>

        <div style="background: #f8fafc; padding: 1.5rem; border-radius: 8px; border: 1px solid var(--border);">
          <div style="background: var(--primary); color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600; display: inline-block; margin-bottom: 1rem;">LEGAL</div>
          <h4 style="color: var(--primary); margin-bottom: 0.5rem;">LegalZoom</h4>
          <p style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 1rem;">Legal document preparation and attorney consultation services.</p>
          <a href="https://www.legalzoom.com" target="_blank" rel="noopener noreferrer" class="btn-secondary" style="text-decoration: none;">Learn More →</a>
        </div>

        <div style="background: #f8fafc; padding: 1.5rem; border-radius: 8px; border: 1px solid var(--border);">
          <div style="background: var(--primary); color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600; display: inline-block; margin-bottom: 1rem;">INSURANCE</div>
          <h4 style="color: var(--primary); margin-bottom: 0.5rem;">PolicyGenius</h4>
          <p style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 1rem;">Compare insurance policies and find better coverage options.</p>
          <a href="https://www.policygenius.com" target="_blank" rel="noopener noreferrer" class="btn-secondary" style="text-decoration: none;">Learn More →</a>
        </div>

        <div style="background: #f8fafc; padding: 1.5rem; border-radius: 8px; border: 1px solid var(--border);">
          <div style="background: var(--primary); color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600; display: inline-block; margin-bottom: 1rem;">REPAIR</div>
          <h4 style="color: var(--primary); margin-bottom: 0.5rem;">Lowe's</h4>
          <p style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 1rem;">Home improvement supplies, tools, and emergency repair materials.</p>
          <a href="https://www.lowes.com" target="_blank" rel="noopener noreferrer" class="btn-secondary" style="text-decoration: none;">Learn More →</a>
        </div>

        <div style="background: #f8fafc; padding: 1.5rem; border-radius: 8px; border: 1px solid var(--border);">
          <div style="background: var(--primary); color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600; display: inline-block; margin-bottom: 1rem;">TRANSPORTATION</div>
          <h4 style="color: var(--primary); margin-bottom: 0.5rem;">Uber</h4>
          <p style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 1rem;">Transportation for ALE expenses and claim-related travel.</p>
          <a href="https://www.uber.com" target="_blank" rel="noopener noreferrer" class="btn-secondary" style="text-decoration: none;">Learn More →</a>
        </div>

        <div style="background: #f8fafc; padding: 1.5rem; border-radius: 8px; border: 1px solid var(--border);">
          <div style="background: var(--primary); color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600; display: inline-block; margin-bottom: 1rem;">HOSPITALITY</div>
          <h4 style="color: var(--primary); margin-bottom: 0.5rem;">Airbnb</h4>
          <p style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 1rem;">Alternative accommodation during property repairs and restoration.</p>
          <a href="https://www.airbnb.com" target="_blank" rel="noopener noreferrer" class="btn-secondary" style="text-decoration: none;">Learn More →</a>
        </div>
      </div>
    </div>


    <!-- Settings -->
    <div id="settings" class="tab-content">
      <h2>Account Settings</h2>
      <h3>Credit Usage Log</h3>
      <table id="credit-log-table" border="1" cellspacing="0" cellpadding="6" style="width:100%; margin-bottom:1rem; border-collapse:collapse; font-size:0.9rem;">
        <thead style="background:#f3f4f6;">
          <tr>
            <th>Date</th>
            <th>Tool</th>
            <th>Language</th>
            <th>Tokens Used</th>
          </tr>
        </thead>
        <tbody id="credit-log-body">
          <tr><td colspan="4">Loading...</td></tr>
        </tbody>
      </table>
      <button class="btn-secondary" onclick="downloadAllOutputs()">Download All Outputs (ZIP)</button>
    </div>
  </main>

<script>
  // Version: 2025-01-18-v3 - Use ES6 modules for reliable Supabase loading
  let supabase = null;
  
  // Initialize Supabase client - using environment variables
  const isDevelopment = false; // Force production mode for live site
  
  // Initialize Supabase using ES6 modules (more reliable than dynamic script loading)
  async function initializeSupabase() {
    if (isDevelopment) {
      console.log('Development mode: Supabase not initialized');
      return null;
    }

    if (supabase) {
      return supabase;
    }

    try {
      // Use dynamic import for ES6 modules (more reliable than script tags)
      const { createClient } = await import('https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/+esm');
      
      supabase = createClient(
        "https://bnxvfxtpsxgfpltflyrr.supabase.co",
        "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJueHZmeHRwc3hnZnBsdGZseXJyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYzMjUyMDUsImV4cCI6MjA3MTkwMTIwNX0.6oW8eiy5Q6ruYLfitxYkUp5MmjmdycvVod--5hiFOks"
      );
      
      console.log('Supabase client initialized successfully with ES6 modules');
      return supabase;
    } catch (error) {
      console.error('Error initializing Supabase with ES6 modules:', error);
      
      // Fallback: Try alternative CDN
      try {
        console.log('Trying alternative CDN...');
        const { createClient } = await import('https://unpkg.com/@supabase/supabase-js@2/+esm');
        
        supabase = createClient(
          "https://bnxvfxtpsxgfpltflyrr.supabase.co",
          "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJueHZmeHRwc3hnZnBsdGZseXJyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYzMjUyMDUsImV4cCI6MjA3MTkwMTIwNX0.6oW8eiy5Q6ruYLfitxYkUp5MmjmdycvVod--5hiFOks"
        );
        
        console.log('Supabase client initialized successfully with alternative CDN');
        return supabase;
      } catch (fallbackError) {
        console.error('Error with alternative CDN:', fallbackError);
        return null;
      }
    }
  }

  // Fallback: Direct Supabase API calls without client library
  async function directSupabaseCall(endpoint, options = {}) {
    const supabaseUrl = "https://bnxvfxtpsxgfpltflyrr.supabase.co";
    const supabaseKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJueHZmeHRwc3hnZnBsdGZseXJyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYzMjUyMDUsImV4cCI6MjA3MTkwMTIwNX0.6oW8eiy5Q6ruYLfitxYkUp5MmjmdycvVod--5hiFOks";
    
    const response = await fetch(`${supabaseUrl}/rest/v1/${endpoint}`, {
      ...options,
      headers: {
        'apikey': supabaseKey,
        'Authorization': `Bearer ${supabaseKey}`,
        'Content-Type': 'application/json',
        ...options.headers
      }
    });
    
    if (!response.ok) {
      throw new Error(`Supabase API error: ${response.status} ${response.statusText}`);
    }
    
    return response.json();
  }

  // Initialize Supabase on page load
  document.addEventListener('DOMContentLoaded', () => {
    initializeSupabase();
  });

  // --- Tabs ---
  function switchTab(event, tab) {
    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
    document.getElementById(tab).classList.add('active');
    event.target.classList.add('active');
    
    // Load documents when My Documents tab is clicked
    if (tab === 'my-documents') {
      loadDocuments();
    }
  }

  function togglePlaybookPhase(header) {
    const phase = header.parentElement;
    const isActive = phase.classList.contains('active');
    
    // Close all phases
    document.querySelectorAll('.playbook-phase').forEach(p => p.classList.remove('active'));
    
    // Open clicked phase if it wasn't already active
    if (!isActive) {
      phase.classList.add('active');
    }
  }

  // Debug function to check if timeline guide is loading
  function debugTimelineGuide() {
    const timelineGuide = document.getElementById('claim-timeline-guide');
    if (timelineGuide) {
      console.log('Timeline guide found:', timelineGuide);
      const phases = timelineGuide.querySelectorAll('.playbook-phase');
      console.log('Found phases:', phases.length);
    } else {
      console.log('Timeline guide not found');
    }
  }

  // --- Affiliate Tracking ---
  function trackAffiliateClick(product, platform) {
    // Track affiliate link clicks for analytics
    const clickData = {
      product: product,
      platform: platform,
      timestamp: new Date().toISOString(),
      userAgent: navigator.userAgent,
      referrer: document.referrer
    };
    
    // Send to your analytics (you can use Google Analytics, Mixpanel, etc.)
    if (typeof gtag !== 'undefined') {
      gtag('event', 'affiliate_click', {
        'product_name': product,
        'platform': platform,
        'event_category': 'affiliate'
      });
    }
    
    // Log to console for debugging
    console.log('Affiliate click tracked:', clickData);
    
    // Optional: Send to your own tracking endpoint
    // fetch('/.netlify/functions/track-affiliate', {
    //   method: 'POST',
    //   headers: { 'Content-Type': 'application/json' },
    //   body: JSON.stringify(clickData)
    // }).catch(err => console.log('Tracking error:', err));
  }

  async function logout() {
    const isDevelopment = false; // Force production mode for live site
    
    if (isDevelopment) {
      alert("Development Mode: Would log out\n\nIn production, this would clear the session and redirect to login.");
      return;
    }
    
    if (supabase) {
    await supabase.auth.signOut();
    }
    window.location.href = "login.html";
  }

  function getLanguage() {
    return document.getElementById('language-select')?.value || 'en';
  }

  function addToHistory(tool, text) {
    const h = document.getElementById('session-history');
    const div = document.createElement('div');
    div.textContent = `[${tool}] ${text.substring(0, 100)}...`;
    h.appendChild(div);
  }

  // Helper: get auth header
  async function getAuthHeader() {
    const isDevelopment = false; // Force production mode for live site
    
    console.log('getAuthHeader called - hostname:', window.location.hostname);
    console.log('getAuthHeader called - protocol:', window.location.protocol);
    console.log('getAuthHeader called - isDevelopment:', isDevelopment);
    console.log('getAuthHeader called - supabase available:', !!supabase);
    
    if (isDevelopment) {
      // Development mode - return mock headers
      console.log('Development mode: Using mock auth headers');
      return { 'Content-Type': 'application/json' };
    }
    
    // Production mode - try Supabase client first, then fallback to direct API
    const client = await initializeSupabase();
    
    if (client) {
      try {
        const { data: { session } } = await client.auth.getSession();
        if (!session) throw new Error("Not logged in. Please log in and try again.");
        return { Authorization: `Bearer ${session.access_token}`, 'Content-Type': 'application/json' };
      } catch (error) {
        console.error('Auth error with Supabase client:', error);
        // Fall through to direct API approach
      }
    }
    
    // Fallback: Try to get token from localStorage or sessionStorage
    console.log('Supabase client failed, trying localStorage token');
    const token = localStorage.getItem('supabase.auth.token') || 
                  sessionStorage.getItem('supabase.auth.token') ||
                  localStorage.getItem('sb-access-token');
    
    if (token) {
      console.log('Found token in storage, using for authentication');
      return { Authorization: `Bearer ${token}`, 'Content-Type': 'application/json' };
    }
    
    // Last resort: no authentication
    console.log('No authentication available, proceeding without auth');
    return { 'Content-Type': 'application/json' };
  }

  // --- AI Agent ---
  async function generateResponse() {
    const input = document.getElementById('input-text').value.trim();
    if (!input) return alert("Please paste text first.");
    const out = document.getElementById('ai-output');
    out.style.display = 'block';
    out.innerHTML = `<div class="spinner"></div> Generating...`;

    try {
      // Development mode - use mock response
      const isDevelopment = false; // Force production mode for live site
      
      if (isDevelopment) {
        console.log('Development mode: Generating mock AI response...');
        // Mock response for development
        setTimeout(() => {
          try {
            const mockResponse = `Thank you for your correspondence regarding claim #${Math.floor(Math.random() * 10000)}.

Based on the information provided, I would like to address the following points:

1. **Policy Coverage Review**: Please provide additional documentation to support the claim as outlined in your policy terms.

2. **Damage Assessment**: We request a detailed assessment from a qualified contractor to evaluate the extent of damages.

3. **Timeline**: Please submit all required documentation within 30 days to avoid any delays in processing.

This is a mock AI-generated response for development testing. In production, this would be generated by OpenAI's GPT-4 model.

Best regards,
Policyholder Response Team`;

            console.log('Mock response generated:', mockResponse);
            out.textContent = mockResponse;
            
            // Safely update confidence meter
            const confidenceMeter = document.getElementById('confidence-meter');
            if (confidenceMeter) {
              confidenceMeter.innerText = "Confidence: High (Development Mode)";
            }
            
            // Safely add to history
            try {
              addToHistory("ai-agent", mockResponse);
            } catch (historyError) {
              console.log('History function not available:', historyError);
            }
            
            console.log('Mock response displayed successfully');
          } catch (error) {
            console.error('Error in mock response generation:', error);
            out.textContent = "Error in development mode: " + error.message;
          }
        }, 2000);
        return;
      }

      // Production mode - use real API
      const headers = await getAuthHeader();
      const res = await fetch('/.netlify/functions/generate-response', {
        method: 'POST',
        headers,
        body: JSON.stringify({ inputText: input, language: getLanguage() })
      });
      const data = await res.json();
      if (res.ok && data.draft) {
        out.textContent = data.draft;
        document.getElementById('confidence-meter').innerText = "Confidence: High";
        addToHistory("ai-agent", data.draft);
      } else {
        out.textContent = data.error || "Failed.";
      }
    } catch (e) {
      console.error(e);
      out.textContent = "Error generating response. Please check your connection and try again.";
    }
  }

  async function saveDraft() {
    const text = document.getElementById('ai-output').innerText;
    if (!text) return alert("No draft.");
    try {
      const headers = await getAuthHeader();
      await fetch('/.netlify/functions/save-draft', {
        method: 'POST',
        headers,
        body: JSON.stringify({ content: text })
      });
      alert("Draft saved.");
    } catch (err) {
      console.error("Save failed:", err);
    }
  }

  async function exportDoc(type) {
    try {
      const headers = await getAuthHeader();
      const res = await fetch('/.netlify/functions/export-doc', {
        method: 'POST',
        headers,
        body: JSON.stringify({
          type,
          content: document.getElementById('ai-output').innerText
        })
      });
      const blob = await res.blob();
      const link = document.createElement('a');
      link.href = URL.createObjectURL(blob);
      link.download = `AI-Response.${type}`;
      link.click();
    } catch (err) {
      console.error("Export failed:", err);
    }
  }

  // --- My Documents ---
  async function loadDocuments() {
    const container = document.getElementById("documents-container");
    const currentLang = localStorage.getItem('lang') || 'en';
    
    console.log('loadDocuments called - hostname:', window.location.hostname);
    console.log('loadDocuments called - protocol:', window.location.protocol);
    console.log('loadDocuments called - full URL:', window.location.href);

    // Show loading spinner
    container.innerHTML = '<div style="text-align: center; padding: 2rem;"><div style="display: inline-block; width: 20px; height: 20px; border: 3px solid #f3f3f3; border-top: 3px solid var(--primary); border-radius: 50%; animation: spin 1s linear infinite;"></div><p style="margin-top: 1rem;">Loading documents...</p></div>';

    try {
      // Load documents directly from GitHub JSON
      console.log('Loading documents from GitHub JSON...');
      const response = await fetch('/assets/data/github-documents-paired.json');
      
      if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`);
      }
      
      const allDocs = await response.json();
      console.log(`Loaded ${allDocs.length} total documents from GitHub JSON`);
      
      // Filter by language
      const docs = allDocs.filter(doc => doc.language === currentLang);
      console.log(`Filtered to ${docs.length} documents for language: ${currentLang}`);

      container.innerHTML = "";

      if (docs.length > 0) {
        const sortedDocs = docs.sort((a, b) => a.label.localeCompare(b.label));
        
        sortedDocs.forEach(doc => {
          const card = document.createElement("div");
          card.className = "tool-card";
          
          // Convert GitHub URLs to local paths for serving
          const templatePath = doc.template_path.replace('https://raw.githubusercontent.com/jhouston2019/claimnavigatorai/main/docs/', '');
          const samplePath = doc.sample_path ? doc.sample_path.replace('https://raw.githubusercontent.com/jhouston2019/claimnavigatorai/main/docs/', '') : null;
          
          console.log('Original template path:', doc.template_path);
          console.log('Converted template path:', templatePath);
          console.log('Original sample path:', doc.sample_path);
          console.log('Converted sample path:', samplePath);
          
          card.innerHTML = `
            <div class="tool-title">${doc.label}</div>
            <div class="tool-desc">${doc.description || 'Insurance claim document'}</div>
            <div class="action-buttons">
              <button class="btn-primary" onclick="openDocument('${templatePath}')">Template</button>
              ${samplePath ? `<button class="btn-secondary" onclick="openDocument('${samplePath}')">Sample</button>` : ''}
            </div>
          `;
          container.appendChild(card);
        });
        
        const countDiv = document.createElement("div");
        countDiv.style.cssText = "margin-top: 1rem; padding: 0.5rem; background: #f0f9ff; border: 1px solid #0ea5e9; border-radius: 0.5rem; color: #0369a1;";
        countDiv.innerHTML = `
          <strong>📄 ${docs.length} documents available in ${currentLang === 'es' ? 'Spanish' : 'English'}</strong><br>
          <small style="color: #64748b;">Served from local storage</small>
        `;
        container.appendChild(countDiv);
      } else {
        container.innerHTML = `
          <div style="background: #fef2f2; border: 1px solid #fecaca; border-radius: 8px; padding: 1rem; margin: 1rem 0;">
            <h4 style="color: #dc2626; margin: 0 0 0.5rem 0;">📄 No Documents Found</h4>
            <p style="color: #7f1d1d; margin: 0;">No documents found for ${currentLang === 'es' ? 'Spanish' : 'English'} language.</p>
          </div>
        `;
      }
    } catch (err) {
      console.error("Error loading documents:", err);
      
      container.innerHTML = `
        <div style="background: #fef2f2; border: 1px solid #fecaca; border-radius: 8px; padding: 1rem; margin: 1rem 0;">
          <h4 style="color: #dc2626; margin: 0 0 0.5rem 0;">⚠️ Error Loading Documents</h4>
          <p style="color: #7f1d1d; margin: 0 0 0.5rem 0;">${err.message}</p>
          <p style="color: #7f1d1d; margin: 0;">Please check your connection and try again.</p>
        </div>
        <div style="background: #f0f9ff; border: 1px solid #0ea5e9; border-radius: 8px; padding: 1rem; margin: 1rem 0;">
          <h4 style="color: #0369a1; margin: 0 0 0.5rem 0;">📄 Documents Available</h4>
          <p style="color: #0369a1; margin: 0;">The system has 124 English documents and 127 Spanish documents stored in GitHub.</p>
        </div>
      `;
    }
  }

  async function openDocument(filePath) {
    console.log('Opening protected document:', filePath);
    console.log('File path type:', typeof filePath);
    console.log('File path starts with http:', filePath.startsWith('http'));
    
    // Check if it's already a full URL
    if (filePath.startsWith('http')) {
      console.log('Full URL provided, opening directly');
      window.open(filePath, '_blank');
      return;
    }
    
    // Show loading state
    const loadingDiv = document.createElement('div');
    loadingDiv.style.cssText = 'position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: flex; justify-content: center; align-items: center; z-index: 9999;';
      loadingDiv.innerHTML = '<div style="background: white; padding: 2rem; border-radius: 8px; text-align: center;"><div style="display: inline-block; width: 20px; height: 20px; border: 3px solid #f3f3f3; border-top: 3px solid var(--primary); border-radius: 50%; animation: spin 1s linear infinite;"></div><p style="margin-top: 1rem;">Loading document...</p></div>';
    document.body.appendChild(loadingDiv);

    try {
      // Use the working simple Netlify function
      console.log('Calling serve-protected-document-simple function with path:', filePath);
      const res = await fetch(`/.netlify/functions/serve-protected-document-simple?documentPath=${encodeURIComponent(filePath)}&v=${Date.now()}`, {
        method: "GET"
      });
      
      if (res.ok) {
        // Create a blob from the response
        const blob = await res.blob();
        const url = URL.createObjectURL(blob);
        
        // Open the document
        window.open(url, '_blank');
        
        // Show success message
        const successDiv = document.createElement('div');
        successDiv.style.cssText = 'position: fixed; top: 20px; right: 20px; background: #10b981; color: white; padding: 1rem; border-radius: 8px; z-index: 10000; max-width: 300px;';
        successDiv.innerHTML = `
          <div style="font-weight: bold; margin-bottom: 0.5rem;">✅ Document Loaded</div>
          <div style="font-size: 0.9rem;">Document loaded successfully.</div>
        `;
        document.body.appendChild(successDiv);
        
        // Remove success message after 3 seconds
        setTimeout(() => {
          if (successDiv.parentNode) {
            successDiv.parentNode.removeChild(successDiv);
          }
        }, 3000);
        
        // Clean up the URL after a delay
        setTimeout(() => URL.revokeObjectURL(url), 10000);
        
        console.log('Document loaded successfully');
        return;
      } else {
        throw new Error(`HTTP error! status: ${res.status}`);
      }
      
    } catch (err) {
      console.error("Error opening protected document:", err);
      alert(`Failed to open protected document: ${err.message}\n\nDocument: ${filePath}\n\nPlease ensure you are logged in and try again.`);
    } finally {
      // Remove loading overlay
      const loadingDiv = document.querySelector('div[style*="position: fixed"]');
      if (loadingDiv) {
        loadingDiv.remove();
      }
    }
  }

  async function uploadDocument() {
    const file = document.getElementById('doc-upload').files[0];
    if (!file) return;
    
    const isDevelopment = false; // Force production mode for live site
    
    if (isDevelopment) {
      alert(`Development Mode: Would upload file "${file.name}"\n\nIn production, this would upload and classify the document.`);
      return;
    }
    
    try {
      if (!supabase) {
        throw new Error("Supabase not initialized");
      }
      
      const { data: { session } } = await supabase.auth.getSession();
      if (!session) throw new Error("Not logged in");

      const formData = new FormData();
      formData.append("file", file);

      await fetch('/.netlify/functions/classify-upload', {
        method: 'POST',
        headers: { Authorization: `Bearer ${session.access_token}` },
        body: formData
      });
      alert("Document uploaded & classified");
      loadDocuments();
    } catch (err) {
      console.error("Upload failed:", err);
      alert("Upload failed: " + err.message);
    }
  }

  function setLang(newLang) {
    localStorage.setItem("lang", newLang);
    
    // Update button styling
    const enBtn = document.getElementById('lang-en');
    const esBtn = document.getElementById('lang-es');
    
    if (enBtn && esBtn) {
      if (newLang === 'en') {
        enBtn.className = 'btn-primary';
        esBtn.className = 'btn-secondary';
      } else {
        enBtn.className = 'btn-secondary';
        esBtn.className = 'btn-primary';
      }
    }
    
    loadDocuments();
  }

  function filterDocuments() {
    const searchTerm = document.getElementById('doc-search').value.toLowerCase();
    const cards = document.querySelectorAll('.tool-card');
    
    cards.forEach(card => {
      const title = card.querySelector('.tool-title').textContent.toLowerCase();
      const desc = card.querySelector('.tool-desc').textContent.toLowerCase();
      
      if (title.includes(searchTerm) || desc.includes(searchTerm)) {
        card.style.display = 'block';
      } else {
        card.style.display = 'none';
      }
    });
  }

  // --- Credit Log ---
  async function loadCreditLog() {
    const tbody = document.getElementById('credit-log-body');
    const isDevelopment = false; // Force production mode for live site
    
    if (isDevelopment) {
      // Mock credit log for development
      const mockLogs = [
        {
          created_at: new Date().toISOString(),
          mode: "ai-response",
          language: "en",
          tokens_used: 150
        },
        {
          created_at: new Date(Date.now() - 86400000).toISOString(),
          mode: "ai-response",
          language: "es",
          tokens_used: 200
        },
        {
          created_at: new Date(Date.now() - 172800000).toISOString(),
          mode: "document-generation",
          language: "en",
          tokens_used: 75
        }
      ];

      tbody.innerHTML = "";
      mockLogs.forEach(log => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${new Date(log.created_at).toLocaleString()}</td>
          <td>${log.mode}</td>
          <td>${log.language}</td>
          <td>${log.tokens_used}</td>
        `;
        tbody.appendChild(row);
      });
      return;
    }

    try {
      const headers = await getAuthHeader();
      const res = await fetch('/.netlify/functions/get-credit-log', {
        method: 'POST',
        headers,
        body: JSON.stringify({})
      });
      const data = await res.json();

      if (res.ok && data.success && data.logs.length > 0) {
        data.logs.forEach(log => {
          const row = document.createElement("tr");
          row.innerHTML = `
            <td>${new Date(log.created_at).toLocaleString()}</td>
            <td>${log.mode}</td>
            <td>${log.language}</td>
            <td>${log.tokens_used ?? "-"}</td>
          `;
          tbody.appendChild(row);
        });
      } else {
        tbody.innerHTML = `<tr><td colspan="4">No logs found.</td></tr>`;
      }
    } catch (err) {
      console.error("Error loading credit log:", err);
      tbody.innerHTML = `<tr><td colspan="4">Error loading log.</td></tr>`;
    }
  }

  // --- Download All Outputs ---
  async function downloadAllOutputs() {
    try {
      const headers = await getAuthHeader();
      const res = await fetch('/.netlify/functions/download-all', {
        method: 'POST',
        headers,
        body: JSON.stringify({})
      });

      if (!res.ok) {
        const errMsg = await res.text();
        throw new Error(errMsg || "Download failed");
      }

      const blob = await res.blob();
      const link = document.createElement('a');
      link.href = URL.createObjectURL(blob);
      link.download = 'outputs.zip';
      link.click();
    } catch (err) {
      console.error("Download failed:", err);
      alert("Error downloading outputs.");
    }
  }

  // --- Claim Analysis Tools ---
  async function analyzePolicy() {
    const output = document.getElementById('policy-analysis-output');
    output.style.display = 'block';
    output.innerHTML = '<div class="spinner"></div> Analyzing policy with AI...';

    const isDevelopment = false; // Force production mode for live site

    if (isDevelopment) {
      // Development mode - show mock data but also demonstrate real functionality
      setTimeout(() => {
        const analysis = `Policy Coverage Analysis Results:

✓ Coverage Type: Property Insurance
✓ Policy Limits: $500,000 dwelling, $100,000 contents
✓ Deductible: $2,500
✓ Coverage Gaps Identified:
  - Additional Living Expenses (ALE) coverage may be insufficient
  - Code upgrade coverage not clearly defined
  - Mold coverage limitations present

Recommendations:
1. Review ALE coverage limits for extended displacement
2. Clarify code upgrade coverage with adjuster
3. Document all mold-related damages immediately
4. Consider hiring public adjuster for complex claim

This is a mock analysis for development testing. In production, this would use AI to analyze your actual policy documents.`;
        output.textContent = analysis;
      }, 2000);
    } else {
      // Production mode - use real AI analysis
      try {
        const headers = await getAuthHeader();
        
        // Get policy data from user input or uploaded documents
        const policyData = document.getElementById('policy-input')?.value || 
          "Please upload your policy documents or paste policy information for AI analysis.";
        
        const response = await fetch('/.netlify/functions/analyze-claim', {
          method: 'POST',
          headers,
          body: JSON.stringify({
            analysisType: 'policy_review',
            inputData: policyData
          })
        });

        const result = await response.json();
        
        if (response.ok && result.success) {
          output.textContent = result.analysis;
          // Refresh credits display after successful AI usage
          await loadUserCredits();
        } else {
          output.textContent = `Error: ${result.error || 'Analysis failed'}`;
        }
      } catch (error) {
        console.error('Policy analysis error:', error);
        output.textContent = 'Error: Failed to analyze policy. Please try again.';
      }
    }
  }

  async function assessDamage() {
    const output = document.getElementById('damage-assessment-output');
    output.style.display = 'block';
    output.innerHTML = '<div class="spinner"></div> Calculating damage assessment with AI...';

    const isDevelopment = false; // Force production mode for live site

    if (isDevelopment) {
      setTimeout(() => {
        const assessment = `Damage Assessment Summary:

Property Damage Breakdown:
- Roof Damage: $15,000 (replacement required)
- Interior Water Damage: $8,500 (drywall, flooring)
- HVAC System: $3,200 (water damage)
- Personal Property: $12,000 (furniture, electronics)

Total Estimated Damage: $38,700
Less Depreciation (10%): $3,870
Net Claim Value: $34,830

Documentation Required:
✓ Photos of all damaged areas
✓ Contractor estimates (minimum 2)
✓ Proof of ownership for personal property
✓ Receipts for emergency repairs

This is a mock assessment for development testing. In production, this would use AI to analyze your damage photos and estimates.`;
        output.textContent = assessment;
      }, 2000);
    } else {
      try {
        const headers = await getAuthHeader();
        
        const damageData = document.getElementById('damage-input')?.value || 
          "Please provide damage information, photos, or estimates for AI analysis.";
        
        const response = await fetch('/.netlify/functions/analyze-claim', {
          method: 'POST',
          headers,
          body: JSON.stringify({
            analysisType: 'damage_assessment',
            inputData: damageData
          })
        });

        const result = await response.json();
        
        if (response.ok && result.success) {
          output.textContent = result.analysis;
        } else {
          output.textContent = `Error: ${result.error || 'Assessment failed'}`;
        }
      } catch (error) {
        console.error('Damage assessment error:', error);
        output.textContent = 'Error: Failed to assess damage. Please try again.';
      }
    }
  }

  async function reviewEstimate() {
    const output = document.getElementById('estimate-review-output');
    output.style.display = 'block';
    output.innerHTML = '<div class="spinner"></div> Reviewing estimates with AI...';

    const isDevelopment = false; // Force production mode for live site

    if (isDevelopment) {
      setTimeout(() => {
        const review = `Estimate Comparison Analysis:

Contractor Estimate: $38,700
Insurer Estimate: $28,500
Discrepancy: $10,200 (26% difference)

Key Discrepancies Identified:
1. Roof Replacement: Contractor $15,000 vs Insurer $12,000
   - Missing: Underlayment, flashing, permits
2. Interior Repairs: Contractor $8,500 vs Insurer $6,200
   - Missing: Paint, trim, baseboards
3. HVAC: Contractor $3,200 vs Insurer $2,100
   - Missing: Ductwork cleaning, filter replacement

Recommended Actions:
1. Request detailed line-item breakdown from insurer
2. Submit contractor estimates with supporting documentation
3. Schedule re-inspection with both parties present
4. Consider independent appraisal if dispute continues

This is a mock review for development testing. In production, this would use AI to compare your actual estimates.`;
        output.textContent = review;
      }, 2000);
    } else {
      try {
        const headers = await getAuthHeader();
        
        const estimateData = document.getElementById('estimate-input')?.value || 
          "Please provide contractor and insurer estimates for AI comparison.";
        
        const response = await fetch('/.netlify/functions/analyze-claim', {
          method: 'POST',
          headers,
          body: JSON.stringify({
            analysisType: 'estimate_review',
            inputData: estimateData
          })
        });

        const result = await response.json();
        
        if (response.ok && result.success) {
          output.textContent = result.analysis;
        } else {
          output.textContent = `Error: ${result.error || 'Estimate review failed'}`;
        }
      } catch (error) {
        console.error('Estimate review error:', error);
        output.textContent = 'Error: Failed to review estimates. Please try again.';
      }
    }
  }

  async function calculateBI() {
    const output = document.getElementById('bi-calculator-output');
    output.style.display = 'block';
    output.innerHTML = '<div class="spinner"></div> Calculating business interruption with AI...';

    const isDevelopment = false; // Force production mode for live site

    if (isDevelopment) {
      setTimeout(() => {
        const biCalc = `Business Interruption Loss Calculation:

Lost Revenue Analysis:
- Pre-loss monthly revenue: $25,000
- Projected downtime: 3 months
- Total lost revenue: $75,000

Extra Expenses:
- Temporary location rent: $3,000/month × 3 = $9,000
- Equipment rental: $1,500/month × 3 = $4,500
- Additional utilities: $500/month × 3 = $1,500
- Marketing to retain customers: $2,000

Total Extra Expenses: $17,000

Total BI Claim: $92,000

Documentation Required:
✓ Profit & Loss statements (12 months prior)
✓ Tax returns (2 years)
✓ Bank statements
✓ Customer contracts
✓ Vendor invoices

This is a mock calculation for development testing. In production, this would use AI to analyze your business financials.`;
        output.textContent = biCalc;
      }, 2000);
    } else {
      try {
        const headers = await getAuthHeader();
        
        const biData = document.getElementById('bi-input')?.value || 
          "Please provide business financial information for BI calculation.";
        
        const response = await fetch('/.netlify/functions/analyze-claim', {
          method: 'POST',
          headers,
          body: JSON.stringify({
            analysisType: 'business_interruption',
            inputData: biData
          })
        });

        const result = await response.json();
        
        if (response.ok && result.success) {
          output.textContent = result.analysis;
        } else {
          output.textContent = `Error: ${result.error || 'BI calculation failed'}`;
        }
      } catch (error) {
        console.error('BI calculation error:', error);
        output.textContent = 'Error: Failed to calculate BI losses. Please try again.';
      }
    }
  }

  async function requestExpertOpinion() {
    const output = document.getElementById('expert-opinion-output');
    output.style.display = 'block';
    output.innerHTML = '<div class="spinner"></div> Generating expert opinion request with AI...';

    const isDevelopment = false; // Force production mode for live site

    if (isDevelopment) {
      setTimeout(() => {
        const expertRequest = `Expert Opinion Request Letter:

[Date]

[Expert Name]
[Expert Company]
[Address]

Re: Property Damage Assessment - Claim #[CLAIM_NUMBER]

Dear [Expert Name],

We are requesting your professional opinion regarding property damage sustained at [Property Address] on [Date of Loss].

Scope of Work Requested:
1. Structural damage assessment
2. Cause and origin analysis
3. Repair methodology and cost estimation
4. Timeline for completion
5. Code compliance requirements

Documents Provided:
- Insurance adjuster's estimate
- Contractor estimates
- Photographic documentation
- Engineering reports (if available)

Please provide your written opinion within 14 days of inspection.

Sincerely,
[Your Name]

This is a mock request for development testing. In production, this would use AI to generate customized expert opinion requests.`;
        output.textContent = expertRequest;
      }, 2000);
    } else {
      try {
        const headers = await getAuthHeader();
        
        const expertData = document.getElementById('expert-input')?.value || 
          "Please provide claim details for expert opinion request generation.";
        
        const response = await fetch('/.netlify/functions/analyze-claim', {
          method: 'POST',
          headers,
          body: JSON.stringify({
            analysisType: 'expert_opinion',
            inputData: expertData
          })
        });

        const result = await response.json();
        
        if (response.ok && result.success) {
          output.textContent = result.analysis;
        } else {
          output.textContent = `Error: ${result.error || 'Expert opinion generation failed'}`;
        }
      } catch (error) {
        console.error('Expert opinion error:', error);
        output.textContent = 'Error: Failed to generate expert opinion request. Please try again.';
      }
    }
  }

  async function analyzeSettlement() {
    const output = document.getElementById('settlement-analysis-output');
    output.style.display = 'block';
    output.innerHTML = '<div class="spinner"></div> Analyzing settlement offer with AI...';

    const isDevelopment = false; // Force production mode for live site

    if (isDevelopment) {
      setTimeout(() => {
        const settlementAnalysis = `Settlement Analysis & Negotiation Strategy:

Current Settlement Offer: $28,500
Your Claim Value: $38,700
Shortfall: $10,200 (26% underpayment)

Negotiation Strategy:
1. Document all discrepancies with supporting evidence
2. Request detailed explanation for each line item reduction
3. Submit independent contractor estimates
4. Highlight code upgrade requirements
5. Emphasize policy language supporting full replacement cost

Key Arguments:
- Policy provides replacement cost coverage
- Contractor estimates are from licensed professionals
- Code upgrades are required by local ordinances
- Depreciation should not apply to structural elements

Next Steps:
1. Send formal demand letter within 30 days
2. Request appraisal if negotiations fail
3. Consider public adjuster if claim exceeds $50,000
4. Document all communications

This is a mock analysis for development testing. In production, this would use AI to analyze your actual settlement offer.`;
        output.textContent = settlementAnalysis;
      }, 2000);
    } else {
      try {
        const headers = await getAuthHeader();
        
        const settlementData = document.getElementById('settlement-input')?.value || 
          "Please provide settlement offer details for AI analysis.";
        
        const response = await fetch('/.netlify/functions/analyze-claim', {
          method: 'POST',
          headers,
          body: JSON.stringify({
            analysisType: 'settlement_analysis',
            inputData: settlementData
          })
        });

        const result = await response.json();
        
        if (response.ok && result.success) {
          output.textContent = result.analysis;
        } else {
          output.textContent = `Error: ${result.error || 'Settlement analysis failed'}`;
        }
      } catch (error) {
        console.error('Settlement analysis error:', error);
        output.textContent = 'Error: Failed to analyze settlement. Please try again.';
      }
    }
  }

  // Download functions for analysis tools
  function downloadPolicyChecklist() {
    window.open('/public/documents/claim-analysis/policy-review-coverage-analysis.pdf', '_blank');
  }

  function downloadDamageForm() {
    window.open('/public/documents/claim-analysis/damage-assessment-calculator.pdf', '_blank');
  }

  function downloadComparison() {
    window.open('/public/documents/claim-analysis/estimate-review-comparison.pdf', '_blank');
  }

  function downloadBICalc() {
    window.open('/public/documents/claim-analysis/business-interruption-calculator.pdf', '_blank');
  }

  function downloadExpertForm() {
    window.open('/public/documents/claim-analysis/expert-opinion-request-generator.pdf', '_blank');
  }

  function downloadNegotiation() {
    window.open('/public/documents/claim-analysis/settlement-analysis-negotiation.pdf', '_blank');
  }

  // Credits management functions
  async function loadUserCredits() {
    try {
      if (!supabase) {
        console.log('Supabase not initialized, skipping credits load');
        return;
      }

      const { data: { user } } = await supabase.auth.getUser();
      if (!user) {
        document.getElementById('user-credits-display').textContent = 'Credits: Not logged in';
        return;
      }

      const response = await fetch('/.netlify/functions/verify-entitlement', {
        method: 'POST',
        headers: { 
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${(await supabase.auth.getSession()).data.session?.access_token}`
        },
        body: JSON.stringify({ email: user.email })
      });

      const data = await response.json();

      if (response.ok && data.credits !== undefined) {
        document.getElementById('user-credits-display').textContent = `Credits: ${data.credits}`;
      } else {
        document.getElementById('user-credits-display').textContent = 'Credits: 0';
      }
    } catch (err) {
      console.error('Error loading credits:', err);
      document.getElementById('user-credits-display').textContent = 'Credits: Error';
    }
  }

  async function buyMoreCredits() {
    try {
      if (!supabase) {
        alert('Please log in first to purchase credits.');
        window.location.href = 'login.html';
        return;
      }

      const { data: { user } } = await supabase.auth.getUser();
      if (!user) {
        alert('Please log in first to purchase credits.');
        window.location.href = 'login.html';
        return;
      }

      console.log('User authenticated, redirecting to product page for credit purchase');
      // Redirect to product page for credit purchase
      window.location.href = '../product.html';
    } catch (err) {
      console.error('Error starting credit purchase:', err);
      alert('Error starting purchase. Please try again.');
    }
  }

  // --- Auth Guard + Init ---
  document.addEventListener('DOMContentLoaded', async () => {
    // Development mode bypass - remove in production
    const isDevelopment = false; // Force production mode for live site
    
    if (!isDevelopment) {
    const { data: { user } } = await supabase.auth.getUser();
    if (!user) {
      alert("You must log in first.");
      window.location.href = "login.html";
      return;
      }
    } else {
      console.log("Development mode: Authentication bypassed");
    }

    // Initialize accordion functionality
    document.querySelectorAll('.accordion-header').forEach(btn => {
      btn.addEventListener('click', () => {
        btn.parentElement.classList.toggle('active');
      });
    });

    // Load initial data
    try {
      await loadDocuments();
      await loadCreditLog();
      await loadUserCredits();
      // Debug timeline guide loading
      setTimeout(debugTimelineGuide, 1000);
    } catch (error) {
      console.log("Some functions may not be available in development mode:", error);
    }
  });
</script>

</body>
</html>
