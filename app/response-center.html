<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Response Center - ClaimNavigatorAI</title>
  <meta name="description" content="AI-powered claim response center with document library, AI response generation, claim analysis tools, and playbook.">
  <style>
    :root {
      --primary: #1e40af;
      --accent: #3b82f6;
      --border: #e5e7eb;
      --text-secondary: #6b7280;
      --bg-light: #f9fafb;
    }
    body { font-family: Arial, sans-serif; margin:0; padding:0; background:#fff; }
    header { background:#0f172a; padding:1rem; color:#fff; position:sticky; top:0; }
    nav { display:flex; justify-content:space-between; align-items:center; }
    .nav-links { display:flex; gap:1rem; }
    .nav-links a { color:#fff; text-decoration:none; }
    .main-content { padding:2rem; }
    .tabs { display:flex; border-bottom:2px solid var(--border); margin-bottom:1.5rem; flex-wrap:wrap; }
    .tab { padding:1rem; cursor:pointer; }
    .tab.active { border-bottom:3px solid var(--primary); font-weight:bold; }
    .tab-content { display:none; }
    .tab-content.active { display:block; }
    .btn-primary { background:var(--primary); color:#fff; border:none; border-radius:0.5rem; padding:0.5rem 1rem; cursor:pointer; text-decoration:none; display:inline-block; }
    .btn-secondary { background:var(--accent); color:#fff; border:none; border-radius:0.5rem; padding:0.5rem 1rem; cursor:pointer; text-decoration:none; display:inline-block; }
    .accordion .accordion-item { border:1px solid var(--border); border-radius:0.5rem; margin-bottom:1rem; overflow:hidden; }
    .accordion-header { width:100%; text-align:left; background:var(--bg-light); padding:0.75rem; border:none; font-weight:bold; cursor:pointer; }
    .accordion-body { display:none; padding:1rem; background:#fff; border-top:1px solid var(--border); }
    .accordion-item.active .accordion-body { display:block; }
    .accordion-body ul { list-style:none; padding:0; }
    .accordion-body li { margin-bottom:0.5rem; }
  </style>
</head>
<body>
  <header>
    <nav>
      <div class="logo">ClaimNavigatorAI</div>
      <div class="nav-links">
        <a href="../index.html">Home</a>
        <a href="../product.html">Product</a>
        <a href="response-center.html">Response Center</a>
        <a href="settings.html">Settings</a>
        <a href="#" onclick="logout()">Logout</a>
      </div>
    </nav>
  </header>

  <main class="main-content">
    <h1>Response Center</h1>
    <p>AI-powered tools to strengthen your claim and generate professional responses</p>

    <!-- Tabs -->
    <div class="tabs">
      <button class="tab active" onclick="switchTab('ai-agent')">AI Response & Analysis Agent</button>
      <button class="tab" onclick="switchTab('my-documents')">My Documents</button>
      <button class="tab" onclick="switchTab('analysis-tools')">Claim Analysis Tools</button>
      <button class="tab" onclick="switchTab('claim-playbook')">Claim Playbook</button>
      <button class="tab" onclick="switchTab('settings')">Settings</button>
    </div>

    <!-- Claim Playbook -->
    <div id="claim-playbook" class="tab-content">
      <h2>Claim Playbook</h2>
      <p>Step-by-step roadmap for managing your insurance claim. Expand each phase for checklists, decision points, and the right documents.</p>

      <div class="accordion">
        <!-- Phase 1 -->
        <div class="accordion-item">
          <button class="accordion-header">Phase 1 – Immediate Response (0–24 Hours)</button>
          <div class="accordion-body" id="phase-1">
            <ul>
              <li><input type="checkbox" data-phase="phase-1" data-task-index="0" onchange="handleTaskChange(this)"> Ensure safety: evacuate if needed, check for injuries.</li>
              <li><input type="checkbox" data-phase="phase-1" data-task-index="1" onchange="handleTaskChange(this)"> Call 911 for fire, flood, or medical emergencies.</li>
              <li><input type="checkbox" data-phase="phase-1" data-task-index="2" onchange="handleTaskChange(this)"> Shut off utilities (gas, electric, water).</li>
              <li><input type="checkbox" data-phase="phase-1" data-task-index="3" onchange="handleTaskChange(this)"> Document damage before moving anything.</li>
              <li><input type="checkbox" data-phase="phase-1" data-task-index="4" onchange="handleTaskChange(this)"> Secure property: board up, tarp, lock doors.</li>
            </ul>
            <div class="action-buttons">
              <a href="/assets/docs/core/fnol-form.docx" class="btn-primary">Download DOCX</a>
              <a href="/assets/docs/core/fnol-form.pdf" class="btn-secondary">Download PDF</a>
            </div>
          </div>
        </div>

        <!-- Phase 2 -->
        <div class="accordion-item">
          <button class="accordion-header">Phase 2 – Documentation (Day 1–7)</button>
          <div class="accordion-body" id="phase-2">
            <ul>
              <li><input type="checkbox" data-phase="phase-2" data-task-index="0" onchange="handleTaskChange(this)"> Take comprehensive photos & video walkthrough.</li>
              <li><input type="checkbox" data-phase="phase-2" data-task-index="1" onchange="handleTaskChange(this)"> Create written damage inventory (room by room).</li>
              <li><input type="checkbox" data-phase="phase-2" data-task-index="2" onchange="handleTaskChange(this)"> Save receipts for emergency expenses.</li>
              <li><input type="checkbox" data-phase="phase-2" data-task-index="3" onchange="handleTaskChange(this)"> Upload evidence into “My Documents.”</li>
            </ul>
            <div class="action-buttons">
              <a href="/assets/docs/core/proof-of-loss.docx" class="btn-primary">Download DOCX</a>
              <a href="/assets/docs/core/proof-of-loss.pdf" class="btn-secondary">Download PDF</a>
            </div>
          </div>
        </div>

        <!-- Phase 3 -->
        <div class="accordion-item">
          <button class="accordion-header">Phase 3 – Policy & Coverage Review</button>
          <div class="accordion-body" id="phase-3">
            <ul>
              <li><input type="checkbox" data-phase="phase-3" data-task-index="0" onchange="handleTaskChange(this)"> Review Declarations page (limits, deductibles, endorsements).</li>
              <li><input type="checkbox" data-phase="phase-3" data-task-index="1" onchange="handleTaskChange(this)"> Identify exclusions insurer may cite.</li>
              <li><input type="checkbox" data-phase="phase-3" data-task-index="2" onchange="handleTaskChange(this)"> Calendar critical deadlines (Proof of Loss, Appraisal, Suit Limitations).</li>
            </ul>
            <div class="action-buttons">
              <a href="/assets/docs/policy/coverage-checklist.pdf" class="btn-secondary">Download Checklist</a>
            </div>
          </div>
        </div>

        <!-- Phase 4 -->
        <div class="accordion-item">
          <button class="accordion-header">Phase 4 – Adjuster Interaction</button>
          <div class="accordion-body" id="phase-4">
            <ul>
              <li><input type="checkbox" data-phase="phase-4" data-task-index="0" onchange="handleTaskChange(this)"> Walk adjuster through ALL damage (don’t let them skip).</li>
              <li><input type="checkbox" data-phase="phase-4" data-task-index="1" onchange="handleTaskChange(this)"> Request copy of their estimate in writing.</li>
              <li><input type="checkbox" data-phase="phase-4" data-task-index="2" onchange="handleTaskChange(this)"> Record all communications with adjuster.</li>
              <li><input type="checkbox" data-phase="phase-4" data-task-index="3" onchange="handleTaskChange(this)"> Store all correspondence in Claim Navigator.</li>
            </ul>
            <div class="action-buttons">
              <a href="/assets/docs/adjuster/meeting-checklist.pdf" class="btn-secondary">Download Checklist</a>
            </div>
          </div>
        </div>

        <!-- Phase 5 -->
        <div class="accordion-item">
          <button class="accordion-header">Phase 5 – Estimates & Reserves</button>
          <div class="accordion-body" id="phase-5">
            <ul>
              <li><input type="checkbox" data-phase="phase-5" data-task-index="0" onchange="handleTaskChange(this)"> Compare insurer estimate vs contractor/public adjuster estimate.</li>
              <li><input type="checkbox" data-phase="phase-5" data-task-index="1" onchange="handleTaskChange(this)"> If underpaid → send Supplement Request Letter.</li>
              <li><input type="checkbox" data-phase="phase-5" data-task-index="2" onchange="handleTaskChange(this)"> Ask insurer: “What reserve has been set on my claim?”</li>
            </ul>
            <div class="action-buttons">
              <a href="/assets/docs/correspondence/supplement-request.docx" class="btn-primary">Download DOCX</a>
              <a href="/assets/docs/correspondence/supplement-request.pdf" class="btn-secondary">Download PDF</a>
            </div>
          </div>
        </div>

        <!-- Phase 6 -->
        <div class="accordion-item">
          <button class="accordion-header">Phase 6 – Negotiation & Escalation</button>
          <div class="accordion-body" id="phase-6">
            <ul>
              <li><input type="checkbox" data-phase="phase-6" data-task-index="0" onchange="handleTaskChange(this)"> If denied → send Denial Response Letter.</li>
              <li><input type="checkbox" data-phase="phase-6" data-task-index="1" onchange="handleTaskChange(this)"> Escalation Path: Supplement → Appraisal → DOI Complaint → Intent to Litigate → Attorney.</li>
            </ul>
            <div class="action-buttons">
              <a href="/assets/docs/correspondence/denial-response.docx" class="btn-primary">Denial DOCX</a>
              <a href="/assets/docs/correspondence/denial-response.pdf" class="btn-secondary">Denial PDF</a>
              <a href="/assets/docs/escalation/doi-complaint.docx" class="btn-primary">DOI DOCX</a>
              <a href="/assets/docs/escalation/doi-complaint.pdf" class="btn-secondary">DOI PDF</a>
              <a href="/assets/docs/escalation/intent-to-litigate.docx" class="btn-primary">Intent DOCX</a>
              <a href="/assets/docs/escalation/intent-to-litigate.pdf" class="btn-secondary">Intent PDF</a>
            </div>
          </div>
        </div>

        <!-- Phase 7 -->
        <div class="accordion-item">
          <button class="accordion-header">Phase 7 – Settlement & Payment</button>
          <div class="accordion-body" id="phase-7">
            <ul>
              <li><input type="checkbox" data-phase="phase-7" data-task-index="0" onchange="handleTaskChange(this)"> Review insurer’s settlement offer line by line.</li>
              <li><input type="checkbox" data-phase="phase-7" data-task-index="1" onchange="handleTaskChange(this)"> Don’t sign release until all supplements are resolved.</li>
              <li><input type="checkbox" data-phase="phase-7" data-task-index="2" onchange="handleTaskChange(this)"> Request advance payment if needed.</li>
              <li><input type="checkbox" data-phase="phase-7" data-task-index="3" onchange="handleTaskChange(this)"> Request depreciation release.</li>
              <li><input type="checkbox" data-phase="phase-7" data-task-index="4" onchange="handleTaskChange(this)"> Handle mortgage endorsements properly.</li>
            </ul>
            <div class="action-buttons">
              <a href="/assets/docs/financial/advance-payment.docx" class="btn-primary">Advance DOCX</a>
              <a href="/assets/docs/financial/advance-payment.pdf" class="btn-secondary">Advance PDF</a>
              <a href="/assets/docs/financial/depreciation-release.docx" class="btn-primary">Depreciation DOCX</a>
              <a href="/assets/docs/financial/depreciation-release.pdf" class="btn-secondary">Depreciation PDF</a>
              <a href="/assets/docs/financial/check-endorsement.docx" class="btn-primary">Endorsement DOCX</a>
              <a href="/assets/docs/financial/check-endorsement.pdf" class="btn-secondary">Endorsement PDF</a>
            </div>
          </div>
        </div>

        <!-- Phase 8 -->
        <div class="accordion-item">
          <button class="accordion-header">Phase 8 – Additional Living Expenses (ALE)</button>
          <div class="accordion-body" id="phase-8">
            <ul>
              <li><input type="checkbox" data-phase="phase-8" data-task-index="0" onchange="handleTaskChange(this)"> Track receipts for hotel, meals, mileage, utilities.</li>
              <li><input type="checkbox" data-phase="phase-8" data-task-index="1" onchange="handleTaskChange(this)"> Submit interim reimbursement requests.</li>
              <li><input type="checkbox" data-phase="phase-8" data-task-index="2" onchange="handleTaskChange(this)"> Submit final ALE summary.</li>
              <li><input type="checkbox" data-phase="phase-8" data-task-index="3" onchange="handleTaskChange(this)"> Request housing extension if needed.</li>
            </ul>
            <div class="action-buttons">
              <a href="/assets/docs/housing/ale-interim-request.docx" class="btn-primary">Interim DOCX</a>
              <a href="/assets/docs/housing/ale-interim-request.pdf" class="btn-secondary">Interim PDF</a>
              <a href="/assets/docs/housing/ale-final-summary.docx" class="btn-primary">Final DOCX</a>
              <a href="/assets/docs/housing/ale-final-summary.pdf" class="btn-secondary">Final PDF</a>
              <a href="/assets/docs/housing/housing-extension.docx" class="btn-primary">Extension DOCX</a>
              <a href="/assets/docs/housing/housing-extension.pdf" class="btn-secondary">Extension PDF</a>
            </div>
          </div>
        </div>

        <!-- Phase 9 -->
        <div class="accordion-item">
          <button class="accordion-header">Phase 9 – Closeout</button>
          <div class="accordion-body" id="phase-9">
            <ul>
              <li><input type="checkbox" data-phase="phase-9" data-task-index="0" onchange="handleTaskChange(this)"> Confirm all payments received, depreciation released.</li>
              <li><input type="checkbox" data-phase="phase-9" data-task-index="1" onchange="handleTaskChange(this)"> Ensure mortgage cleared.</li>
              <li><input type="checkbox" data-phase="phase-9" data-task-index="2" onchange="handleTaskChange(this)"> Archive entire claim file for tax/loan/legal purposes.</li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </main>

  <script>
    // --- Tabs ---
    function switchTab(tab) {
      document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
      document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
      document.getElementById(tab).classList.add('active');
      event.target.classList.add('active');
    }

    function logout() {
      localStorage.removeItem('userEmail');
      window.location.href = '../index.html';
    }

    // --- Playbook Progress ---
    async function savePlaybookProgress(phase, tasks) {
      try {
        await fetch("/.netlify/functions/save-playbook-progress", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            email: localStorage.getItem("userEmail"),
            phase,
            tasks
          })
        });
      } catch (err) {
        console.error("Failed to save playbook progress:", err);
      }
    }

    async function loadPlaybookProgress() {
      try {
        const res = await fetch("/.netlify/functions/get-playbook-progress", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ email: localStorage.getItem("userEmail") })
        });

        const data = await res.json();
        if (res.ok && data.success) {
          data.progress.forEach(({ phase, tasks }) => {
            Object.entries(tasks).forEach(([i, checked]) => {
              const checkbox = document.querySelector(`#${phase} input[data-task-index="${i}"]`);
              if (checkbox) checkbox.checked = checked;
            });
          });
        }
      } catch (err) {
        console.error("Failed to load playbook progress:", err);
      }
    }

    function handleTaskChange(checkbox) {
      const phase = checkbox.dataset.phase;
      const allTasks = {};
      document.querySelectorAll(`#${phase} input[type="checkbox"]`).forEach(cb => {
        allTasks[cb.dataset.taskIndex] = cb.checked;
      });
      savePlaybookProgress(phase, allTasks);
    }

    // --- Accordion ---
    document.addEventListener('DOMContentLoaded', () => {
      loadPlaybookProgress();
      document.querySelectorAll('.accordion-header').forEach(btn => {
        btn.addEventListener('click', () => {
          const item = btn.parentElement;
          item.classList.toggle('active');
        });
      });
    });
  </script>
</body>
</html>
