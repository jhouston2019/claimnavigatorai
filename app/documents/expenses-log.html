<!doctype html><html lang="en"><head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Out-of-Pocket Expense Log</title>
<link rel="stylesheet" href="/app/assets/css/style.css"/></head><body>
<header><nav class="container"><div class="logo">üìÑ Out-of-Pocket Expense Log</div><div class="nav-links"><a href="./index.html" style="color:#fff">‚Üê Documents</a></div></nav></header>
<main class="container">
  <div class="card">
    <h1 class="section-h">Out-of-Pocket Expense Log</h1>
    <div class="card">
      <div style="display:grid;gap:.5rem;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));margin-bottom:.75rem">
        <input id="name" placeholder="Policyholder Name" style="padding:.6rem;border:1px solid var(--border);border-radius:10px"/>
        <input id="policy" placeholder="Policy #" style="padding:.6rem;border:1px solid var(--border);border-radius:10px"/>
        <input id="claim" placeholder="Claim #" style="padding:.6rem;border:1px solid var(--border);border-radius:10px"/>
      </div>
      <div class="grid" style="grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:.5rem">
    <label style="display:flex;flex-direction:column;font-weight:600">Category (ALE/Travel/Meals/Rental)
      <input id="category" style="padding:.6rem;border:1px solid var(--border);border-radius:10px"/>
    </label>
<label style="display:flex;flex-direction:column;font-weight:600">Entries (CSV: date,vendor,desc,amount)
      <input id="entries" style="padding:.6rem;border:1px solid var(--border);border-radius:10px"/>
    </label>
<label style="display:flex;flex-direction:column;font-weight:600">Coverage Period
      <input id="period" style="padding:.6rem;border:1px solid var(--border);border-radius:10px"/>
    </label>
  </div>
  <label style="display:block;margin-top:.5rem;font-weight:600">Additional Details
    <textarea id="details" style="width:100%;min-height:120px;padding:12px;border:1px solid var(--border);border-radius:10px"></textarea>
  </label>
      <div style="display:flex;gap:.5rem;margin-top:.5rem;flex-wrap:wrap">
        <button class="btn btn-solid" id="draft">Draft with AI</button>
        <button class="btn" id="pdf">Export PDF</button>
        <button class="btn" id="docx">Export DOCX</button>
      </div>
      <div id="out" class="card" style="margin-top:1rem"></div>
    </div>
  </div>
</main>
<script type="module">
import { callAI, createDoc } from '../assets/js/api-client.js';
import { qs, on } from '../assets/js/ui-helpers.js';
const slug='expenses-log';
on(qs('#draft'),'click', async ()=>{
  const data = { 
    type: slug,
    fields: {
      category: qs('#category')?.value||'',entries: qs('#entries')?.value||'',period: qs('#period')?.value||''
    },
    details: qs('#details')?.value||''
  };
  qs('#out').innerHTML='<span class="spinner"></span> Drafting...';
  try{ const r=await callAI(data,{type:slug}); qs('#out').innerHTML=r.response||'(no content)'; }
  catch(e){ qs('#out').innerHTML=`<div style="color:#dc2626">Error: ${e.message}</div>`; }
});
async function exportAs(fmt){
  const html = qs('#out')?.innerHTML?.trim(); if(!html) return alert('Draft first.');
  const r = await createDoc({content:html,format:fmt,type:slug,filename:`${slug}_${Date.now()}`});
  const url = r.url||r.downloadUrl; if(url) location.href=url; else alert('Export failed');
}
on(qs('#pdf'),'click',()=>exportAs('pdf'));
on(qs('#docx'),'click',()=>exportAs('docx'));
</script>
<script type="module" type="module" src="/app/assets/js/diagnostics.js"></script>
<script type="module" src="/app/assets/js/window-bridge.js"></script>
<script type="module" src="/app/assets/js/doc-forms.js"></script>
</body></html>