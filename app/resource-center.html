<!doctype html><html lang="en"><head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Claim Navigator • Resource Center</title>
    <link rel="stylesheet" href="/app/assets/css/theme.css">
    <link rel="stylesheet" href="/app/assets/css/style.css">
    <link rel="stylesheet" href="/app/assets/css/design-system.css">
    <link rel="stylesheet" href="/app/assets/css/resource-center.css">
    <link rel="stylesheet" href="/app/assets/css/guided-tour.css">
    <script src="/app/assets/js/user-tier.js"></script>
    <script src="/app/assets/js/feature-gate.js"></script>
    <script src="/app/assets/js/demo-mode.js"></script>
    <script src="/app/assets/js/upgrade-hooks.js"></script>
    <script src="/app/assets/js/org.js"></script>
<style>
/* Pulse animation for health score */
@keyframes pulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.1); }
}
</style>
</head>
<body class="resource-center" >
<header class="header">
  <div class="bar container">
    <div class="brand"><div class="logo"></div><div>Claim Navigation AI</div></div>
    <nav class="nav">
      <a href="/app/index.html">Home</a>
      
      <!-- Claim Navigator Agent Dropdown -->
      <div class="nav-dropdown">
        <button class="nav-dropdown-toggle" onclick="toggleNavDropdown('cn-agent')">
          Claim Navigator Agent
        </button>
        <div class="nav-dropdown-content" id="cn-agent">
          <a href="/app/cn-agent.html">CN Agent Dashboard</a>
          <a href="/app/cn-agent.html#draft-email">Draft Email</a>
          <a href="/app/cn-agent.html#send-email">Send Email</a>
          <a href="/app/cn-agent.html#create-alert">Create Alert</a>
          <a href="/app/cn-agent.html#detect-deadlines">Detect Deadlines</a>
          <a href="/app/cn-agent.html#detect-payments">Detect Payments</a>
          <a href="/app/cn-agent.html#detect-invoices">Detect Invoices</a>
          <a href="/app/cn-agent.html#update-statement">Update Statement of Loss</a>
          <a href="/app/cn-agent.html#update-deadlines">Update Deadlines</a>
        </div>
      </div>
      
      <!-- How to Use Dropdown -->
      <div class="nav-dropdown">
        <button class="nav-dropdown-toggle" onclick="toggleNavDropdown('how-to-use')">
          How to Use
        </button>
        <div class="nav-dropdown-content" id="how-to-use">
          <div class="how-to-steps">
            <div class="step">
              <div class="step-number">1</div>
              <div class="step-content">
                <h4>Describe Your Situation</h4>
                <p>Use the search bar or Situational Advisory to get started.</p>
              </div>
            </div>
            <div class="step">
              <div class="step-number">2</div>
              <div class="step-content">
                <h4>Generate Documents</h4>
                <p>Create letters, forms, and evidence with AI assistance.</p>
              </div>
            </div>
            <div class="step">
              <div class="step-number">3</div>
              <div class="step-content">
                <h4>Analyze & Compare</h4>
                <p>Review policies, compare estimates, and assess damage.</p>
              </div>
            </div>
            <div class="step">
              <div class="step-number">4</div>
              <div class="step-content">
                <h4>Track Progress</h4>
                <p>Use Trackers & Timeline to monitor your claim journey.</p>
              </div>
            </div>
          </div>
          <a href="/app/how-to-use.html" class="nav-link">View Detailed Guide</a>
        </div>
      </div>

      <!-- Quick Start Dropdown -->
      <div class="nav-dropdown">
        <button class="nav-dropdown-toggle" onclick="toggleNavDropdown('quick-start')">
          Quick Start
        </button>
        <div class="nav-dropdown-content" id="quick-start">
          <div class="quick-start-scenarios">
            <div class="scenario">
              <h4>My claim was just denied</h4>
              <div class="scenario-links">
                <a href="/app/ai-response-agent.html" class="scenario-link">AI Response</a>
                <a href="/app/negotiation-tools.html" class="scenario-link">Negotiation</a>
                <a href="/app/document-generator-v2/document-generator.html" class="scenario-link">Appeal</a>
              </div>
            </div>
            <div class="scenario">
              <h4>I got a lowball offer</h4>
              <div class="scenario-links">
                <a href="/app/claim-analysis.html" class="scenario-link">Damage</a>
                <a href="/app/claim-analysis.html" class="scenario-link">Policy</a>
                <a href="/app/negotiation-tools.html" class="scenario-link">Counter</a>
              </div>
            </div>
            <div class="scenario">
              <h4>Filing for the first time</h4>
              <div class="scenario-links">
                <a href="/app/claim-playbook.html" class="scenario-link">Playbook</a>
                <a href="/app/resource-center/claim-timeline.html" class="scenario-link">Timeline</a>
                <a href="/app/document-generator-v2/document-generator.html" class="scenario-link">Notice</a>
              </div>
            </div>
            <div class="scenario">
              <h4>Stuck - No Response</h4>
              <div class="scenario-links">
                <a href="/app/state-rights.html" class="scenario-link">Rights</a>
                <a href="/app/document-generator-v2/document-generator.html" class="scenario-link">Complaint</a>
                <a href="/app/trackers.html" class="scenario-link">Track</a>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Strategy & Guidance Dropdown -->
      <div class="nav-dropdown">
        <button class="nav-dropdown-toggle" onclick="toggleNavDropdown('strategy')">
          Strategy & Guidance
        </button>
        <div class="nav-dropdown-content" id="strategy">
          <a href="/app/claim-playbook.html">Claim Playbook</a>
          <a href="/app/resource-center/claim-timeline.html">Claim Timeline & Sequence Guide</a>
          <a href="/app/resource-center/insurance-company-tactics.html">Insurance Company Tactics</a>
          <a href="/app/maximize-claim.html">Maximize Your Claim</a>
          <a href="/app/state-rights.html">State Rights & Deadlines</a>
        </div>
      </div>

      <!-- Core Claim Tools Dropdown -->
      <div class="nav-dropdown">
        <button class="nav-dropdown-toggle" onclick="toggleNavDropdown('core-tools')">
          Core Claim Tools
        </button>
        <div class="nav-dropdown-content" id="core-tools">
          <a href="/app/resource-center/fnol-wizard.html">FNOL Auto-File Wizard</a>
          <a href="/app/document-library/">Claim Document Library</a>
          <a href="/app/resource-center/ai-response-agent.html">AI Response Agent</a>
          <a href="/app/cn-agent.html">ClaimNavigator Agent (AI Copilot)</a>
          <a href="/app/statement-of-loss.html">Statement of Loss</a>
          <a href="/app/deadlines.html">Deadlines</a>
          <a href="/app/resource-center/compliance-engine.html">Compliance Engine</a>
          <a href="/app/resource-center/checklist-engine.html">Checklist Engine</a>
          <a href="/app/api-docs.html">API Layer</a>
          <a href="/app/claim-journal.html">Claim Journal</a>
          <a href="/app/authority-hub.html">Authority Guides</a>
          <a href="/app/rom-tool.html">ROM Estimator</a>
          <a href="/app/claim-stage-tracker.html">Claim Stage Tracker</a>
          <a href="/app/knowledge-center.html">Knowledge Center</a>
          <a href="/app/claim-analysis.html">Claim Analysis Tools</a>
          <a href="/app/resource-center/advanced-tools/advanced-tools.html">Advanced Tools Suite</a>
          <a href="/app/situational-advisory.html">Situational Advisory</a>
          <a href="/app/negotiation-tools.html">Negotiation Scripts & Escalation</a>
          <a href="/app/documentation-guides.html">Claim Documentation Guides</a>
          <a href="/app/evidence-organizer.html">Evidence Organizer</a>
          <a href="/app/recommended-resources.html">Recommended Resources</a>
          <a href="/app/insurer-directory.html">Insurer Directory</a>
          <a href="/app/document-generator-v2/document-generator.html">Document Generator</a>
        </div>
      </div>

      <!-- Document Generator Dropdown -->
      <div class="nav-dropdown">
        <button class="nav-dropdown-toggle" onclick="toggleNavDropdown('documents')">
          Document Generator
        </button>
        <div class="nav-dropdown-content" id="documents">
          <a href="/app/document-generator-v2/document-generator.html">All Documents (61+)</a>
          <a href="/app/document-generator-v2/forms/form-template.html?id=proof-of-loss">Proof of Loss</a>
          <a href="/app/document-generator-v2/forms/form-template.html?id=demand-letter">Demand Letter</a>
          <a href="/app/document-generator-v2/forms/form-template.html?id=appeal-letter">Appeal Letter</a>
          <a href="/app/document-generator-v2/forms/form-template.html?id=damage-assessment">Damage Assessment</a>
          <a href="/app/document-generator-v2/forms/form-template.html?id=business-interruption-claim">Business Interruption</a>
          <a href="/app/document-generator-v2/forms/form-template.html?id=evidence-log">Evidence Log</a>
          <a href="/app/document-generator-v2/forms/form-template.html?id=expense-reimbursement">Expense Reimbursement</a>
          <a href="/app/document-generator-v2/forms/form-template.html?id=appraisal-request">Appraisal Request</a>
          <a href="/app/document-generator-v2/forms/form-template.html?id=regulatory-complaint">Regulatory Complaint</a>
          <a href="/app/document-generator-v2/forms/form-template.html?id=settlement-offer">Settlement Offer</a>
          <a href="/app/document-generator-v2/forms/form-template.html?id=notice-of-claim">Notice of Claim</a>
          <a href="/app/document-generator-v2/forms/form-template.html?id=coverage-clarification">Coverage Clarification</a>
          <a href="/app/document-generator-v2/forms/form-template.html?id=delay-complaint">Delay Complaint</a>
          <a href="/app/document-generator-v2/forms/form-template.html?id=photograph-log">Photograph Log</a>
          <a href="/app/document-generator-v2/forms/form-template.html?id=repair-replace-analysis">Repair vs Replace Analysis</a>
          <a href="/app/document-generator-v2/forms/form-template.html?id=out-of-pocket-log">Out-of-Pocket Expenses</a>
          <a href="/app/document-generator-v2/forms/form-template.html?id=rom-estimate">ROM Estimate</a>
          <a href="/app/document-generator-v2/forms/form-template.html?id=comparative-estimates">Comparative Estimates</a>
          <a href="/app/document-generator-v2/forms/form-template.html?id=document-index">Document Index</a>
        </div>
      </div>

      <!-- Claim Analysis Tools Dropdown -->
      <div class="nav-dropdown">
        <button class="nav-dropdown-toggle" onclick="toggleNavDropdown('analysis')">
          Claim Analysis Tools
        </button>
        <div class="nav-dropdown-content" id="analysis">
          <a href="/app/claim-analysis.html">Policy Review & Coverage Analysis</a>
          <a href="/app/claim-analysis.html">Damage Assessment Calculator</a>
          <a href="/app/maximize-claim.html">Financial Impact Calculator</a>
          <a href="/app/claim-analysis.html">Estimate Review & Comparison</a>
          <a href="/app/claim-analysis.html">Business Interruption Calculator</a>
          <a href="/app/negotiation-tools.html">Settlement Analysis & Negotiation</a>
          <a href="/app/resource-center/advanced-tools/advanced-tools.html">Advanced Tools Suite</a>
        </div>
      </div>
      <!-- Global Roadmap Context Chip -->
      <div class="nav-roadmap-chip">
        <a id="nav-roadmap-chip-link" href="/app/resource-center/claim-roadmap.html">Roadmap: Stage 1</a>
      </div>
      <!-- Developer / API Links -->
      <div class="nav-dropdown">
        <button class="nav-dropdown-toggle" onclick="toggleNavDropdown('developer')">
          Developer
        </button>
        <div class="nav-dropdown-content" id="developer">
          <a href="/app/developer.html">Developer Portal</a>
          <a href="/app/api-marketplace.html">API Marketplace</a>
          <a href="/app/api-pricing.html">API Pricing</a>
          <a href="/app/api-sandbox.html">API Sandbox</a>
          <a href="/app/api-usage.html">Usage & Billing</a>
        </div>
      </div>
      <!-- Tier Badge -->
      <li class="nav-tier-badge">
        <span id="nav-tier-label">Free</span>
      </li>
    </nav>
  </div>
</header>

<main class="container" id="main">
  <!-- Main Content Area -->
  <div class="main-content no-card">
      <!-- Centered Tagline -->
      <div class="hero-section">
        <h1 class="main-title">Your AI-Powered Resource Center</h1>
        <p class="hero-subtitle">Overwhelmed? Start with the step-by-step Claim Roadmap instead of browsing tools.</p>
        <div class="hero-roadmap-cta">
          <a href="/app/resource-center/claim-roadmap.html" id="roadmap-entry" class="btn btn-primary">Open Claim Roadmap</a>
        </div>
        <div class="hero-roadmap-cta-secondary" id="return-last-stage" style="display:none;">
          <a class="btn btn-secondary" id="return-last-stage-btn">Return to Where You Left Off</a>
        </div>
        
        <!-- Search Bar -->
        <div class="search-container">
          <input id="smart-search" placeholder="Search tools or describe your situation..." class="main-search"/>
          <button class="btn btn-primary search-btn" id="search-go">Search</button>
        </div>
      </div>
      
      <!-- Context Pill -->
      <div class="context-pill">
        <span class="context-label">Mode:</span>
        <span class="context-value">Resource Library</span>
        <a href="/app/resource-center/claim-roadmap.html" class="context-link">Switch to Guided Roadmap</a>
        <a href="/app/onboarding/index.html" class="context-link" style="margin-left: 12px;">Edit Claim Setup</a>
      </div>
      
      <!-- Main Content Wrapper for Compliance Banner -->
      <div id="main-content-wrapper">
      
      <!-- Claim Health Score Box -->
      <div id="claim-health-box" class="glasscard">
        <h3>Claim Health Score</h3>
        <div id="claim-health-score"></div>
        <ul id="claim-health-flags"></ul>
        <p id="claim-health-state-note" style="display: none;"></p>
      </div>
      
      <!-- Data Management Panel -->
      <div class="glasscard" style="max-width: 600px; margin-left: auto; margin-right: auto;">
        <h4 style="margin-top: 0; margin-bottom: 12px; font-size: 14px; font-weight: 500; color: #374151;">Data Management</h4>
        <div style="display: flex; flex-wrap: wrap; gap: 8px; justify-content: center;">
          <button onclick="window.CNStorage && window.CNStorage.exportAsJson()" style="background: #eef2f7; color: #374151; border: 1px solid #e5e7eb; padding: 6px 12px; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 500; transition: all 0.12s ease;">
            Export Claim Data
          </button>
          <button onclick="document.getElementById('cn-import-input').click()" style="background: #eef2f7; color: #374151; border: 1px solid #e5e7eb; padding: 6px 12px; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 500; transition: all 0.12s ease;">
            Import Claim Data
          </button>
          <button onclick="handleCreateSnapshot()" style="background: #eef2f7; color: #374151; border: 1px solid #e5e7eb; padding: 6px 12px; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 500; transition: all 0.12s ease;">
            Create Snapshot
          </button>
          <button onclick="handleShowSnapshots()" style="background: #eef2f7; color: #374151; border: 1px solid #e5e7eb; padding: 6px 12px; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 500; transition: all 0.12s ease;">
            Restore Snapshot
          </button>
          <button onclick="window.CNReset && window.CNReset.show()" style="background: #fee2e2; color: #991b1b; border: 1px solid #fecaca; padding: 6px 12px; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 500; transition: all 0.12s ease;">
            Clear My Claim
          </button>
        </div>
        <input type="file" id="cn-import-input" accept=".json" style="display: none;" onchange="handleImportFile(event)">
      </div>
      
      <!-- Claim Portfolio Entry Point -->
      <div id="claim-portfolio-entry" class="glasscard" style="max-width: 600px; margin-left: auto; margin-right: auto;">
        <h3>Claim Summary Packet</h3>
        <p style="margin-bottom: 15px;">
          Generate a full insurer-ready PDF packet containing your claim information,
          damage summary, evidence overview, documents generated, and your Claim Health Score.
        </p>
        <button class="btn-primary" 
                onclick="location.href='/app/claim-portfolio/index.html'">
          Generate Claim Portfolio PDF
        </button>
      </div>

      <!-- Resource Center Sections -->
      <div class="content-columns" id="resource-center-grid">
      <!-- SECTION 1: Start Here -->
      <div class="content-column">
        <h3 class="column-title">Start Here</h3>
        <!-- Row 1: Centered How to Use this Site card -->
        <div class="tool-grid tool-grid-centered" style="margin-bottom: 12px;">
          <a class="tool-card" href="/app/how-to-use.html">
            <span class="badge">Guide</span>
            <h4>How to Use this Site</h4>
            <p>Step-by-step guide: Describe situation → Generate documents → Analyze & compare → Track progress</p>
          </a>
        </div>
        <!-- Row 2: Four cards on one line -->
        <div class="tool-grid">
          <a class="tool-card" href="/app/resource-center/fnol-wizard.html">
            <span class="badge">Start Here</span>
            <h4>FNOL Auto-File Wizard</h4>
            <p>Start Your Claim → Complete FNOL in 5 steps → Auto-file to carrier → Integrated with all tools</p>
          </a>
          <a class="tool-card" href="/app/quick-start.html">
            <span class="badge">Quick Start</span>
            <h4>Quick Start Guide</h4>
            <p>Claim Denied/Lowball Offer/First-Time Filing/No Response</p>
          </a>
          <a class="tool-card" href="/app/resource-center/claim-timeline.html">
            <span class="badge">Guide</span>
            <h4>Claim Timeline & Sequence Guide</h4>
            <p>Follow the proper sequence for maximum impact</p>
          </a>
          <a class="tool-card" href="/app/claim-playbook.html">
            <span class="badge">Strategy</span>
            <h4>Claim Playbook: How to Manage Your Claim</h4>
            <p>Step-by-step strategic approach to winning your claim</p>
          </a>
        </div>
      </div>

      <!-- SECTION 2: Strategy & Knowledge -->
      <div class="content-column">
        <h3 class="column-title">Strategy & Knowledge</h3>
        <div class="tool-grid tool-grid-centered">
          <a class="tool-card" href="/app/resource-center/insurance-company-tactics.html">
            <span class="badge">Awareness</span>
            <h4>Insurance Company Tactics</h4>
            <p>Recognize and counter common insurance tactics</p>
          </a>
          <a class="tool-card" href="/app/maximize-claim.html">
            <span class="badge">Maximize</span>
            <h4>Maximize Your Claim</h4>
            <p>Strategies to get the full value you deserve</p>
          </a>
          <a class="tool-card" href="/app/state-rights.html">
            <span class="badge">Rights</span>
            <h4>State Rights & Deadlines</h4>
            <p>Know your rights and critical deadlines</p>
          </a>
        </div>
      </div>

      <!-- SECTION 3: Core Claim Tools -->
      <div class="content-column">
        <h3 class="column-title">Core Claim Tools</h3>
        <div class="tool-grid">
          <a class="tool-card" href="/app/document-generator-v2/document-generator.html" id="document-generator-entry">
            <span class="badge">AI</span>
            <h4>Document Generator</h4>
            <p>Generate 61+ professional insurance claim documents with AI assistance</p>
          </a>
          <a class="tool-card" href="/app/resource-center/ai-response-agent.html" id="ai-response-agent-entry">
            <span class="badge">AI</span>
            <h4>AI Response Agent</h4>
            <p>Get AI-powered responses to insurer communications</p>
          </a>
          <a class="tool-card" href="/app/resource-center/checklist-engine.html">
            <span class="badge">Organize</span>
            <h4>Checklist Engine</h4>
            <p>Auto-generated tasks based on your claim, deadlines, and evidence. Stay ahead of deadlines and documentation.</p>
          </a>
          <a class="tool-card" href="/app/claim-analysis.html">
            <span class="badge">AI</span>
            <h4>Claim Analysis Tools</h4>
            <p>Policy review, damage assessment, and settlement analysis</p>
          </a>
          <a class="tool-card" href="/app/situational-advisory.html">
            <span class="badge">AI</span>
            <h4>Situational Advisory</h4>
            <p>Get personalized guidance for your specific situation</p>
          </a>
          <a class="tool-card" href="/app/rom-tool.html">
            <span class="badge">Estimator</span>
            <h4>ROM Estimator</h4>
            <p>Calculate repair/replacement cost estimates with AI-powered explanations</p>
          </a>
          <a class="tool-card" href="/app/resource-center/contractor-estimate-interpreter.html">
            <span class="badge">AI</span>
            <h4>Contractor Estimate Interpreter</h4>
            <p>Break down contractor estimates, uncover missing scope, and compare against expected ranges</p>
          </a>
          <a class="tool-card" href="/app/statement-of-loss.html">
            <span class="badge">Financial</span>
            <h4>Statement of Loss</h4>
            <p>Financial ledger and PDF generator for claim transactions</p>
          </a>
          <a class="tool-card" href="/app/deadlines.html">
            <span class="badge">Critical</span>
            <h4>Deadlines</h4>
            <p>Track and manage critical claim deadlines with AI detection</p>
          </a>
          <a class="tool-card" href="/app/claim-stage-tracker.html">
            <span class="badge">Tracker</span>
            <h4>Claim Stage Tracker</h4>
            <p>Track your claim progress through all stages with visual timeline</p>
          </a>
          <a class="tool-card" href="/app/claim-journal.html">
            <span class="badge">Journal</span>
            <h4>Claim Journal</h4>
            <p>Track claim events, calls, submissions, and progress timeline</p>
          </a>
          <a class="tool-card" href="/app/evidence-organizer.html" id="evidence-organizer-entry">
            <span class="badge">AI</span>
            <h4>Evidence Organizer</h4>
            <p>AI-powered evidence categorization and management</p>
          </a>
        </div>
      </div>

      <!-- SECTION 4: Directories & Resources -->
      <div class="content-column">
        <h3 class="column-title">Directories & Resources</h3>
        <div class="tool-grid">
          <a class="tool-card" href="/app/insurer-directory.html">
            <span class="badge">Directory</span>
            <h4>Insurer Directory</h4>
            <p>Searchable directory of insurer claim departments (phone, email, web)</p>
          </a>
          <a class="tool-card" href="/app/resource-center/state-insurance-departments.html">
            <span class="badge">Directory</span>
            <h4>State Insurance Department Directory</h4>
            <p>One-click access to all 50 state insurance departments and key federal regulators.</p>
          </a>
          <a class="tool-card" href="/app/document-library/">
            <span class="badge">Library</span>
            <h4>Claim Document Library</h4>
            <p>Access professional templates and resources</p>
          </a>
          <a class="tool-card" href="/app/recommended-resources.html">
            <span class="badge">Resources</span>
            <h4>Recommended Resources</h4>
            <p>Connect with professionals and find additional help</p>
          </a>
        </div>
      </div>

      <!-- SECTION 5: Advanced Tools -->
      <div class="content-column">
        <h3 class="column-title">Advanced Tools</h3>
        <div class="tool-grid tool-grid-centered">
          <a class="tool-card" href="/app/resource-center/advanced-tools/advanced-tools.html" data-tier-required="pro">
            <div class="tool-badge tool-badge-pro">Pro</div>
            <span class="badge">Advanced</span>
            <h4>Advanced Tools Suite</h4>
            <p>Professional-grade analysis, valuation, compliance, and legal-strategy tools</p>
          </a>
          <a class="tool-card" href="/app/api-docs.html">
            <span class="badge">Developer</span>
            <h4>API Layer</h4>
            <p>Programmatic access to ClaimNavigatorAI services. RESTful API with 12 endpoints for integration.</p>
          </a>
        </div>
        <!-- CN Agent Dedicated Section -->
        <div class="cn-agent-section">
          <h4>ClaimNavigator Agent</h4>
          <p style="font-size: 14px; color: #6b7280; margin-bottom: 12px;">Your AI Copilot for Claims Automation</p>
          <p>
            Automate email drafting, send communications, create alerts, detect deadlines and payments, 
            and sync your Statement of Loss and Deadline Tracker automatically.
          </p>
          <p style="font-size: 13px; color: #6b7280; margin-bottom: 16px;">
            Email Automation • Deadline Tracking • Statement of Loss • Auto Alerts
          </p>
          <a href="/app/cn-agent.html" class="btn-primary">
            Open CN Agent
          </a>
        </div>
      </div>
    </div>
  </div>
</main>

<script>
  // Navigation dropdown toggle function
  function toggleNavDropdown(id) {
    const dropdown = document.getElementById(id);
    if (dropdown.style.display === 'block') {
      dropdown.style.display = 'none';
    } else {
      // Close all other dropdowns
      document.querySelectorAll('.nav-dropdown-content').forEach(d => {
        d.style.display = 'none';
      });
      
      // Open this dropdown
      dropdown.style.display = 'block';
    }
  }

  // Stage highlighting from roadmap
  (function() {
    const params = new URLSearchParams(window.location.search);
    const stage = params.get('stage'); // "1".."6"

    if (!stage) return;

    // mapping from stage id to href patterns or data attributes
    const stageToolSelectors = {
      "1": [
        '/fnol-wizard.html',
        '/quick-start.html',
        '/claim-playbook.html',
        '/claim-timeline.html',
        '/state-rights.html'
      ],
      "2": [
        '/evidence-organizer.html',
        '/document-generator',
        '/claim-journal.html',
        '/checklist-engine.html'
      ],
      "3": [
        '/claim-analysis.html',
        '/contractor-estimate-interpreter.html',
        '/rom-tool.html',
        '/maximize-claim.html',
        '/authority-hub.html'
      ],
      "4": [
        '/ai-response-agent.html',
        '/deadlines.html',
        '/insurer-directory.html',
        '/compliance-engine.html'
      ],
      "5": [
        '/negotiation-tools.html',
        '/claim-stage-tracker.html'
      ],
      "6": [
        '/advanced-tools/advanced-tools.html',
        '/regulatory-complaint',
        '/state-insurance-departments.html',
        '/recommended-resources.html'
      ]
    };

    const links = document.querySelectorAll('.tool-card');

    const matchesStage = stageToolSelectors[stage];
    if (!matchesStage) return;

    links.forEach(card => {
      const href = card.getAttribute('href');
      if (!href) return;
      const isStageTool = matchesStage.some(fragment => href.includes(fragment));
      if (isStageTool) {
        card.classList.add('stage-highlight');
      } else {
        card.classList.add('stage-dimmed');
      }
    });
  })();
  
  // Return to last stage button
  (function() {
    const stored = localStorage.getItem('claimRoadmapProgress');
    if (stored) {
      try {
        const state = JSON.parse(stored);
        if (state.currentStageId) {
          const btn = document.getElementById('return-last-stage-btn');
          if (btn) {
            btn.href = `/app/resource-center/claim-roadmap.html?stage=${state.currentStageId}`;
            document.getElementById('return-last-stage').style.display = 'block';
          }
        }
      } catch (e) {
        console.error('Error parsing roadmap state:', e);
      }
    }
  })();
  
  // Update global roadmap chip
  (function() {
    const savedStageName = localStorage.getItem("globalRoadmapStageName");
    const chipLink = document.getElementById("nav-roadmap-chip-link");
    if (savedStageName && chipLink) {
      chipLink.textContent = `Roadmap: ${savedStageName}`;
    }
  })();
  
  // Demo Toggle Button
  (function() {
    const dt = document.getElementById("demo-toggle");
    if (!dt) return;
    
    if (window.CNDemo && CNDemo.isDemoMode()) {
      dt.classList.add("active");
    }
    
    dt.addEventListener("click", () => {
      if (window.CNDemo) {
        if (CNDemo.isDemoMode()) {
          CNDemo.disableDemoMode();
          dt.classList.remove("active");
          alert("Demo Mode Disabled");
        } else {
          CNDemo.enableDemoMode();
          dt.classList.add("active");
          alert("Demo Mode Enabled");
        }
        location.reload();
      }
    });
  })();
</script>

<style>
/* Fix brand text to stay on one line */
.brand {
  white-space: nowrap !important;
  margin-right: 3rem !important;
}
.brand div {
  white-space: nowrap !important;
}

/* Navigation dropdown text color - dark for Resource Center */
.nav-dropdown-content {
  color: #000000 !important;
  background: #ffffff !important;
  font-family: 'Arial Black', Arial, sans-serif !important;
}

/* Limit navigation bar button text to three lines and center */
.nav-dropdown-toggle {
  display: -webkit-box !important;
  -webkit-line-clamp: 3 !important;
  -webkit-box-orient: vertical !important;
  overflow: hidden !important;
  text-overflow: ellipsis !important;
  line-height: 1.3 !important;
  max-height: 3.9em !important;
  word-wrap: break-word !important;
  white-space: normal !important;
  text-align: center !important;
  font-size: 12px !important;
  justify-content: center !important;
  align-items: center !important;
}

.nav-dropdown-content a,
.nav-dropdown-content h4,
.nav-dropdown-content p,
.nav-dropdown-content *,
.nav-dropdown-content .step,
.nav-dropdown-content .step-content,
.nav-dropdown-content .step-number,
.nav-dropdown-content .scenario,
.nav-dropdown-content .scenario h4 {
  color: #0f172a !important;
  -webkit-text-fill-color: #0f172a !important;
  font-family: 'Arial Black', Arial, sans-serif !important;
}

.nav-dropdown-content .scenario-links,
.nav-dropdown-content .how-to-steps,
.nav-dropdown-content .quick-start-scenarios {
  color: #000000 !important;
  -webkit-text-fill-color: #000000 !important;
}

.nav-dropdown-content .quick-start-scenarios .scenario h4,
.nav-dropdown-content .quick-start-scenarios h4 {
  color: #0f172a !important;
  -webkit-text-fill-color: #0f172a !important;
}

.nav-dropdown-content .scenario-link {
  color: #1e3a8a !important;
  -webkit-text-fill-color: #1e3a8a !important;
}

.nav-dropdown-content .scenario-link:hover {
  color: #1e40af !important;
  -webkit-text-fill-color: #1e40af !important;
}

.nav-dropdown-content .nav-link {
  color: #1e40af !important;
  -webkit-text-fill-color: #1e40af !important;
}
</style>

<script type="module" src="/app/assets/js/validation-utils.js"></script>
<script type="module" src="/app/assets/js/error-handler.js"></script>
<script type="module" src="/app/assets/js/api-client.js"></script>
<script type="module" src="/app/assets/js/response-center.js"></script>
<script type="module" src="/app/assets/js/window-bridge.js"></script>
<script type="module" src="/app/assets/js/diagnostics.js"></script>


<script src="/app/assets/js/supabase-client.js"></script>
<script src="/app/assets/js/auth-session.js"></script>
<script src="/app/assets/js/error-logging.js"></script>
<script src="/app/assets/js/toasts.js"></script>
<script src="/app/assets/js/loading.js"></script>
<script src="/app/assets/js/storage-v2.js"></script>
<script src="/app/assets/js/compliance-banner.js"></script>
<script src="/app/assets/js/claim-profile.js"></script>
<script src="/app/assets/js/claim-health-v2.js"></script>
<script src="/app/assets/js/health-hooks.js"></script>
<script src="/app/assets/js/claim-timeline.js"></script>
<script src="/app/assets/js/claim-reset.js"></script>
<script src="/app/assets/js/guided-tour.js"></script>
<script src="/app/assets/js/qa-mode.js" defer></script>
<script src="/app/assets/js/contrast-debug.js" defer></script>
<script src="/app/assets/js/font-color-audit.js" defer></script>
<script>
  // Require authentication
  (async () => {
    const isAuthenticated = await window.CNAuth?.requireAuth(true);
    if (!isAuthenticated) return; // Redirect will happen in requireAuth
  })();
  
  document.addEventListener("DOMContentLoaded", async () => {
    // Ensure user is authenticated
    const isAuthenticated = await window.CNAuth?.requireAuth(true);
    if (!isAuthenticated) return;
    
    // Render compliance banner
    if (window.CNCompliance) {
      CNCompliance.renderBanner("main-content-wrapper");
    }
    
    // If no claim profile yet → send to onboarding
    if (!CNClaimProfile.hasClaimProfile()) {
      window.location.href = "/app/onboarding/index.html";
    }
    
    // Display Claim Health Score
    if (window.CNHealth) {
      const health = CNHealth.compute();
      const scoreEl = document.getElementById("claim-health-score");
      const flagsEl = document.getElementById("claim-health-flags");
      const stateNoteEl = document.getElementById("claim-health-state-note");
      
      if (scoreEl) {
        scoreEl.textContent = health.score || 0;
      }
      
      if (flagsEl && health.flags && health.flags.length > 0) {
        flagsEl.innerHTML = "";
        health.flags.forEach(f => {
          const li = document.createElement("li");
          li.textContent = f;
          li.style.marginBottom = "8px";
          li.style.fontSize = "14px";
          flagsEl.appendChild(li);
        });
      }
      
      // Show state-specific note
      if (stateNoteEl && health.stateName) {
        stateNoteEl.textContent = `Health insights reflect general timing and documentation expectations for ${health.stateName}.`;
        stateNoteEl.style.display = "block";
      }
    }
    
    // Start guided tour only if claim profile exists and tour not completed
    if (CNClaimProfile.hasClaimProfile() && !localStorage.getItem("cn_guided_tour_complete")) {
      setTimeout(() => {
        if (window.startClaimNavigatorTour) {
          startClaimNavigatorTour();
        }
      }, 600);
    }
    
    // Listen for real-time health updates with feedback
    document.addEventListener("claimHealthUpdated", (e) => {
      const health = e.detail;
      const scoreEl = document.getElementById("claim-health-score");
      const flagsEl = document.getElementById("claim-health-flags");
      
      if (scoreEl) {
        const previousScore = parseInt(scoreEl.textContent) || 0;
        const newScore = health.score || 0;
        const delta = health.delta || (newScore - previousScore);
        
        scoreEl.textContent = newScore;
        
        // Add animation for score change
        scoreEl.style.animation = 'none';
        setTimeout(() => {
          scoreEl.style.animation = 'pulse 0.5s ease-in-out';
        }, 10);
        
        // Show toast feedback
        if (window.CNToast && delta !== 0) {
          if (delta > 0) {
            window.CNToast.success(`Claim Health improved to ${newScore}`);
          } else if (delta < 0) {
            window.CNToast.warn(`Some areas need attention (Score: ${newScore})`);
          }
        }
      }
      
      if (flagsEl) {
        flagsEl.innerHTML = "";
        if (health.flags && health.flags.length > 0) {
          health.flags.forEach(f => {
            const li = document.createElement("li");
            li.textContent = f;
            li.style.marginBottom = "8px";
            li.style.fontSize = "14px";
            flagsEl.appendChild(li);
          });
        }
      }
    });
    
    // Add nudges based on claim state
    setTimeout(() => {
      const photoCount = parseInt(localStorage.getItem("cn_evidence_photo_count") || "0", 10);
      const docCount = parseInt(localStorage.getItem("cn_docs_generated") || "0", 10);
      const profile = CNClaimProfile.getClaimProfile();
      
      if (photoCount < 3 && window.CNToast) {
        setTimeout(() => {
          window.CNToast.info("Add more photos to strengthen your claim.");
        }, 2000);
      }
      
      if (docCount === 0 && window.CNToast) {
        setTimeout(() => {
          window.CNToast.info("Generate your first claim document.");
        }, 4000);
      }
      
      if (!profile.claim?.claimType && window.CNToast) {
        setTimeout(() => {
          window.CNToast.info("Complete onboarding for accurate guidance.");
        }, 6000);
      }
    }, 1000);
    
    // Import file handler
    window.handleImportFile = function(event) {
      const file = event.target.files[0];
      if (!file) return;
      
      const reader = new FileReader();
      reader.onload = function(e) {
        try {
          const jsonData = e.target.result;
          if (window.CNStorage) {
            // Show confirmation modal
            if (confirm("This will overwrite your current claim data. Continue?")) {
              if (window.CNStorage.importJson(jsonData)) {
                setTimeout(() => {
                  window.location.reload();
                }, 1000);
              }
            }
          }
        } catch (error) {
          console.error("CNError (Import):", error);
          if (window.CNToast) {
            window.CNToast.error("Failed to import file. Invalid format.");
          }
        }
      };
      reader.readAsText(file);
      event.target.value = ''; // Reset input
    };
    
    // Snapshot handlers
    window.handleCreateSnapshot = function() {
      const label = prompt("Enter a label for this snapshot (optional):");
      if (window.CNStorage) {
        window.CNStorage.createSnapshot(label || "");
      }
    };
    
    window.handleShowSnapshots = function() {
      if (!window.CNStorage) return;
      
      const snapshots = window.CNStorage.listSnapshots();
      if (snapshots.length === 0) {
        if (window.CNToast) {
          window.CNToast.info("No snapshots available.");
        }
        return;
      }
      
      let message = "Available Snapshots:\n\n";
      snapshots.forEach((s, i) => {
        message += `${i + 1}. ${s.label} (${new Date(s.timestamp).toLocaleString()})\n`;
      });
      message += "\nEnter snapshot number to restore:";
      
      const choice = prompt(message);
      const index = parseInt(choice, 10) - 1;
      
      if (index >= 0 && index < snapshots.length) {
        if (confirm("This will overwrite your current claim data. Continue?")) {
          if (window.CNStorage.restoreSnapshot(snapshots[index].id)) {
            setTimeout(() => {
              window.location.reload();
            }, 1000);
          }
        }
      }
    };
  });
</script>
</body></html>
