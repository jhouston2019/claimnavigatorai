<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document Generator - ClaimNavigatorAI</title>
    <meta name="description" content="Generate professional insurance claim documents with AI assistance">
    <link rel="stylesheet" href="/app/assets/css/style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        .document-generator {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        .document-type-selector {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 0.75rem;
            padding: 2rem;
            margin-bottom: 2rem;
        }
        
        .document-type-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .document-type-card {
            background: #9ca3af;
            border: 2px solid #9ca3af;
            border-radius: 0.5rem;
            padding: 1.5rem;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
            color: #000000;
        }
        
        .document-type-card:hover {
            border-color: #6b7280;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(107, 114, 128, 0.3);
            background: #6b7280;
        }
        
        .document-type-card.selected {
            border-color: #6b7280;
            background: #6b7280;
        }
        
        .document-type-card h3 {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #000000;
        }
        
        .document-type-card p {
            color: #374151;
            font-size: 0.875rem;
            line-height: 1.5;
        }
        
        .form-container {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 0.75rem;
            padding: 2rem;
            margin-bottom: 2rem;
        }
        
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-group label {
            display: block;
            font-weight: 500;
            margin-bottom: 0.5rem;
            color: #374151;
        }
        
        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 0.5rem;
            font-size: 1rem;
            color: #000000;
            transition: border-color 0.2s;
        }
        
        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        .form-control {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #1e3a8a;
            border-radius: 0.5rem;
            font-size: 1rem;
            color: #000000;
            background: #ffffff;
            transition: border-color 0.2s;
        }
        
        .form-control:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        .btn-primary {
            background: #1e3a8a;
            color: white;
            border: 2px solid #1e3a8a;
            border-radius: 0.5rem;
            padding: 1rem 2rem;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            width: 100%;
        }
        
        .btn-primary:hover {
            background: #1e40af;
            border-color: #1e40af;
        }
        
        .form-group input::placeholder,
        .form-group textarea::placeholder {
            color: #6b7280;
        }
        
        .form-group textarea {
            min-height: 120px;
            resize: vertical;
        }
        
        .generate-btn {
            background: #3b82f6;
            color: white;
            border: none;
            border-radius: 0.5rem;
            padding: 1rem 2rem;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s;
            width: 100%;
        }
        
        .generate-btn:hover {
            background: #2563eb;
        }
        
        .generate-btn:disabled {
            background: #9ca3af;
            cursor: not-allowed;
        }
        
        .result-container {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 0.75rem;
            padding: 2rem;
            margin-top: 2rem;
            display: none;
        }
        
        .result-container.show {
            display: block;
        }
        
        .result-content {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin-bottom: 1rem;
            max-height: 400px;
            overflow-y: auto;
            white-space: pre-wrap;
            font-family: 'Courier New', monospace;
            font-size: 0.875rem;
            line-height: 1.5;
        }
        
        .download-buttons {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }
        
        .download-btn {
            background: #10b981;
            color: white;
            border: none;
            border-radius: 0.5rem;
            padding: 0.75rem 1.5rem;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.2s;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .download-btn:hover {
            background: #059669;
        }
        
        .download-btn.secondary {
            background: #6b7280;
        }
        
        .download-btn.secondary:hover {
            background: #4b5563;
        }
        
        .loading {
            display: none;
            text-align: center;
            padding: 2rem;
        }
        
        .loading.show {
            display: block;
        }
        
        .spinner {
            display: inline-block;
            width: 2rem;
            height: 2rem;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3b82f6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .error-message {
            background: #fef2f2;
            border: 1px solid #fecaca;
            color: #dc2626;
            padding: 1rem;
            border-radius: 0.5rem;
            margin: 1rem 0;
        }
        
        @media (max-width: 768px) {
            .document-generator {
                padding: 1rem;
            }
            
            .document-type-grid {
                grid-template-columns: 1fr;
            }
            
            .download-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation Header -->
    <header class="header">
        <div class="bar container">
            <div class="brand">
                <div class="logo"></div>
                <div>Document Generator</div>
            </div>
            <nav class="nav">
                <a href="/app/response-center.html">‚Üê Resource Center</a>
            </nav>
        </div>
    </header>

    <main class="document-generator">
        <div class="text-center mb-4">
            <h1>üìÑ Document Generator</h1>
            <p>Generate professional insurance claim documents with AI assistance</p>
        </div>

        <!-- Document Type Selection -->
        <div class="document-type-selector">
            <h2>Select Document Type</h2>
            <p>Choose the type of document you need to generate for your claim.</p>
            
            <div class="document-type-grid">
                <!-- Core Documents -->
                <div class="document-type-card" data-type="proof-of-loss">
                    <h3>üìÑ Proof of Loss</h3>
                    <p>Sworn statement of damages</p>
                </div>
                
                <div class="document-type-card" data-type="appeal-letter">
                    <h3>üìù Appeal Letter</h3>
                    <p>Denied/underpaid? Appeal</p>
                </div>
                
                <div class="document-type-card" data-type="demand-letter">
                    <h3>‚öñÔ∏è Demand Letter</h3>
                    <p>Formal payment request</p>
                </div>
                
                <div class="document-type-card" data-type="damage-inventory">
                    <h3>üìã Damage Inventory</h3>
                    <p>Line-item list</p>
                </div>
                
                <div class="document-type-card" data-type="claim-timeline">
                    <h3>üìÖ Claim Timeline / Diary</h3>
                    <p>Chronological log</p>
                </div>
                
                <div class="document-type-card" data-type="repair-replace">
                    <h3>üîß Repair vs Replace</h3>
                    <p>Cost worksheet</p>
                </div>
                
                <div class="document-type-card" data-type="out-of-pocket">
                    <h3>üí∞ Out-of-Pocket Log</h3>
                    <p>ALE & expenses</p>
                </div>
                
                <div class="document-type-card" data-type="appraisal-demand">
                    <h3>‚öñÔ∏è Appraisal Demand</h3>
                    <p>Invoke appraisal clause</p>
                </div>
                
                <div class="document-type-card" data-type="notice-of-delay">
                    <h3>‚è∞ Notice of Delay</h3>
                    <p>Timelines exceeded</p>
                </div>
                
                <div class="document-type-card" data-type="coverage-clarification">
                    <h3>‚ùì Coverage Clarification</h3>
                    <p>Ask insurer to interpret</p>
                </div>
                
                <!-- Support Documents -->
                <div class="document-type-card" data-type="notice-of-claim">
                    <h3>üì¢ Notice of Claim</h3>
                    <p>Initial loss report</p>
                </div>
                
                <div class="document-type-card" data-type="rom-estimate">
                    <h3>üìä ROM Estimate Report</h3>
                    <p>High-level cost range</p>
                </div>
                
                <div class="document-type-card" data-type="photograph-log">
                    <h3>üì∏ Photograph Log</h3>
                    <p>Captions & descriptions</p>
                </div>
                
                <div class="document-type-card" data-type="document-index">
                    <h3>üìë Document Index</h3>
                    <p>Auto-generated list</p>
                </div>
                
                <div class="document-type-card" data-type="comparative-estimates">
                    <h3>üìä Comparative Estimates</h3>
                    <p>Side-by-side</p>
                </div>
                
                <div class="document-type-card" data-type="settlement-sheet">
                    <h3>üìã Settlement Sheet</h3>
                    <p>Offer vs value</p>
                </div>
            </div>
        </div>

        <!-- Document Form -->
        <div class="form-container" id="formContainer" style="display: none;">
            <h2 id="formTitle">Document Information</h2>
            <p id="formDescription">Please provide the details for your document.</p>
            
            <form id="documentForm">
                <div class="form-group">
                    <label for="claimantName">Your Name</label>
                    <input type="text" id="claimantName" name="claimantName" class="form-control" required>
                </div>
                
                <div class="form-group">
                    <label for="claimantAddress">Your Address</label>
                    <textarea id="claimantAddress" name="claimantAddress" class="form-control" rows="3" required></textarea>
                </div>
                
                <div class="form-group">
                    <label for="insurerName">Insurance Company</label>
                    <input type="text" id="insurerName" name="insurerName" class="form-control" required>
                </div>
                
                <div class="form-group">
                    <label for="policyNumber">Policy Number</label>
                    <input type="text" id="policyNumber" name="policyNumber" class="form-control" required>
                </div>
                
                <div class="form-group">
                    <label for="claimNumber">Claim Number</label>
                    <input type="text" id="claimNumber" name="claimNumber" class="form-control" required>
                </div>
                
                <div class="form-group">
                    <label for="dateOfLoss">Date of Loss</label>
                    <input type="date" id="dateOfLoss" name="dateOfLoss" class="form-control" required>
                </div>
                
                <div class="form-group">
                    <label for="phoneNumber">Phone Number</label>
                    <input type="tel" id="phoneNumber" name="phoneNumber" class="form-control" placeholder="(555) 123-4567">
                </div>
                
                <div class="form-group">
                    <label for="email">Email Address</label>
                    <input type="email" id="email" name="email" class="form-control" placeholder="your.email@example.com">
                </div>
                
                <div class="form-group">
                    <label for="situationDetails">Situation Details</label>
                    <textarea id="situationDetails" name="situationDetails" class="form-control" rows="4" placeholder="Describe your specific situation and what you need help with..." required></textarea>
                </div>
                
                <button type="submit" class="btn-primary" id="generateBtn">
                    Generate Document
                </button>
            </form>
        </div>

        <!-- Loading State -->
        <div class="loading" id="loadingState">
            <div class="spinner"></div>
            <p>Generating your document...</p>
        </div>

        <!-- Results -->
        <div class="result-container" id="resultContainer">
            <h3>Generated Document</h3>
            <div class="result-content" id="resultContent"></div>
            <div class="download-buttons">
                <button class="download-btn" id="downloadPdfBtn">
                    üìÑ Download PDF
                </button>
                <button class="download-btn secondary" id="copyTextBtn">
                    üìã Copy Text
                </button>
            </div>
        </div>
    </main>

    <script>
        class DocumentGenerator {
            constructor() {
                this.selectedType = null;
                this.generatedContent = null;
                this.init();
            }

            init() {
                this.setupDocumentTypeSelection();
                this.setupFormSubmission();
                this.setupDownloadButtons();
                this.handleUrlParameters();
            }

            handleUrlParameters() {
                const urlParams = new URLSearchParams(window.location.search);
                const type = urlParams.get('type');
                
                console.log('URL Parameters:', window.location.search);
                console.log('Document Type from URL:', type);
                
                if (type) {
                    // Map document types from advisory page
                    const typeMapping = {
                        'Proof of Loss': 'proof-of-loss',
                        'Appeal Letter': 'appeal-letter',
                        'Demand Letter': 'demand-letter',
                        'Damage Inventory': 'damage-inventory',
                        'Claim Timeline / Diary': 'claim-timeline',
                        'Repair vs Replace': 'repair-replace',
                        'Out-of-Pocket Log': 'out-of-pocket',
                        'Appraisal Demand': 'appraisal-demand',
                        'Notice of Delay': 'notice-of-delay',
                        'Notice of Delay Complaint': 'notice-of-delay',
                        'Coverage Clarification': 'coverage-clarification',
                        'Coverage Clarification Request': 'coverage-clarification',
                        'Notice of Claim': 'notice-of-claim',
                        'ROM Estimate Report': 'rom-estimate',
                        'Photograph Log': 'photograph-log',
                        'Document Index': 'document-index',
                        'Comparative Estimates': 'comparative-estimates',
                        'Settlement Sheet': 'settlement-sheet',
                        'Proof of Repairs Submission': 'proof-of-loss',
                        'Ordinance & Law Coverage Request': 'coverage-clarification',
                        'Matching Coverage Request': 'coverage-clarification',
                        'Betterment Dispute Letter': 'appeal-letter',
                        'Deductible Verification Request': 'coverage-clarification',
                        'Supplement Request': 'demand-letter',
                        'Emergency Services Coverage Request': 'coverage-clarification',
                        'Contents Inventory Appeal': 'appeal-letter',
                        'Additional Living Expenses Request': 'coverage-clarification',
                        'Independent Expert Request': 'appraisal-demand',
                        'Coverage Analysis Request': 'coverage-clarification',
                        'Regulatory Complaint': 'delay-complaint',
                        'Business Income Documentation': 'out-of-pocket',
                        'Extra Expense Documentation': 'out-of-pocket',
                        'Restoration Timeline Analysis': 'claim-timeline',
                        'Civil Authority Coverage Request': 'coverage-clarification',
                        'Dependent Property Analysis': 'coverage-clarification',
                        'Extended Indemnity Request': 'coverage-clarification',
                        'Contingent Business Income Claim': 'out-of-pocket',
                        'Employee Wage Documentation': 'out-of-pocket',
                        'Lease Obligation Documentation': 'out-of-pocket',
                        'Utility Expense Documentation': 'out-of-pocket',
                        'Professional Services Documentation': 'out-of-pocket',
                        'Marketing Expense Documentation': 'out-of-pocket',
                        'Inventory Loss Documentation': 'damage-inventory',
                        'Equipment Rental Documentation': 'out-of-pocket',
                        'Relocation Expense Documentation': 'out-of-pocket',
                        'Contract Loss Documentation': 'out-of-pocket',
                        'Hurricane Damage Documentation': 'damage-inventory',
                        'Flood Coverage Analysis': 'coverage-clarification',
                        'Wildfire Damage Documentation': 'damage-inventory',
                        'Earthquake Damage Documentation': 'damage-inventory',
                        'Tornado Damage Documentation': 'damage-inventory',
                        'Hail Damage Documentation': 'damage-inventory',
                        'Ice Storm Damage Documentation': 'damage-inventory',
                        'Blizzard Damage Documentation': 'damage-inventory',
                        'Drought Damage Documentation': 'damage-inventory',
                        'Heat Wave Damage Documentation': 'damage-inventory',
                        'Severe Storm Damage Documentation': 'damage-inventory',
                        'Lightning Damage Documentation': 'damage-inventory',
                        'Power Outage Damage Documentation': 'damage-inventory',
                        'Storm Water Damage Documentation': 'damage-inventory',
                        'Debris Removal Documentation': 'damage-inventory',
                        'Emergency Repair Documentation': 'damage-inventory'
                    };
                    
                    const mappedType = typeMapping[type] || type.toLowerCase().replace(/\s+/g, '-');
                    console.log('Mapped Type:', mappedType);
                    
                    const card = document.querySelector(`[data-type="${mappedType}"]`);
                    console.log('Found Card:', card);
                    
                    if (card) {
                        console.log('Selecting document type:', mappedType);
                        this.selectDocumentType(card);
                    } else {
                        console.error('No card found for type:', mappedType);
                        console.log('Available cards:', document.querySelectorAll('.document-type-card'));
                    }
                }
            }

            setupDocumentTypeSelection() {
                const cards = document.querySelectorAll('.document-type-card');
                
                cards.forEach(card => {
                    card.addEventListener('click', () => {
                        this.selectDocumentType(card);
                    });
                });
            }

            selectDocumentType(card) {
                console.log('Selecting document type card:', card);
                console.log('Card dataset type:', card.dataset.type);
                
                // Remove previous selection
                document.querySelectorAll('.document-type-card').forEach(c => c.classList.remove('selected'));
                
                // Select new card
                card.classList.add('selected');
                this.selectedType = card.dataset.type;
                
                console.log('Selected type:', this.selectedType);
                
                // Show form
                this.showForm();
            }

            showForm() {
                const formContainer = document.getElementById('formContainer');
                const formTitle = document.getElementById('formTitle');
                const formDescription = document.getElementById('formDescription');
                
                const typeInfo = {
                    'proof-of-loss': {
                        title: 'Proof of Loss',
                        description: 'Generate a sworn statement of damages for your claim.'
                    },
                    'appeal-letter': {
                        title: 'Appeal Letter',
                        description: 'Generate a professional appeal letter for your denied or underpaid claim.'
                    },
                    'demand-letter': {
                        title: 'Demand Letter',
                        description: 'Create a strong demand letter requesting fair settlement from your insurer.'
                    },
                    'damage-inventory': {
                        title: 'Damage Inventory',
                        description: 'Create a comprehensive line-item list of all damages.'
                    },
                    'claim-timeline': {
                        title: 'Claim Timeline / Diary',
                        description: 'Generate a chronological log of your claim events.'
                    },
                    'repair-replace': {
                        title: 'Repair vs Replace',
                        description: 'Create a cost worksheet comparing repair vs replacement options.'
                    },
                    'out-of-pocket': {
                        title: 'Out-of-Pocket Log',
                        description: 'Document ALE and other out-of-pocket expenses.'
                    },
                    'appraisal-demand': {
                        title: 'Appraisal Demand',
                        description: 'Invoke the appraisal clause in your policy.'
                    },
                    'notice-of-delay': {
                        title: 'Notice of Delay',
                        description: 'Generate a formal complaint about delayed claim processing.'
                    },
                    'coverage-clarification': {
                        title: 'Coverage Clarification',
                        description: 'Request clarification on coverage decisions and exclusions.'
                    },
                    'notice-of-claim': {
                        title: 'Notice of Claim',
                        description: 'Generate an initial loss report document.'
                    },
                    'rom-estimate': {
                        title: 'ROM Estimate Report',
                        description: 'Create a high-level cost range estimate.'
                    },
                    'photograph-log': {
                        title: 'Photograph Log',
                        description: 'Organize photos with captions and descriptions.'
                    },
                    'document-index': {
                        title: 'Document Index',
                        description: 'Generate an auto-generated list of all claim documents.'
                    },
                    'comparative-estimates': {
                        title: 'Comparative Estimates',
                        description: 'Create side-by-side comparison of estimates.'
                    },
                    'settlement-sheet': {
                        title: 'Settlement Sheet',
                        description: 'Compare offer vs actual value.'
                    }
                };
                
                const info = typeInfo[this.selectedType];
                formTitle.textContent = info.title;
                formDescription.textContent = info.description;
                formContainer.style.display = 'block';
                
                // Scroll to form
                formContainer.scrollIntoView({ behavior: 'smooth' });
            }

            setupFormSubmission() {
                const form = document.getElementById('documentForm');
                const generateBtn = document.getElementById('generateBtn');
                
                form.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    
                    generateBtn.disabled = true;
                    generateBtn.textContent = 'Generating...';
                    
                    const formData = new FormData(form);
                    const data = Object.fromEntries(formData);
                    
                    try {
                        await this.generateDocument(data);
                    } catch (error) {
                        console.error('Error generating document:', error);
                        this.showError('Failed to generate document. Please try again.');
                    } finally {
                        generateBtn.disabled = false;
                        generateBtn.textContent = 'Generate Document';
                    }
                });
            }

            async generateDocument(data) {
                const loadingState = document.getElementById('loadingState');
                const resultContainer = document.getElementById('resultContainer');
                
                // Show loading
                loadingState.classList.add('show');
                resultContainer.classList.remove('show');
                
                try {
                    // Simulate AI generation (replace with actual API call)
                    const response = await this.callAIGeneration(data);
                    
                    // Hide loading
                    loadingState.classList.remove('show');
                    
                    // Show results
                    this.generatedContent = response.content;
                    this.displayResults(response.content);
                    
                } catch (error) {
                    loadingState.classList.remove('show');
                    throw error;
                }
            }

            async callAIGeneration(data) {
                // Use AI to generate rich, applicable documents
                try {
                    const response = await fetch('/netlify/functions/generate-document', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            documentType: this.selectedType,
                            claimData: data
                        })
                    });

                    if (response.ok) {
                        const result = await response.json();
                        return {
                            content: result.content,
                            success: true
                        };
                    } else {
                        throw new Error('AI generation failed');
                    }
                } catch (error) {
                    console.error('AI Generation Error:', error);
                    // Fallback to static templates if AI fails
                    return this.generateFallbackDocument(data);
                }
            }

            generateFallbackDocument(data) {
                const documentTemplates = {
                    'proof-of-loss': this.generateProofOfLoss(data),
                    'appeal-letter': this.generateAppealLetter(data),
                    'demand-letter': this.generateDemandLetter(data),
                    'damage-inventory': this.generateDamageInventory(data),
                    'claim-timeline': this.generateClaimTimeline(data),
                    'repair-replace': this.generateRepairReplace(data),
                    'out-of-pocket': this.generateOutOfPocket(data),
                    'appraisal-demand': this.generateAppraisalDemand(data),
                    'notice-of-delay': this.generateNoticeOfDelay(data),
                    'coverage-clarification': this.generateCoverageClarification(data),
                    'notice-of-claim': this.generateNoticeOfClaim(data),
                    'rom-estimate': this.generateROMEstimate(data),
                    'photograph-log': this.generatePhotographLog(data),
                    'document-index': this.generateDocumentIndex(data),
                    'comparative-estimates': this.generateComparativeEstimates(data),
                    'settlement-sheet': this.generateSettlementSheet(data)
                };
                
                const content = documentTemplates[this.selectedType] || 'Document content not available.';
                
                return {
                    content: content,
                    success: true
                };
            }

            generateDocumentHeader(data) {
                return `CLAIM INFORMATION
================
Policyholder: ${data.claimantName}
Address: ${data.claimantAddress}
Phone: ${data.phoneNumber || 'Not provided'}
Email: ${data.email || 'Not provided'}

Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}
Insurance Company: ${data.insurerName}

Generated: ${new Date().toLocaleDateString()}
Document Type: ${this.selectedType.replace(/-/g, ' ').toUpperCase()}

========================================

`;
            }

            generateAppealLetter(data) {
                const header = this.generateDocumentHeader(data);
                return `${header}${data.claimantName}
${data.claimantAddress}

${new Date().toLocaleDateString()}

${data.insurerName}
Claims Department
[Insurance Company Address]

Re: APPEAL OF CLAIM DENIAL/UNDERPAYMENT
Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

Dear Claims Department,

I am writing to formally appeal the decision regarding my insurance claim filed on ${data.dateOfLoss}. After careful review of your determination, I believe this decision was made in error and request immediate reconsideration based on the following:

CLAIM DETAILS:
- Policy Number: ${data.policyNumber}
- Claim Number: ${data.claimNumber}
- Date of Loss: ${data.dateOfLoss}
- Claimant: ${data.claimantName}
- Property Address: ${data.claimantAddress}

SITUATION ANALYSIS:
${data.situationDetails}

LEGAL BASIS FOR APPEAL:
1. The denial/underpayment appears to be based on insufficient investigation
2. All policy provisions and coverage terms have not been properly considered
3. The decision may violate state insurance regulations regarding fair claims practices
4. Additional documentation and evidence support coverage under the policy

SPECIFIC DEMANDS:
I respectfully demand that you:
1. Immediately review all submitted documentation and evidence
2. Reconsider the coverage determination with proper policy interpretation
3. Provide a detailed written explanation for any denial, citing specific policy language
4. Schedule a reinspection with an independent adjuster if necessary
5. Respond to this appeal within 30 days as required by state law

FAILURE TO RESPOND APPROPRIATELY:
If this appeal is not resolved satisfactorily, I reserve the right to:
- File a complaint with the state insurance department
- Seek legal counsel to protect my rights
- Pursue all available remedies under the law

I expect a prompt and thorough review of this appeal. Please provide your response in writing within 30 days.

Sincerely,
${data.claimantName}

CC: State Insurance Department (if applicable)`;
            }

            generateDemandLetter(data) {
                const header = this.generateDocumentHeader(data);
                return `${header}[Your Name]
${data.claimantAddress}

[Date]

[Insurance Company Name]
${data.insurerName}
[Insurance Company Address]

Re: Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

Dear Claims Department,

I am writing to formally demand payment for my insurance claim filed on ${data.dateOfLoss}. Despite providing all requested documentation, I have not received a fair settlement offer.

CLAIM DETAILS:
- Policy Number: ${data.policyNumber}
- Claim Number: ${data.claimNumber}
- Date of Loss: ${data.dateOfLoss}

SITUATION:
${data.situationDetails}

I demand that you:
1. Provide a fair and complete settlement
2. Respond within 30 days
3. Provide detailed explanation for any deductions
4. Release all applicable depreciation

Failure to respond appropriately may result in legal action.

Sincerely,
${data.claimantName}`;
            }

            generateNoticeOfDelay(data) {
                const header = this.generateDocumentHeader(data);
                return `${header}[Your Name]
${data.claimantAddress}

[Date]

[Insurance Company Name]
${data.insurerName}
[Insurance Company Address]

Re: Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

Dear Claims Department,

I am writing to formally complain about the excessive delay in processing my insurance claim. This delay constitutes a violation of [State] insurance regulations.

CLAIM DETAILS:
- Policy Number: ${data.policyNumber}
- Claim Number: ${data.claimNumber}
- Date of Loss: ${data.dateOfLoss}
- Days Since Filing: [Calculate]

SITUATION:
${data.situationDetails}

According to [State] insurance regulations, you are required to:
1. Acknowledge claims within 14 days
2. Provide coverage decisions within 30 days
3. Respond to communications promptly

I demand immediate action on my claim and request a detailed timeline for resolution.

Sincerely,
${data.claimantName}`;
            }

            generateCoverageClarification(data) {
                return `[Your Name]
${data.claimantAddress}

[Date]

[Insurance Company Name]
${data.insurerName}
[Insurance Company Address]

Re: Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

Dear Claims Department,

I am writing to request clarification regarding coverage decisions made on my insurance claim. I need detailed explanations for all coverage determinations.

CLAIM DETAILS:
- Policy Number: ${data.policyNumber}
- Claim Number: ${data.claimNumber}
- Date of Loss: ${data.dateOfLoss}

SITUATION:
${data.situationDetails}

I request written clarification on:
1. Specific policy provisions cited
2. Coverage exclusions applied
3. Deductible calculations
4. Depreciation schedules used
5. Any other coverage decisions

Please provide this information within 10 business days.

Sincerely,
${data.claimantName}`;
            }

            generateProofOfRepairs(data) {
                return `[Your Name]
${data.claimantAddress}

[Date]

[Insurance Company Name]
${data.insurerName}
[Insurance Company Address]

Re: Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

Dear Claims Department,

I am submitting proof of completed repairs to request release of depreciation holdback as provided for in my policy.

CLAIM DETAILS:
- Policy Number: ${data.policyNumber}
- Claim Number: ${data.claimNumber}
- Date of Loss: ${data.dateOfLoss}

SITUATION:
${data.situationDetails}

REPAIRS COMPLETED:
[Attach invoices, receipts, and photos]

I request immediate release of the depreciation holdback as repairs have been completed according to policy requirements.

Sincerely,
${data.claimantName}`;
            }

            generateOrdinanceLaw(data) {
                return `[Your Name]
${data.claimantAddress}

[Date]

[Insurance Company Name]
${data.insurerName}
[Insurance Company Address]

Re: Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

Dear Claims Department,

I am requesting coverage for mandatory code upgrades required by local building codes as provided for under the Ordinance and Law coverage in my policy.

CLAIM DETAILS:
- Policy Number: ${data.policyNumber}
- Claim Number: ${data.claimNumber}
- Date of Loss: ${data.dateOfLoss}

SITUATION:
${data.situationDetails}

CODE REQUIREMENTS:
[Attach building department requirements]

I request coverage for all mandatory code upgrades as they are required by local ordinance and covered under my policy.

Sincerely,
${data.claimantName}`;
            }

            // Additional template generators for all document types
            generateMatchingCoverage(data) {
                return `[Your Name]
${data.claimantAddress}

[Date]

[Insurance Company Name]
${data.insurerName}
[Insurance Company Address]

Re: Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

Dear Claims Department,

I am requesting coverage for matching materials and finishes as provided for under the consequential damage coverage in my policy.

CLAIM DETAILS:
- Policy Number: ${data.policyNumber}
- Claim Number: ${data.claimNumber}
- Date of Loss: ${data.dateOfLoss}

SITUATION:
${data.situationDetails}

MATCHING REQUIREMENTS:
[Document visible differences and matching needs]

I request coverage for all matching materials as they are necessary to restore the property to its pre-loss condition.

Sincerely,
${data.claimantName}`;
            }

            generateBettermentDispute(data) {
                return `[Your Name]
${data.claimantAddress}

[Date]

[Insurance Company Name]
${data.insurerName}
[Insurance Company Address]

Re: Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

Dear Claims Department,

I am disputing the betterment charges applied to my claim as they are improper and not supported by the facts.

CLAIM DETAILS:
- Policy Number: ${data.policyNumber}
- Claim Number: ${data.claimNumber}
- Date of Loss: ${data.dateOfLoss}

SITUATION:
${data.situationDetails}

DISPUTE DETAILS:
[Challenge the betterment charges with specific reasoning]

I request removal of all improper betterment charges and payment of the full claim amount.

Sincerely,
${data.claimantName}`;
            }

            generateDeductibleVerification(data) {
                return `[Your Name]
${data.claimantAddress}

[Date]

[Insurance Company Name]
${data.insurerName}
[Insurance Company Address]

Re: Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

Dear Claims Department,

I am requesting verification of the deductible amount applied to my claim and challenge any multiple deductibles.

CLAIM DETAILS:
- Policy Number: ${data.policyNumber}
- Claim Number: ${data.claimNumber}
- Date of Loss: ${data.dateOfLoss}

SITUATION:
${data.situationDetails}

DEDUCTIBLE VERIFICATION:
[Request specific deductible breakdown and challenge multiple deductibles]

I request written verification of the deductible calculation and removal of any improper multiple deductibles.

Sincerely,
${data.claimantName}`;
            }

            generateSupplementRequest(data) {
                return `[Your Name]
${data.claimantAddress}

[Date]

[Insurance Company Name]
${data.insurerName}
[Insurance Company Address]

Re: Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

Dear Claims Department,

I am requesting a supplement to my claim for additional damage discovered during the repair process.

CLAIM DETAILS:
- Policy Number: ${data.policyNumber}
- Claim Number: ${data.claimNumber}
- Date of Loss: ${data.dateOfLoss}

SITUATION:
${data.situationDetails}

ADDITIONAL DAMAGE:
[Document all additional damage discovered]

I request immediate processing of this supplement as the additional damage is directly related to the covered loss.

Sincerely,
${data.claimantName}`;
            }

            generateEmergencyServices(data) {
                return `[Your Name]
${data.claimantAddress}

[Date]

[Insurance Company Name]
${data.insurerName}
[Insurance Company Address]

Re: Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

Dear Claims Department,

I am requesting coverage for emergency services provided to prevent further damage to my property.

CLAIM DETAILS:
- Policy Number: ${data.policyNumber}
- Claim Number: ${data.claimNumber}
- Date of Loss: ${data.dateOfLoss}

SITUATION:
${data.situationDetails}

EMERGENCY SERVICES:
[Document all emergency services and their necessity]

I request coverage for all emergency services as they were necessary to prevent further damage and are covered under my policy.

Sincerely,
${data.claimantName}`;
            }

            generateContentsInventory(data) {
                return `[Your Name]
${data.claimantAddress}

[Date]

[Insurance Company Name]
${data.insurerName}
[Insurance Company Address]

Re: Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

Dear Claims Department,

I am appealing the contents inventory valuation and depreciation applied to my claim.

CLAIM DETAILS:
- Policy Number: ${data.policyNumber}
- Claim Number: ${data.claimNumber}
- Date of Loss: ${data.dateOfLoss}

SITUATION:
${data.situationDetails}

INVENTORY APPEAL:
[Challenge valuation and depreciation with supporting documentation]

I request a fair valuation of my contents and appropriate depreciation rates based on age and condition.

Sincerely,
${data.claimantName}`;
            }

            generateALERequest(data) {
                return `[Your Name]
${data.claimantAddress}

[Date]

[Insurance Company Name]
${data.insurerName}
[Insurance Company Address]

Re: Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

Dear Claims Department,

I am requesting coverage for Additional Living Expenses (ALE) as my home is uninhabitable due to the covered loss.

CLAIM DETAILS:
- Policy Number: ${data.policyNumber}
- Claim Number: ${data.claimNumber}
- Date of Loss: ${data.dateOfLoss}

SITUATION:
${data.situationDetails}

ALE EXPENSES:
[Document all temporary housing and related expenses]

I request coverage for all ALE expenses as they are necessary due to the uninhabitable condition of my home.

Sincerely,
${data.claimantName}`;
            }

            generateIndependentExpert(data) {
                return `[Your Name]
${data.claimantAddress}

[Date]

[Insurance Company Name]
${data.insurerName}
[Insurance Company Address]

Re: Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

Dear Claims Department,

I am requesting an independent expert evaluation of my claim at your expense.

CLAIM DETAILS:
- Policy Number: ${data.policyNumber}
- Claim Number: ${data.claimNumber}
- Date of Loss: ${data.dateOfLoss}

SITUATION:
${data.situationDetails}

EXPERT REQUEST:
[Specify the type of expert needed and scope of evaluation]

I request an independent expert evaluation to ensure a fair and impartial assessment of my claim.

Sincerely,
${data.claimantName}`;
            }

            generateCoverageAnalysis(data) {
                return `[Your Name]
${data.claimantAddress}

[Date]

[Insurance Company Name]
${data.insurerName}
[Insurance Company Address]

Re: Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

Dear Claims Department,

I am requesting a detailed coverage analysis and limits review for my claim.

CLAIM DETAILS:
- Policy Number: ${data.policyNumber}
- Claim Number: ${data.claimNumber}
- Date of Loss: ${data.dateOfLoss}

SITUATION:
${data.situationDetails}

COVERAGE ANALYSIS REQUEST:
[Request specific coverage analysis and limits review]

I request a comprehensive coverage analysis to ensure all applicable coverage is being considered.

Sincerely,
${data.claimantName}`;
            }

            generateRegulatoryComplaint(data) {
                return `[Your Name]
${data.claimantAddress}

[Date]

[State Insurance Department]
[Department Address]

Re: Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}
Insurance Company: ${data.insurerName}

Dear Insurance Department,

I am filing a complaint against ${data.insurerName} for violations of insurance regulations in handling my claim.

CLAIM DETAILS:
- Policy Number: ${data.policyNumber}
- Claim Number: ${data.claimNumber}
- Date of Loss: ${data.dateOfLoss}
- Insurance Company: ${data.insurerName}

SITUATION:
${data.situationDetails}

REGULATORY VIOLATIONS:
[Document specific violations of insurance regulations]

I request investigation of these violations and appropriate action against the insurer.

Sincerely,
${data.claimantName}`;
            }

            // Business Interruption Templates
            generateBusinessIncome(data) {
                return `[Your Name]
${data.claimantAddress}

[Date]

[Insurance Company Name]
${data.insurerName}
[Insurance Company Address]

Re: Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

Dear Claims Department,

I am submitting documentation for business income losses due to the covered loss.

CLAIM DETAILS:
- Policy Number: ${data.policyNumber}
- Claim Number: ${data.claimNumber}
- Date of Loss: ${data.dateOfLoss}

SITUATION:
${data.situationDetails}

BUSINESS INCOME LOSSES:
[Document lost revenue, profit projections, and business impact]

I request coverage for all business income losses as they are directly caused by the covered loss.

Sincerely,
${data.claimantName}`;
            }

            generateExtraExpense(data) {
                return `[Your Name]
${data.claimantAddress}

[Date]

[Insurance Company Name]
${data.insurerName}
[Insurance Company Address]

Re: Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

Dear Claims Department,

I am submitting documentation for extra expenses incurred to minimize business interruption.

CLAIM DETAILS:
- Policy Number: ${data.policyNumber}
- Claim Number: ${data.claimNumber}
- Date of Loss: ${data.dateOfLoss}

SITUATION:
${data.situationDetails}

EXTRA EXPENSES:
[Document all extra expenses and their necessity]

I request coverage for all extra expenses as they were necessary to minimize business interruption.

Sincerely,
${data.claimantName}`;
            }

            generateRestorationTimeline(data) {
                return `[Your Name]
${data.claimantAddress}

[Date]

[Insurance Company Name]
${data.insurerName}
[Insurance Company Address]

Re: Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

Dear Claims Department,

I am challenging the restoration timeline estimate and requesting a realistic assessment.

CLAIM DETAILS:
- Policy Number: ${data.policyNumber}
- Claim Number: ${data.claimNumber}
- Date of Loss: ${data.dateOfLoss}

SITUATION:
${data.situationDetails}

TIMELINE CHALLENGE:
[Provide contractor estimates and challenge unrealistic timelines]

I request a realistic restoration timeline based on actual contractor estimates and market conditions.

Sincerely,
${data.claimantName}`;
            }

            generateCivilAuthority(data) {
                return `[Your Name]
${data.claimantAddress}

[Date]

[Insurance Company Name]
${data.insurerName}
[Insurance Company Address]

Re: Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

Dear Claims Department,

I am requesting coverage under Civil Authority provisions for government-ordered business closures.

CLAIM DETAILS:
- Policy Number: ${data.policyNumber}
- Claim Number: ${data.claimNumber}
- Date of Loss: ${data.dateOfLoss}

SITUATION:
${data.situationDetails}

CIVIL AUTHORITY COVERAGE:
[Document government orders and their impact on business]

I request coverage for all losses due to civil authority orders as they are covered under my policy.

Sincerely,
${data.claimantName}`;
            }

            generateDependentProperty(data) {
                return `[Your Name]
${data.claimantAddress}

[Date]

[Insurance Company Name]
${data.insurerName}
[Insurance Company Address]

Re: Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

Dear Claims Department,

I am requesting coverage for losses due to damage to dependent properties.

CLAIM DETAILS:
- Policy Number: ${data.policyNumber}
- Claim Number: ${data.claimNumber}
- Date of Loss: ${data.dateOfLoss}

SITUATION:
${data.situationDetails}

DEPENDENT PROPERTY LOSSES:
[Document dependency on damaged supplier/customer properties]

I request coverage for all losses due to dependent property damage as they are covered under my policy.

Sincerely,
${data.claimantName}`;
            }

            generateExtendedIndemnity(data) {
                return `[Your Name]
${data.claimantAddress}

[Date]

[Insurance Company Name]
${data.insurerName}
[Insurance Company Address]

Re: Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

Dear Claims Department,

I am requesting extended business interruption coverage due to extended restoration period.

CLAIM DETAILS:
- Policy Number: ${data.policyNumber}
- Claim Number: ${data.claimNumber}
- Date of Loss: ${data.dateOfLoss}

SITUATION:
${data.situationDetails}

EXTENDED INDEMNITY REQUEST:
[Document extended restoration period and market conditions]

I request extended business interruption coverage as the restoration period exceeds initial estimates.

Sincerely,
${data.claimantName}`;
            }

            generateContingentBusiness(data) {
                return `[Your Name]
${data.claimantAddress}

[Date]

[Insurance Company Name]
${data.insurerName}
[Insurance Company Address]

Re: Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

Dear Claims Department,

I am requesting coverage for contingent business income losses due to supplier/customer damage.

CLAIM DETAILS:
- Policy Number: ${data.policyNumber}
- Claim Number: ${data.claimNumber}
- Date of Loss: ${data.dateOfLoss}

SITUATION:
${data.situationDetails}

CONTINGENT BUSINESS LOSSES:
[Document losses due to supplier/customer damage]

I request coverage for all contingent business income losses as they are covered under my policy.

Sincerely,
${data.claimantName}`;
            }

            // Catastrophe/Disaster Templates
            generateHurricaneDamage(data) {
                return `[Your Name]
${data.claimantAddress}

[Date]

[Insurance Company Name]
${data.insurerName}
[Insurance Company Address]

Re: Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

Dear Claims Department,

I am submitting documentation for hurricane damage to my property.

CLAIM DETAILS:
- Policy Number: ${data.policyNumber}
- Claim Number: ${data.claimNumber}
- Date of Loss: ${data.dateOfLoss}

SITUATION:
${data.situationDetails}

HURRICANE DAMAGE:
[Document all hurricane damage and separate wind vs flood damage]

I request coverage for all hurricane damage as it is covered under my policy.

Sincerely,
${data.claimantName}`;
            }

            generateFloodCoverage(data) {
                return `[Your Name]
${data.claimantAddress}

[Date]

[Insurance Company Name]
${data.insurerName}
[Insurance Company Address]

Re: Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

Dear Claims Department,

I am requesting coverage analysis for flood damage and documentation of flood vs wind damage.

CLAIM DETAILS:
- Policy Number: ${data.policyNumber}
- Claim Number: ${data.claimNumber}
- Date of Loss: ${data.dateOfLoss}

SITUATION:
${data.situationDetails}

FLOOD COVERAGE ANALYSIS:
[Analyze flood coverage and document flood vs wind damage]

I request coverage analysis to determine applicable coverage for all damage.

Sincerely,
${data.claimantName}`;
            }

            generateWildfireDamage(data) {
                return `[Your Name]
${data.claimantAddress}

[Date]

[Insurance Company Name]
${data.insurerName}
[Insurance Company Address]

Re: Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

Dear Claims Department,

I am submitting documentation for wildfire damage to my property.

CLAIM DETAILS:
- Policy Number: ${data.policyNumber}
- Claim Number: ${data.claimNumber}
- Date of Loss: ${data.dateOfLoss}

SITUATION:
${data.situationDetails}

WILDFIRE DAMAGE:
[Document all wildfire damage and separate smoke vs fire damage]

I request coverage for all wildfire damage as it is covered under my policy.

Sincerely,
${data.claimantName}`;
            }

            generateEarthquakeDamage(data) {
                return `[Your Name]
${data.claimantAddress}

[Date]

[Insurance Company Name]
${data.insurerName}
[Insurance Company Address]

Re: Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

Dear Claims Department,

I am submitting documentation for earthquake damage to my property.

CLAIM DETAILS:
- Policy Number: ${data.policyNumber}
- Claim Number: ${data.claimNumber}
- Date of Loss: ${data.dateOfLoss}

SITUATION:
${data.situationDetails}

EARTHQUAKE DAMAGE:
[Document all earthquake damage and structural damage]

I request coverage for all earthquake damage as it is covered under my policy.

Sincerely,
${data.claimantName}`;
            }

            generateTornadoDamage(data) {
                return `[Your Name]
${data.claimantAddress}

[Date]

[Insurance Company Name]
${data.insurerName}
[Insurance Company Address]

Re: Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

Dear Claims Department,

I am submitting documentation for tornado damage to my property.

CLAIM DETAILS:
- Policy Number: ${data.policyNumber}
- Claim Number: ${data.claimNumber}
- Date of Loss: ${data.dateOfLoss}

SITUATION:
${data.situationDetails}

TORNADO DAMAGE:
[Document all tornado damage and wind damage]

I request coverage for all tornado damage as it is covered under my policy.

Sincerely,
${data.claimantName}`;
            }

            generateHailDamage(data) {
                return `[Your Name]
${data.claimantAddress}

[Date]

[Insurance Company Name]
${data.insurerName}
[Insurance Company Address]

Re: Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

Dear Claims Department,

I am submitting documentation for hail damage to my property.

CLAIM DETAILS:
- Policy Number: ${data.policyNumber}
- Claim Number: ${data.claimNumber}
- Date of Loss: ${data.dateOfLoss}

SITUATION:
${data.situationDetails}

HAIL DAMAGE:
[Document all hail damage with weather reports]

I request coverage for all hail damage as it is covered under my policy.

Sincerely,
${data.claimantName}`;
            }

            generateLightningDamage(data) {
                return `[Your Name]
${data.claimantAddress}

[Date]

[Insurance Company Name]
${data.insurerName}
[Insurance Company Address]

Re: Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

Dear Claims Department,

I am submitting documentation for lightning damage to my property.

CLAIM DETAILS:
- Policy Number: ${data.policyNumber}
- Claim Number: ${data.claimNumber}
- Date of Loss: ${data.dateOfLoss}

SITUATION:
${data.situationDetails}

LIGHTNING DAMAGE:
[Document all lightning damage and electrical damage]

I request coverage for all lightning damage as it is covered under my policy.

Sincerely,
${data.claimantName}`;
            }

            generateDebrisRemoval(data) {
                return `[Your Name]
${data.claimantAddress}

[Date]

[Insurance Company Name]
${data.insurerName}
[Insurance Company Address]

Re: Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

Dear Claims Department,

I am submitting documentation for debris removal costs.

CLAIM DETAILS:
- Policy Number: ${data.policyNumber}
- Claim Number: ${data.claimNumber}
- Date of Loss: ${data.dateOfLoss}

SITUATION:
${data.situationDetails}

DEBRIS REMOVAL:
[Document all debris removal costs and necessity]

I request coverage for all debris removal costs as they are covered under my policy.

Sincerely,
${data.claimantName}`;
            }

            generateEmergencyRepair(data) {
                return `[Your Name]
${data.claimantAddress}

[Date]

[Insurance Company Name]
${data.insurerName}
[Insurance Company Address]

Re: Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

Dear Claims Department,

I am submitting documentation for emergency repairs to prevent further damage.

CLAIM DETAILS:
- Policy Number: ${data.policyNumber}
- Claim Number: ${data.claimNumber}
- Date of Loss: ${data.dateOfLoss}

SITUATION:
${data.situationDetails}

EMERGENCY REPAIRS:
[Document all emergency repairs and prevention measures]

I request coverage for all emergency repairs as they were necessary to prevent further damage.

Sincerely,
${data.claimantName}`;
            }

            // Additional template generators for all missing document types
            generateEmployeeWage(data) {
                return `[Your Name]
${data.claimantAddress}

[Date]

[Insurance Company Name]
${data.insurerName}
[Insurance Company Address]

Re: Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

Dear Claims Department,

I am submitting documentation for employee wage losses during business interruption.

CLAIM DETAILS:
- Policy Number: ${data.policyNumber}
- Claim Number: ${data.claimNumber}
- Date of Loss: ${data.dateOfLoss}

SITUATION:
${data.situationDetails}

EMPLOYEE WAGE LOSSES:
[Document all employee wage losses and payroll expenses]

I request coverage for all employee wage losses as they are directly caused by the covered loss.

Sincerely,
${data.claimantName}`;
            }

            generateLeaseObligation(data) {
                return `[Your Name]
${data.claimantAddress}

[Date]

[Insurance Company Name]
${data.insurerName}
[Insurance Company Address]

Re: Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

Dear Claims Department,

I am submitting documentation for lease obligations and rental expenses.

CLAIM DETAILS:
- Policy Number: ${data.policyNumber}
- Claim Number: ${data.claimNumber}
- Date of Loss: ${data.dateOfLoss}

SITUATION:
${data.situationDetails}

LEASE OBLIGATIONS:
[Document all lease obligations and rental expenses]

I request coverage for all lease obligations as they are necessary business expenses.

Sincerely,
${data.claimantName}`;
            }

            generateUtilityExpense(data) {
                return `[Your Name]
${data.claimantAddress}

[Date]

[Insurance Company Name]
${data.insurerName}
[Insurance Company Address]

Re: Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

Dear Claims Department,

I am submitting documentation for utility expenses and service interruptions.

CLAIM DETAILS:
- Policy Number: ${data.policyNumber}
- Claim Number: ${data.claimNumber}
- Date of Loss: ${data.dateOfLoss}

SITUATION:
${data.situationDetails}

UTILITY EXPENSES:
[Document all utility expenses and service interruptions]

I request coverage for all utility expenses as they are necessary business operations.

Sincerely,
${data.claimantName}`;
            }

            generateProfessionalServices(data) {
                return `[Your Name]
${data.claimantAddress}

[Date]

[Insurance Company Name]
${data.insurerName}
[Insurance Company Address]

Re: Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

Dear Claims Department,

I am submitting documentation for professional services and consulting expenses.

CLAIM DETAILS:
- Policy Number: ${data.policyNumber}
- Claim Number: ${data.claimNumber}
- Date of Loss: ${data.dateOfLoss}

SITUATION:
${data.situationDetails}

PROFESSIONAL SERVICES:
[Document all professional services and consulting expenses]

I request coverage for all professional services as they are necessary for business operations.

Sincerely,
${data.claimantName}`;
            }

            generateMarketingExpense(data) {
                return `[Your Name]
${data.claimantAddress}

[Date]

[Insurance Company Name]
${data.insurerName}
[Insurance Company Address]

Re: Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

Dear Claims Department,

I am submitting documentation for marketing expenses and promotional costs.

CLAIM DETAILS:
- Policy Number: ${data.policyNumber}
- Claim Number: ${data.claimNumber}
- Date of Loss: ${data.dateOfLoss}

SITUATION:
${data.situationDetails}

MARKETING EXPENSES:
[Document all marketing expenses and promotional costs]

I request coverage for all marketing expenses as they are necessary for business operations.

Sincerely,
${data.claimantName}`;
            }

            generateInventoryLoss(data) {
                return `[Your Name]
${data.claimantAddress}

[Date]

[Insurance Company Name]
${data.insurerName}
[Insurance Company Address]

Re: Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

Dear Claims Department,

I am submitting documentation for inventory losses and stock damages.

CLAIM DETAILS:
- Policy Number: ${data.policyNumber}
- Claim Number: ${data.claimNumber}
- Date of Loss: ${data.dateOfLoss}

SITUATION:
${data.situationDetails}

INVENTORY LOSSES:
[Document all inventory losses and stock damages]

I request coverage for all inventory losses as they are directly caused by the covered loss.

Sincerely,
${data.claimantName}`;
            }

            generateEquipmentRental(data) {
                return `[Your Name]
${data.claimantAddress}

[Date]

[Insurance Company Name]
${data.insurerName}
[Insurance Company Address]

Re: Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

Dear Claims Department,

I am submitting documentation for equipment rental costs and temporary replacements.

CLAIM DETAILS:
- Policy Number: ${data.policyNumber}
- Claim Number: ${data.claimNumber}
- Date of Loss: ${data.dateOfLoss}

SITUATION:
${data.situationDetails}

EQUIPMENT RENTAL:
[Document all equipment rental costs and temporary replacements]

I request coverage for all equipment rental costs as they are necessary for business operations.

Sincerely,
${data.claimantName}`;
            }

            generateRelocationExpense(data) {
                return `[Your Name]
${data.claimantAddress}

[Date]

[Insurance Company Name]
${data.insurerName}
[Insurance Company Address]

Re: Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

Dear Claims Department,

I am submitting documentation for relocation expenses and moving costs.

CLAIM DETAILS:
- Policy Number: ${data.policyNumber}
- Claim Number: ${data.claimNumber}
- Date of Loss: ${data.dateOfLoss}

SITUATION:
${data.situationDetails}

RELOCATION EXPENSES:
[Document all relocation expenses and moving costs]

I request coverage for all relocation expenses as they are necessary due to the covered loss.

Sincerely,
${data.claimantName}`;
            }

            generateContractLoss(data) {
                return `[Your Name]
${data.claimantAddress}

[Date]

[Insurance Company Name]
${data.insurerName}
[Insurance Company Address]

Re: Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

Dear Claims Department,

I am submitting documentation for contract losses and business interruption impacts.

CLAIM DETAILS:
- Policy Number: ${data.policyNumber}
- Claim Number: ${data.claimNumber}
- Date of Loss: ${data.dateOfLoss}

SITUATION:
${data.situationDetails}

CONTRACT LOSSES:
[Document all contract losses and business interruption impacts]

I request coverage for all contract losses as they are directly caused by the covered loss.

Sincerely,
${data.claimantName}`;
            }

            generateIceStormDamage(data) {
                return `[Your Name]
${data.claimantAddress}

[Date]

[Insurance Company Name]
${data.insurerName}
[Insurance Company Address]

Re: Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

Dear Claims Department,

I am submitting documentation for ice storm damage to my property.

CLAIM DETAILS:
- Policy Number: ${data.policyNumber}
- Claim Number: ${data.claimNumber}
- Date of Loss: ${data.dateOfLoss}

SITUATION:
${data.situationDetails}

ICE STORM DAMAGE:
[Document all ice storm damage and winter weather impacts]

I request coverage for all ice storm damage as it is covered under my policy.

Sincerely,
${data.claimantName}`;
            }

            generateBlizzardDamage(data) {
                return `[Your Name]
${data.claimantAddress}

[Date]

[Insurance Company Name]
${data.insurerName}
[Insurance Company Address]

Re: Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

Dear Claims Department,

I am submitting documentation for blizzard damage to my property.

CLAIM DETAILS:
- Policy Number: ${data.policyNumber}
- Claim Number: ${data.claimNumber}
- Date of Loss: ${data.dateOfLoss}

SITUATION:
${data.situationDetails}

BLIZZARD DAMAGE:
[Document all blizzard damage and severe winter weather]

I request coverage for all blizzard damage as it is covered under my policy.

Sincerely,
${data.claimantName}`;
            }

            generateDroughtDamage(data) {
                return `[Your Name]
${data.claimantAddress}

[Date]

[Insurance Company Name]
${data.insurerName}
[Insurance Company Address]

Re: Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

Dear Claims Department,

I am submitting documentation for drought damage to my property.

CLAIM DETAILS:
- Policy Number: ${data.policyNumber}
- Claim Number: ${data.claimNumber}
- Date of Loss: ${data.dateOfLoss}

SITUATION:
${data.situationDetails}

DROUGHT DAMAGE:
[Document all drought damage and water shortage impacts]

I request coverage for all drought damage as it is covered under my policy.

Sincerely,
${data.claimantName}`;
            }

            generateHeatWaveDamage(data) {
                return `[Your Name]
${data.claimantAddress}

[Date]

[Insurance Company Name]
${data.insurerName}
[Insurance Company Address]

Re: Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

Dear Claims Department,

I am submitting documentation for heat wave damage to my property.

CLAIM DETAILS:
- Policy Number: ${data.policyNumber}
- Claim Number: ${data.claimNumber}
- Date of Loss: ${data.dateOfLoss}

SITUATION:
${data.situationDetails}

HEAT WAVE DAMAGE:
[Document all heat wave damage and extreme temperature impacts]

I request coverage for all heat wave damage as it is covered under my policy.

Sincerely,
${data.claimantName}`;
            }

            generateSevereStormDamage(data) {
                return `[Your Name]
${data.claimantAddress}

[Date]

[Insurance Company Name]
${data.insurerName}
[Insurance Company Address]

Re: Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

Dear Claims Department,

I am submitting documentation for severe storm damage to my property.

CLAIM DETAILS:
- Policy Number: ${data.policyNumber}
- Claim Number: ${data.claimNumber}
- Date of Loss: ${data.dateOfLoss}

SITUATION:
${data.situationDetails}

SEVERE STORM DAMAGE:
[Document all severe storm damage and weather impacts]

I request coverage for all severe storm damage as it is covered under my policy.

Sincerely,
${data.claimantName}`;
            }

            generatePowerOutageDamage(data) {
                return `[Your Name]
${data.claimantAddress}

[Date]

[Insurance Company Name]
${data.insurerName}
[Insurance Company Address]

Re: Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

Dear Claims Department,

I am submitting documentation for power outage damage to my property.

CLAIM DETAILS:
- Policy Number: ${data.policyNumber}
- Claim Number: ${data.claimNumber}
- Date of Loss: ${data.dateOfLoss}

SITUATION:
${data.situationDetails}

POWER OUTAGE DAMAGE:
[Document all power outage damage and electrical service impacts]

I request coverage for all power outage damage as it is covered under my policy.

Sincerely,
${data.claimantName}`;
            }

            generateStormWaterDamage(data) {
                return `[Your Name]
${data.claimantAddress}

[Date]

[Insurance Company Name]
${data.insurerName}
[Insurance Company Address]

Re: Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

Dear Claims Department,

I am submitting documentation for storm water damage to my property.

CLAIM DETAILS:
- Policy Number: ${data.policyNumber}
- Claim Number: ${data.claimNumber}
- Date of Loss: ${data.dateOfLoss}

SITUATION:
${data.situationDetails}

STORM WATER DAMAGE:
[Document all storm water damage and flooding impacts]

I request coverage for all storm water damage as it is covered under my policy.

Sincerely,
${data.claimantName}`;
            }

            // New document template generators
            generateProofOfLoss(data) {
                return `${data.claimantName}
${data.claimantAddress}

[Date]

[Insurance Company Name]
${data.insurerName}
[Insurance Company Address]

Re: Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

PROOF OF LOSS

I, ${data.claimantName}, being duly sworn, depose and say:

1. I am the named insured under Policy Number ${data.policyNumber}
2. The loss occurred on ${data.dateOfLoss}
3. The loss was caused by [specify cause]
4. The total amount of loss is $[amount]

DAMAGE DETAILS:
${data.situationDetails}

I declare under penalty of perjury that the foregoing is true and correct.

Sincerely,
${data.claimantName}`;
            }

            generateDamageInventory(data) {
                return `DAMAGE INVENTORY
Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

ITEMIZED DAMAGES:

${data.situationDetails}

[Add detailed line items with descriptions, quantities, and values]

Total Estimated Loss: $[amount]

Prepared by: ${data.claimantName}
Date: ${new Date().toLocaleDateString()}`;
            }

            generateClaimTimeline(data) {
                return `CLAIM TIMELINE / DIARY
Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

CHRONOLOGICAL LOG:

${data.situationDetails}

[Add timeline entries with dates and descriptions]

Prepared by: ${data.claimantName}
Date: ${new Date().toLocaleDateString()}`;
            }

            generateRepairReplace(data) {
                return `REPAIR vs REPLACE ANALYSIS
Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

COST COMPARISON WORKSHEET:

${data.situationDetails}

[Add detailed cost breakdowns for repair vs replacement options]

Prepared by: ${data.claimantName}
Date: ${new Date().toLocaleDateString()}`;
            }

            generateOutOfPocket(data) {
                return `OUT-OF-POCKET EXPENSE LOG
Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

EXPENSE TRACKING:

${data.situationDetails}

[Add detailed expense entries with dates, descriptions, and amounts]

Total Out-of-Pocket Expenses: $[amount]

Prepared by: ${data.claimantName}
Date: ${new Date().toLocaleDateString()}`;
            }

            generateAppraisalDemand(data) {
                return `${data.claimantName}
${data.claimantAddress}

[Date]

[Insurance Company Name]
${data.insurerName}
[Insurance Company Address]

Re: Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

APPRAISAL DEMAND

Dear Claims Department,

I am invoking the appraisal clause of my policy due to disagreement over the amount of loss.

CLAIM DETAILS:
- Policy Number: ${data.policyNumber}
- Claim Number: ${data.claimNumber}
- Date of Loss: ${data.dateOfLoss}

SITUATION:
${data.situationDetails}

I demand that you appoint an appraiser within 20 days as required by the policy.

Sincerely,
${data.claimantName}`;
            }

            generateNoticeOfClaim(data) {
                return `${data.claimantName}
${data.claimantAddress}

[Date]

[Insurance Company Name]
${data.insurerName}
[Insurance Company Address]

NOTICE OF CLAIM

Dear Claims Department,

I am providing notice of a loss under my policy.

CLAIM DETAILS:
- Policy Number: ${data.policyNumber}
- Date of Loss: ${data.dateOfLoss}
- Location: ${data.claimantAddress}

LOSS DESCRIPTION:
${data.situationDetails}

I request immediate processing of this claim.

Sincerely,
${data.claimantName}`;
            }

            generateROMEstimate(data) {
                return `ROM ESTIMATE REPORT
Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

HIGH-LEVEL COST RANGE:

${data.situationDetails}

[Add detailed cost breakdowns and estimates]

Estimated Total Loss: $[amount]

Prepared by: ${data.claimantName}
Date: ${new Date().toLocaleDateString()}`;
            }

            generatePhotographLog(data) {
                return `PHOTOGRAPH LOG
Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

PHOTO DOCUMENTATION:

${data.situationDetails}

[Add photo entries with captions and descriptions]

Prepared by: ${data.claimantName}
Date: ${new Date().toLocaleDateString()}`;
            }

            generateDocumentIndex(data) {
                return `DOCUMENT INDEX
Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

CLAIM DOCUMENTS:

${data.situationDetails}

[Auto-generated list of all claim documents]

Prepared by: ${data.claimantName}
Date: ${new Date().toLocaleDateString()}`;
            }

            generateComparativeEstimates(data) {
                return `COMPARATIVE ESTIMATES
Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

SIDE-BY-SIDE COMPARISON:

${data.situationDetails}

[Add detailed comparison of multiple estimates]

Prepared by: ${data.claimantName}
Date: ${new Date().toLocaleDateString()}`;
            }

            generateSettlementSheet(data) {
                return `SETTLEMENT SHEET
Policy Number: ${data.policyNumber}
Claim Number: ${data.claimNumber}
Date of Loss: ${data.dateOfLoss}

OFFER vs VALUE ANALYSIS:

${data.situationDetails}

[Add detailed comparison of offer vs actual value]

Prepared by: ${data.claimantName}
Date: ${new Date().toLocaleDateString()}`;
            }

            displayResults(content) {
                const resultContainer = document.getElementById('resultContainer');
                const resultContent = document.getElementById('resultContent');
                
                resultContent.textContent = content;
                resultContainer.classList.add('show');
                
                // Scroll to results
                resultContainer.scrollIntoView({ behavior: 'smooth' });
            }

            setupDownloadButtons() {
                const copyBtn = document.getElementById('copyTextBtn');
                const downloadPdfBtn = document.getElementById('downloadPdfBtn');
                
                copyBtn.addEventListener('click', () => {
                    navigator.clipboard.writeText(this.generatedContent).then(() => {
                        copyBtn.textContent = '‚úì Copied!';
                        setTimeout(() => {
                            copyBtn.textContent = 'üìã Copy Text';
                        }, 2000);
                    });
                });
                
                downloadPdfBtn.addEventListener('click', () => {
                    this.generatePDF();
                });
            }

            generatePDF() {
                if (!this.generatedContent) {
                    alert('No document content to download. Please generate a document first.');
                    return;
                }

                try {
                    const { jsPDF } = window.jspdf;
                    const doc = new jsPDF();
                    
                    // Set up the document
                    doc.setFontSize(12);
                    doc.setFont('helvetica');
                    
                    // Split content into lines that fit the page width
                    const pageWidth = doc.internal.pageSize.getWidth();
                    const margin = 20;
                    const maxWidth = pageWidth - (margin * 2);
                    
                    // Split the content into lines
                    const lines = doc.splitTextToSize(this.generatedContent, maxWidth);
                    
                    let yPosition = 20;
                    const lineHeight = 7;
                    const pageHeight = doc.internal.pageSize.getHeight();
                    
                    // Add each line to the PDF
                    for (let i = 0; i < lines.length; i++) {
                        // Check if we need a new page
                        if (yPosition + lineHeight > pageHeight - 20) {
                            doc.addPage();
                            yPosition = 20;
                        }
                        
                        doc.text(lines[i], margin, yPosition);
                        yPosition += lineHeight;
                    }
                    
                    // Generate filename based on document type and date
                    const now = new Date();
                    const dateStr = now.toISOString().split('T')[0];
                    const filename = `claim-document-${this.selectedType}-${dateStr}.pdf`;
                    
                    // Download the PDF
                    doc.save(filename);
                    
                } catch (error) {
                    console.error('PDF Generation Error:', error);
                    alert('Failed to generate PDF. Please try again.');
                }
            }

            showError(message) {
                const errorDiv = document.createElement('div');
                errorDiv.className = 'error-message';
                errorDiv.textContent = message;
                
                const container = document.querySelector('.document-generator');
                container.insertBefore(errorDiv, container.firstChild);
                
                setTimeout(() => {
                    errorDiv.remove();
                }, 5000);
            }
        }

        // Initialize the document generator when the page loads
        document.addEventListener('DOMContentLoaded', () => {
            new DocumentGenerator();
        });
    </script>
</body>
</html>