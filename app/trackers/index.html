<!doctype html><html lang="en"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>üó∫Ô∏è Trackers & Timeline</title><link rel="stylesheet" href="/app/assets/css/style.css"/></head><body>
<header class="header"><div class="bar container"><div class="brand"><div class="logo"></div><div>Trackers & Timeline</div></div>
<nav class="nav"><a href="/app/response-center.html">‚Üê Resource Center</a></nav></div></header>
<main class="container" id="main">
  <div class="card"><h2>Claim Stage Tracker</h2>
    <div id="board" class="grid" style="grid-template-columns:repeat(4,1fr)">
      <div class="card" data-col="intake"><h3>Intake</h3><div class="col"></div></div>
      <div class="card" data-col="investigation"><h3>Investigation</h3><div class="col"></div></div>
      <div class="card" data-col="evaluation"><h3>Evaluation</h3><div class="col"></div></div>
      <div class="card" data-col="resolution"><h3>Resolution</h3><div class="col"></div></div>
    </div>
    <div style="margin-top:8px" class="grid" style="grid-template-columns:1fr 120px">
      <input id="task" placeholder="Add step (e.g., Schedule inspection)"/>
      <button class="btn" id="add">Add</button>
    </div>
  </div>
  <div class="card"><h2>Claim Diary</h2>
    <div class="grid" style="grid-template-columns:repeat(auto-fit,minmax(220px,1fr))">
      <label>Date <input id="d_date" placeholder="YYYY-MM-DD"/></label>
      <label>Actor <input id="d_actor" placeholder="Adjuster/Contractor/You"/></label>
      <label>Event <input id="d_event" placeholder="Call/Email/Inspection"/></label>
    </div>
    <label style="display:block;margin-top:8px">Notes<textarea id="d_notes"></textarea></label>
    <div style="margin-top:8px"><button class="btn" id="d_add">Add Entry</button></div>
    <table id="diary" style="margin-top:10px"><thead><tr><th>Date</th><th>Actor</th><th>Event</th><th>Notes</th></tr></thead><tbody></tbody></table>
  </div>
</main>
<script type="module">
  import {qs,on} from '/app/assets/js/ui-helpers.js';
  const KEY='rc_board', DKEY='rc_diary';
  const state = JSON.parse(localStorage.getItem(KEY)||'{"intake":[],"investigation":[],"evaluation":[],"resolution":[]}');
  function paint(){ document.querySelectorAll('#board [data-col]').forEach(col=>{ const key=col.getAttribute('data-col'); const host=col.querySelector('.col'); host.innerHTML = state[key].map((t,i)=>`<div class="card" draggable="true" data-i="${i}">${t}</div>`).join(''); }); }
  paint();
  on(qs('#add'),'click',()=>{ const t=qs('#task').value.trim(); if(!t) return; state.intake.push(t); localStorage.setItem(KEY,JSON.stringify(state)); qs('#task').value=''; paint(); });
  // simple drag/drop
  document.addEventListener('dragstart',e=>{ if(e.target.matches('[draggable]')) e.dataTransfer.setData('text/plain', e.target.dataset.i); });
  document.querySelectorAll('#board [data-col]').forEach(col=>{
    col.addEventListener('dragover',e=>e.preventDefault());
    col.addEventListener('drop',e=>{ e.preventDefault(); const i=e.dataTransfer.getData('text/plain'); const from=[...document.querySelectorAll('#board .col')].find(c=>c.contains(document.querySelector('[draggable][data-i="'+i+'"]')))?.parentElement.getAttribute('data-col');
      const txt = state[from][i]; state[from].splice(i,1); state[col.getAttribute('data-col')].push(txt); localStorage.setItem(KEY,JSON.stringify(state)); paint(); });
  });
  // diary
  const diary = JSON.parse(localStorage.getItem(DKEY)||'[]'); function paintDiary(){ qs('#diary tbody').innerHTML = diary.map(r=>`<tr><td>${r.date}</td><td>${r.actor}</td><td>${r.event}</td><td>${r.notes}</td></tr>`).join(''); }
  paintDiary();
  on(qs('#d_add'),'click',()=>{ diary.push({date:qs('#d_date').value,actor:qs('#d_actor').value,event:qs('#d_event').value,notes:qs('#d_notes').value}); localStorage.setItem(DKEY,JSON.stringify(diary)); paintDiary(); });
</script>
<script type="module" src="/app/assets/js/diagnostics.js"></script></body></html>