<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Claim Stage Tracker - ClaimNavigatorAI</title>
  <meta name="description" content="Track your insurance claim progress through each stage with AI-powered guidance and next-step advice.">
  <style>
    :root {
      --primary: #1e40af;
      --accent: #3b82f6;
      --success: #10b981;
      --warning: #f59e0b;
      --danger: #ef4444;
      --border: #e5e7eb;
      --text-secondary: #6b7280;
      --bg-light: #f9fafb;
    }
    
    body { 
      font-family: Arial, sans-serif; 
      margin: 0; 
      padding: 0; 
      background: #fff; 
      line-height: 1.6;
    }
    
    header { 
      background: #0f172a; 
      padding: 1rem; 
      color: #fff; 
      position: sticky; 
      top: 0; 
      z-index: 100;
    }
    
    nav { 
      display: flex; 
      justify-content: space-between; 
      align-items: center; 
      max-width: 1200px;
      margin: 0 auto;
    }
    
    .logo { 
      margin-right: 2rem; 
      font-weight: bold;
      font-size: 1.2rem;
    }
    
    .nav-links { 
      display: flex; 
      gap: 1rem; 
    }
    
    .nav-links a { 
      color: #fff; 
      text-decoration: none; 
      padding: 0.5rem 1rem;
      border-radius: 0.5rem;
      transition: background 0.2s;
    }
    
    .nav-links a:hover { 
      background: rgba(255,255,255,0.1);
    }
    
    .main-content { 
      max-width: 1200px;
      margin: 0 auto;
      padding: 2rem; 
    }
    
    .page-header {
      text-align: center;
      margin-bottom: 3rem;
    }
    
    .page-header h1 {
      color: var(--primary);
      font-size: 2.5rem;
      margin-bottom: 1rem;
    }
    
    .page-header p {
      color: var(--text-secondary);
      font-size: 1.1rem;
      max-width: 600px;
      margin: 0 auto;
    }
    
    /* Language Toggle */
    .language-toggle {
      display: flex;
      justify-content: center;
      margin-bottom: 2rem;
    }
    
    .lang-btn {
      background: #f3f4f6;
      border: 2px solid var(--border);
      color: var(--text-secondary);
      padding: 0.5rem 1rem;
      border-radius: 0.5rem;
      cursor: pointer;
      transition: all 0.2s;
      font-weight: 500;
    }
    
    .lang-btn.active {
      background: var(--primary);
      color: white;
      border-color: var(--primary);
    }
    
    .lang-btn:first-child {
      border-top-right-radius: 0;
      border-bottom-right-radius: 0;
    }
    
    .lang-btn:last-child {
      border-top-left-radius: 0;
      border-bottom-left-radius: 0;
    }
    
    /* Progress Tracker */
    .progress-container {
      background: white;
      border-radius: 1rem;
      padding: 2rem;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      margin-bottom: 2rem;
    }
    
    .progress-header {
      text-align: center;
      margin-bottom: 2rem;
    }
    
    .progress-header h2 {
      color: var(--primary);
      margin-bottom: 0.5rem;
    }
    
    .progress-bar {
      width: 100%;
      height: 8px;
      background: #e5e7eb;
      border-radius: 4px;
      overflow: hidden;
      margin-bottom: 2rem;
    }
    
    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--primary), var(--accent));
      border-radius: 4px;
      transition: width 0.5s ease;
      width: 0%;
    }
    
    /* Stage Cards */
    .stages-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 1.5rem;
      margin-bottom: 2rem;
    }
    
    .stage-card {
      background: white;
      border: 2px solid var(--border);
      border-radius: 1rem;
      padding: 1.5rem;
      position: relative;
      transition: all 0.3s ease;
      cursor: pointer;
    }
    
    .stage-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
    }
    
    .stage-card.not-started {
      border-color: #e5e7eb;
      background: #f9fafb;
    }
    
    .stage-card.in-progress {
      border-color: var(--warning);
      background: #fffbeb;
    }
    
    .stage-card.completed {
      border-color: var(--success);
      background: #f0fdf4;
    }
    
    .stage-header {
      display: flex;
      align-items: center;
      gap: 1rem;
      margin-bottom: 1rem;
    }
    
    .stage-number {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      color: white;
      font-size: 1.1rem;
    }
    
    .stage-number.not-started {
      background: #9ca3af;
    }
    
    .stage-number.in-progress {
      background: var(--warning);
    }
    
    .stage-number.completed {
      background: var(--success);
    }
    
    .stage-title {
      font-size: 1.2rem;
      font-weight: 600;
      color: var(--primary);
      flex: 1;
    }
    
    .stage-status {
      padding: 0.25rem 0.75rem;
      border-radius: 1rem;
      font-size: 0.8rem;
      font-weight: 500;
      text-transform: uppercase;
    }
    
    .stage-status.not-started {
      background: #f3f4f6;
      color: #6b7280;
    }
    
    .stage-status.in-progress {
      background: #fef3c7;
      color: #92400e;
    }
    
    .stage-status.completed {
      background: #d1fae5;
      color: #065f46;
    }
    
    .stage-description {
      color: var(--text-secondary);
      margin-bottom: 1rem;
      line-height: 1.5;
    }
    
    .stage-actions {
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
    }
    
    .btn {
      padding: 0.5rem 1rem;
      border: none;
      border-radius: 0.5rem;
      cursor: pointer;
      font-weight: 500;
      transition: all 0.2s;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .btn-primary {
      background: var(--primary);
      color: white;
    }
    
    .btn-primary:hover {
      background: var(--accent);
    }
    
    .btn-secondary {
      background: var(--accent);
      color: white;
    }
    
    .btn-secondary:hover {
      background: var(--primary);
    }
    
    .btn-success {
      background: var(--success);
      color: white;
    }
    
    .btn-success:hover {
      background: #059669;
    }
    
    /* AI Advice Section */
    .advice-container {
      background: white;
      border-radius: 1rem;
      padding: 2rem;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      margin-bottom: 2rem;
    }
    
    .advice-header {
      display: flex;
      align-items: center;
      gap: 1rem;
      margin-bottom: 1.5rem;
    }
    
    .advice-icon {
      width: 40px;
      height: 40px;
      background: linear-gradient(135deg, var(--primary), var(--accent));
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 1.2rem;
    }
    
    .advice-title {
      font-size: 1.3rem;
      font-weight: 600;
      color: var(--primary);
    }
    
    .advice-content {
      background: #f8fafc;
      border-radius: 0.5rem;
      padding: 1.5rem;
      border-left: 4px solid var(--primary);
    }
    
    .advice-content h3 {
      color: var(--primary);
      margin-bottom: 1rem;
    }
    
    .advice-content ul {
      margin: 0;
      padding-left: 1.5rem;
    }
    
    .advice-content li {
      margin-bottom: 0.5rem;
      color: #374151;
    }
    
    /* Loading States */
    .loading {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 2rem;
    }
    
    .spinner {
      border: 3px solid #f3f3f3;
      border-top: 3px solid var(--primary);
      border-radius: 50%;
      width: 24px;
      height: 24px;
      animation: spin 1s linear infinite;
      margin-right: 1rem;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    /* Mobile Responsive */
    @media (max-width: 768px) {
      .main-content {
        padding: 1rem;
      }
      
      .page-header h1 {
        font-size: 2rem;
      }
      
      .stages-container {
        grid-template-columns: 1fr;
      }
      
      .stage-card {
        padding: 1rem;
      }
      
      .stage-actions {
        flex-direction: column;
      }
      
      .btn {
        justify-content: center;
      }
    }
    
    /* Claim Type Selector */
    .claim-type-selector {
      background: white;
      border-radius: 1rem;
      padding: 2rem;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      margin-bottom: 2rem;
    }
    
    .claim-type-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
      margin-top: 1rem;
    }
    
    .claim-type-btn {
      background: #f8fafc;
      border: 2px solid var(--border);
      border-radius: 0.5rem;
      padding: 1rem;
      cursor: pointer;
      transition: all 0.2s;
      text-align: center;
      font-weight: 500;
    }
    
    .claim-type-btn:hover {
      border-color: var(--primary);
      background: #f0f9ff;
    }
    
    .claim-type-btn.selected {
      border-color: var(--primary);
      background: var(--primary);
      color: white;
    }
  </style>
</head>
<body>
  <header>
    <nav>
      <div class="logo">ClaimNavigatorAI</div>
      <div class="nav-links">
        <a href="/">Home</a>
        <a href="/app/response-center.html">Response Center</a>
        <a href="/app/stage-tracker.html">Stage Tracker</a>
        <a href="/solution-center.html">Solution Center</a>
      </div>
    </nav>
  </header>

  <div class="main-content">
    <div class="page-header">
      <h1>Claim Stage Tracker</h1>
      <p>Track your insurance claim progress through each stage with AI-powered guidance and personalized next-step advice.</p>
    </div>

    <!-- Language Toggle -->
    <div class="language-toggle">
      <button class="lang-btn active" onclick="setLanguage('en')">English</button>
      <button class="lang-btn" onclick="setLanguage('es')">Espa침ol</button>
    </div>

    <!-- Claim Type Selector -->
    <div class="claim-type-selector">
      <h2 data-i18n="claimTypeTitle">Select Your Claim Type</h2>
      <p data-i18n="claimTypeDesc">Choose the type of insurance claim you're tracking to get personalized advice.</p>
      <div class="claim-type-grid">
        <button class="claim-type-btn" onclick="selectClaimType('property')" data-i18n="propertyDamage">Property Damage</button>
        <button class="claim-type-btn" onclick="selectClaimType('auto')" data-i18n="autoAccident">Auto Accident</button>
        <button class="claim-type-btn" onclick="selectClaimType('health')" data-i18n="healthInsurance">Health Insurance</button>
        <button class="claim-type-btn" onclick="selectClaimType('business')" data-i18n="businessClaim">Business Claim</button>
      </div>
    </div>

    <!-- Progress Tracker -->
    <div class="progress-container">
      <div class="progress-header">
        <h2 data-i18n="progressTitle">Your Claim Progress</h2>
        <p data-i18n="progressDesc">Track your progress through each stage of the claims process.</p>
      </div>
      
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
      </div>

      <div class="stages-container">
        <!-- Stage 1: Filed -->
        <div class="stage-card not-started" data-stage="filed" onclick="toggleStage('filed')">
          <div class="stage-header">
            <div class="stage-number not-started">1</div>
            <div class="stage-title" data-i18n="stageFiled">Filed</div>
            <div class="stage-status not-started" data-i18n="notStarted">Not Started</div>
          </div>
          <div class="stage-description" data-i18n="stageFiledDesc">
            Initial claim submission with your insurance company.
          </div>
          <div class="stage-actions">
            <button class="btn btn-primary" onclick="getStageAdvice('filed')" data-i18n="getAdvice">Get AI Advice</button>
            <button class="btn btn-secondary" onclick="markStage('filed', 'in_progress')" data-i18n="markInProgress">Mark In Progress</button>
          </div>
        </div>

        <!-- Stage 2: Inspection -->
        <div class="stage-card not-started" data-stage="inspection" onclick="toggleStage('inspection')">
          <div class="stage-header">
            <div class="stage-number not-started">2</div>
            <div class="stage-title" data-i18n="stageInspection">Inspection</div>
            <div class="stage-status not-started" data-i18n="notStarted">Not Started</div>
          </div>
          <div class="stage-description" data-i18n="stageInspectionDesc">
            Insurance adjuster evaluates the damage and determines coverage.
          </div>
          <div class="stage-actions">
            <button class="btn btn-primary" onclick="getStageAdvice('inspection')" data-i18n="getAdvice">Get AI Advice</button>
            <button class="btn btn-secondary" onclick="markStage('inspection', 'in_progress')" data-i18n="markInProgress">Mark In Progress</button>
          </div>
        </div>

        <!-- Stage 3: Offer -->
        <div class="stage-card not-started" data-stage="offer" onclick="toggleStage('offer')">
          <div class="stage-header">
            <div class="stage-number not-started">3</div>
            <div class="stage-title" data-i18n="stageOffer">Offer</div>
            <div class="stage-status not-started" data-i18n="notStarted">Not Started</div>
          </div>
          <div class="stage-description" data-i18n="stageOfferDesc">
            Insurance company presents their settlement offer.
          </div>
          <div class="stage-actions">
            <button class="btn btn-primary" onclick="getStageAdvice('offer')" data-i18n="getAdvice">Get AI Advice</button>
            <button class="btn btn-secondary" onclick="markStage('offer', 'in_progress')" data-i18n="markInProgress">Mark In Progress</button>
          </div>
        </div>

        <!-- Stage 4: Appeal -->
        <div class="stage-card not-started" data-stage="appeal" onclick="toggleStage('appeal')">
          <div class="stage-header">
            <div class="stage-number not-started">4</div>
            <div class="stage-title" data-i18n="stageAppeal">Appeal</div>
            <div class="stage-status not-started" data-i18n="notStarted">Not Started</div>
          </div>
          <div class="stage-description" data-i18n="stageAppealDesc">
            Challenge the insurance company's decision if needed.
          </div>
          <div class="stage-actions">
            <button class="btn btn-primary" onclick="getStageAdvice('appeal')" data-i18n="getAdvice">Get AI Advice</button>
            <button class="btn btn-secondary" onclick="markStage('appeal', 'in_progress')" data-i18n="markInProgress">Mark In Progress</button>
          </div>
        </div>

        <!-- Stage 5: Settlement -->
        <div class="stage-card not-started" data-stage="settlement" onclick="toggleStage('settlement')">
          <div class="stage-header">
            <div class="stage-number not-started">5</div>
            <div class="stage-title" data-i18n="stageSettlement">Settlement</div>
            <div class="stage-status not-started" data-i18n="notStarted">Not Started</div>
          </div>
          <div class="stage-description" data-i18n="stageSettlementDesc">
            Final resolution and payment of your claim.
          </div>
          <div class="stage-actions">
            <button class="btn btn-primary" onclick="getStageAdvice('settlement')" data-i18n="getAdvice">Get AI Advice</button>
            <button class="btn btn-secondary" onclick="markStage('settlement', 'in_progress')" data-i18n="markInProgress">Mark In Progress</button>
          </div>
        </div>
      </div>
    </div>

    <!-- AI Advice Section -->
    <div class="advice-container" id="adviceContainer" style="display: none;">
      <div class="advice-header">
        <div class="advice-icon">游뱄</div>
        <div class="advice-title" data-i18n="aiAdviceTitle">AI-Powered Stage Advice</div>
      </div>
      <div class="advice-content" id="adviceContent">
        <!-- AI advice will be loaded here -->
      </div>
    </div>
  </div>

  <script>
    // Global variables
    let currentLanguage = 'en';
    let selectedClaimType = null;
    let stageStatuses = {
      filed: 'not_started',
      inspection: 'not_started',
      offer: 'not_started',
      appeal: 'not_started',
      settlement: 'not_started'
    };

    // Language and localization
    const translations = {
      en: {
        claimTypeTitle: "Select Your Claim Type",
        claimTypeDesc: "Choose the type of insurance claim you're tracking to get personalized advice.",
        propertyDamage: "Property Damage",
        autoAccident: "Auto Accident",
        healthInsurance: "Health Insurance",
        businessClaim: "Business Claim",
        progressTitle: "Your Claim Progress",
        progressDesc: "Track your progress through each stage of the claims process.",
        notStarted: "Not Started",
        stageFiled: "Filed",
        stageFiledDesc: "Initial claim submission with your insurance company.",
        stageInspection: "Inspection",
        stageInspectionDesc: "Insurance adjuster evaluates the damage and determines coverage.",
        stageOffer: "Offer",
        stageOfferDesc: "Insurance company presents their settlement offer.",
        stageAppeal: "Appeal",
        stageAppealDesc: "Challenge the insurance company's decision if needed.",
        stageSettlement: "Settlement",
        stageSettlementDesc: "Final resolution and payment of your claim.",
        getAdvice: "Get AI Advice",
        markInProgress: "Mark In Progress",
        markCompleted: "Mark Completed",
        aiAdviceTitle: "AI-Powered Stage Advice",
        inProgress: "In Progress",
        completed: "Completed"
      },
      es: {
        claimTypeTitle: "Selecciona el Tipo de Reclamo",
        claimTypeDesc: "Elige el tipo de reclamo de seguro que est치s rastreando para obtener consejos personalizados.",
        propertyDamage: "Da침os a la Propiedad",
        autoAccident: "Accidente Automovil칤stico",
        healthInsurance: "Seguro de Salud",
        businessClaim: "Reclamo Comercial",
        progressTitle: "Progreso de tu Reclamo",
        progressDesc: "Rastrea tu progreso a trav칠s de cada etapa del proceso de reclamos.",
        notStarted: "No Iniciado",
        stageFiled: "Presentado",
        stageFiledDesc: "Presentaci칩n inicial del reclamo con tu compa침칤a de seguros.",
        stageInspection: "Inspecci칩n",
        stageInspectionDesc: "El ajustador de seguros eval칰a los da침os y determina la cobertura.",
        stageOffer: "Oferta",
        stageOfferDesc: "La compa침칤a de seguros presenta su oferta de liquidaci칩n.",
        stageAppeal: "Apelaci칩n",
        stageAppealDesc: "Impugnar la decisi칩n de la compa침칤a de seguros si es necesario.",
        stageSettlement: "Liquidaci칩n",
        stageSettlementDesc: "Resoluci칩n final y pago de tu reclamo.",
        getAdvice: "Obtener Consejo IA",
        markInProgress: "Marcar En Progreso",
        markCompleted: "Marcar Completado",
        aiAdviceTitle: "Consejo de Etapa con IA",
        inProgress: "En Progreso",
        completed: "Completado"
      }
    };

    // Set language
    function setLanguage(lang) {
      currentLanguage = lang;
      
      // Update language buttons
      document.querySelectorAll('.lang-btn').forEach(btn => {
        btn.classList.remove('active');
      });
      event.target.classList.add('active');
      
      // Update all text elements
      document.querySelectorAll('[data-i18n]').forEach(element => {
        const key = element.getAttribute('data-i18n');
        if (translations[lang] && translations[lang][key]) {
          element.textContent = translations[lang][key];
        }
      });
      
      // Save language preference
      localStorage.setItem('stageTrackerLang', lang);
    }

    // Select claim type
    function selectClaimType(type) {
      selectedClaimType = type;
      
      // Update claim type buttons
      document.querySelectorAll('.claim-type-btn').forEach(btn => {
        btn.classList.remove('selected');
      });
      event.target.classList.add('selected');
      
      // Save selection
      localStorage.setItem('stageTrackerClaimType', type);
    }

    // Toggle stage status
    function toggleStage(stage) {
      const card = document.querySelector(`[data-stage="${stage}"]`);
      const currentStatus = stageStatuses[stage];
      
      let newStatus;
      if (currentStatus === 'not_started') {
        newStatus = 'in_progress';
      } else if (currentStatus === 'in_progress') {
        newStatus = 'completed';
      } else {
        newStatus = 'not_started';
      }
      
      markStage(stage, newStatus);
    }

    // Mark stage status
    function markStage(stage, status) {
      stageStatuses[stage] = status;
      
      const card = document.querySelector(`[data-stage="${stage}"]`);
      const number = card.querySelector('.stage-number');
      const statusElement = card.querySelector('.stage-status');
      const actions = card.querySelector('.stage-actions');
      
      // Update card appearance
      card.className = `stage-card ${status}`;
      number.className = `stage-number ${status}`;
      statusElement.className = `stage-status ${status}`;
      
      // Update status text
      const statusText = status === 'not_started' ? 
        translations[currentLanguage].notStarted :
        status === 'in_progress' ? 
        translations[currentLanguage].inProgress :
        translations[currentLanguage].completed;
      statusElement.textContent = statusText;
      
      // Update action buttons
      if (status === 'completed') {
        actions.innerHTML = `
          <button class="btn btn-success" onclick="markStage('${stage}', 'not_started')" data-i18n="markInProgress">Reset Stage</button>
        `;
      } else if (status === 'in_progress') {
        actions.innerHTML = `
          <button class="btn btn-primary" onclick="getStageAdvice('${stage}')" data-i18n="getAdvice">Get AI Advice</button>
          <button class="btn btn-success" onclick="markStage('${stage}', 'completed')" data-i18n="markCompleted">Mark Completed</button>
        `;
      } else {
        actions.innerHTML = `
          <button class="btn btn-primary" onclick="getStageAdvice('${stage}')" data-i18n="getAdvice">Get AI Advice</button>
          <button class="btn btn-secondary" onclick="markStage('${stage}', 'in_progress')" data-i18n="markInProgress">Mark In Progress</button>
        `;
      }
      
      // Update progress bar
      updateProgressBar();
      
      // Save to localStorage
      localStorage.setItem('stageTrackerStatuses', JSON.stringify(stageStatuses));
    }

    // Update progress bar
    function updateProgressBar() {
      const completedStages = Object.values(stageStatuses).filter(status => status === 'completed').length;
      const totalStages = Object.keys(stageStatuses).length;
      const progressPercentage = (completedStages / totalStages) * 100;
      
      document.getElementById('progressFill').style.width = `${progressPercentage}%`;
    }

    // Get AI advice for stage
    async function getStageAdvice(stage) {
      if (!selectedClaimType) {
        alert(translations[currentLanguage].selectClaimType || 'Please select a claim type first.');
        return;
      }
      
      const adviceContainer = document.getElementById('adviceContainer');
      const adviceContent = document.getElementById('adviceContent');
      
      // Show loading state
      adviceContainer.style.display = 'block';
      adviceContent.innerHTML = `
        <div class="loading">
          <div class="spinner"></div>
          <span>${translations[currentLanguage].loading || 'Loading AI advice...'}</span>
        </div>
      `;
      
      try {
        const response = await fetch('/netlify/functions/getStageAdvice', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            stage: stage,
            claimType: selectedClaimType,
            language: currentLanguage
          })
        });
        
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const data = await response.json();
        
        if (data.success) {
          // Display AI advice
          adviceContent.innerHTML = `
            <div style="white-space: pre-wrap; line-height: 1.6;">
              ${data.advice}
            </div>
          `;
        } else {
          throw new Error(data.error || 'Failed to get advice');
        }
      } catch (error) {
        console.error('Error getting AI advice:', error);
        adviceContent.innerHTML = `
          <div >
            <h3>Error Loading AI Advice</h3>
            <p>${error.message}</p>
            <p>Please try again later or contact support if the problem persists.</p>
          </div>
        `;
      }
    }

    // Initialize page
    function initializePage() {
      // Load saved language
      const savedLang = localStorage.getItem('stageTrackerLang') || 'en';
      setLanguage(savedLang);
      
      // Load saved claim type
      const savedClaimType = localStorage.getItem('stageTrackerClaimType');
      if (savedClaimType) {
        selectedClaimType = savedClaimType;
        const claimTypeBtn = document.querySelector(`[onclick="selectClaimType('${savedClaimType}')"]`);
        if (claimTypeBtn) {
          claimTypeBtn.classList.add('selected');
        }
      }
      
      // Load saved stage statuses
      const savedStatuses = localStorage.getItem('stageTrackerStatuses');
      if (savedStatuses) {
        stageStatuses = JSON.parse(savedStatuses);
        
        // Update UI to reflect saved statuses
        Object.keys(stageStatuses).forEach(stage => {
          if (stageStatuses[stage] !== 'not_started') {
            markStage(stage, stageStatuses[stage]);
          }
        });
      }
      
      // Update progress bar
      updateProgressBar();
    }

    // Initialize when page loads
    document.addEventListener('DOMContentLoaded', initializePage);
  </script>
<script type="module" src="/app/assets/js/diagnostics.js"></script>
<script type="module" src="/app/assets/js/window-bridge.js"></script>
</body>
</html>
