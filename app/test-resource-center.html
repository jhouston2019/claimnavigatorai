<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resource Center Test</title>
    <link rel="stylesheet" href="/app/assets/css/style.css">
</head>
<body>
    <header>
        <nav>
            <div class="logo">Resource Center Test</div>
            <div class="nav-links">
                <a href="/app/index.html">‚Üê Back to Resource Center</a>
            </div>
        </nav>
    </header>

    <main class="main-container">
        <div class="text-center mb-4">
            <h1>Resource Center Test</h1>
            <p>Testing the AI functions to ensure they work properly.</p>
        </div>

        <div class="card">
            <h2>AI Response Test</h2>
            <textarea id="test-input" placeholder="Enter your test message here..." style="width: 100%; min-height: 100px; padding: 12px; border: 1px solid var(--border); border-radius: 10px; margin: 10px 0;"></textarea>
            <button id="test-ai" class="btn btn-solid">Test AI Response</button>
            <div id="ai-result" class="card" style="margin-top: 1rem; min-height: 100px;"></div>
        </div>

        <div class="card">
            <h2>Document Generation Test</h2>
            <button id="test-doc" class="btn btn-solid">Test Document Generation</button>
            <div id="doc-result" class="card" style="margin-top: 1rem; min-height: 100px;"></div>
        </div>

        <div class="card">
            <h2>Claim Analysis Test</h2>
            <textarea id="analysis-input" placeholder="Enter claim details for analysis..." style="width: 100%; min-height: 100px; padding: 12px; border: 1px solid var(--border); border-radius: 10px; margin: 10px 0;"></textarea>
            <button id="test-analysis" class="btn btn-solid">Test Claim Analysis</button>
            <div id="analysis-result" class="card" style="margin-top: 1rem; min-height: 100px;"></div>
        </div>
    </main>

    <script type="module">
        import { callAI, createDoc, analyzeClaim } from '/app/assets/js/api-client.js';
        import { qs, on } from '/app/assets/js/ui-helpers.js';

        // Test AI Response
        on(qs('#test-ai'), 'click', async () => {
            const input = qs('#test-input').value.trim();
            if (!input) return alert('Please enter some text first');
            
            qs('#ai-result').innerHTML = '<span class="spinner"></span> Testing AI response...';
            try {
                const result = await callAI(input, { type: 'claim_response' });
                qs('#ai-result').innerHTML = `<pre>${result.response || 'No response received'}</pre>`;
            } catch (error) {
                qs('#ai-result').innerHTML = `<div style="color: #dc2626;">Error: ${error.message}</div>`;
            }
        });

        // Test Document Generation
        on(qs('#test-doc'), 'click', async () => {
            qs('#doc-result').innerHTML = '<span class="spinner"></span> Testing document generation...';
            try {
                const result = await createDoc({
                    content: 'This is a test document content.',
                    format: 'pdf',
                    type: 'test',
                    filename: 'test-document'
                });
                qs('#doc-result').innerHTML = `<pre>${JSON.stringify(result, null, 2)}</pre>`;
            } catch (error) {
                qs('#doc-result').innerHTML = `<div style="color: #dc2626;">Error: ${error.message}</div>`;
            }
        });

        // Test Claim Analysis
        on(qs('#test-analysis'), 'click', async () => {
            const input = qs('#analysis-input').value.trim();
            if (!input) return alert('Please enter claim details first');
            
            qs('#analysis-result').innerHTML = '<span class="spinner"></span> Testing claim analysis...';
            try {
                const result = await analyzeClaim({
                    analysisType: 'damage_assessment',
                    text: input
                });
                qs('#analysis-result').innerHTML = `<pre>${result.analysis || result.assessment || 'No analysis received'}</pre>`;
            } catch (error) {
                qs('#analysis-result').innerHTML = `<div style="color: #dc2626;">Error: ${error.message}</div>`;
            }
        });
    </script>

    <script type="module" src="/app/assets/js/diagnostics.js"></script>
</body>
</html>
