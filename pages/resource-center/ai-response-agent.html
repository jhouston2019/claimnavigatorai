<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI Response Agent - ClaimNavigatorAI</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root {
      --primary: #1e40af;
      --accent: #3b82f6;
      --background: #f9fafb;
      --border: #e5e7eb;
      --text-dark: #0f172a;
    }

    body { font-family: 'Inter', sans-serif; background-color: var(--background); }
  </style>
</head>

<body class="min-h-screen">
  <!-- Header -->
  <header class="bg-[#0f172a] text-white p-4">
    <div class="max-w-6xl mx-auto flex justify-between items-center">
      <h1 class="text-lg font-semibold">ClaimNavigatorAI – Resource Center</h1>
      <a href="/pages/resource-center/index.html" class="text-sm underline hover:text-blue-300">← All Tools</a>
    </div>
  </header>

  <!-- Breadcrumb Navigation -->
  <nav class="text-sm text-gray-600 mt-6 mb-4 px-4">
    <a href="/pages/resource-center/index.html" class="hover:underline text-blue-600">Resource Center</a> ›
    <a href="/pages/resource-center/quick-start.html" class="hover:underline text-blue-600">Quick Start</a> ›
    <span class="text-gray-700 font-medium">AI Response Agent</span>
  </nav>

  <!-- Return Link -->
  <div class="text-right px-4 mb-6">
    <a href="/pages/resource-center/quick-start.html" class="text-sm text-blue-600 hover:underline">← Back to Quick Start Guide</a>
  </div>

  <!-- Context Banner -->
  <section class="rounded-xl p-4 mb-6 text-center border max-w-6xl mx-auto" 
           style="background: #eff6ff; border-color: #bfdbfe; color: #1e3a8a;">
    <p class="text-sm">
      This tool is part of the <strong>"My claim was just denied"</strong> Quick Start path.
    </p>
  </section>

  <!-- Main Content -->
  <main class="max-w-6xl mx-auto bg-white border border-gray-200 rounded-2xl p-8 shadow-sm mb-12">
    <div class="card">
      <h2>AI Response & Analysis Agent</h2>
    </div>
    
    <!-- Claim Information Form -->
    <div class="card">
      <h3>Claim Information</h3>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:12px">
        <input type="text" id="claimantName" placeholder="Your Name" />
        <input type="text" id="policyNumber" placeholder="Policy Number" />
        <input type="text" id="claimNumber" placeholder="Claim Number" />
        <input type="date" id="dateOfLoss" placeholder="Date of Loss" />
        <input type="text" id="insurerName" placeholder="Insurance Company" />
        <input type="tel" id="phoneNumber" placeholder="Phone Number" />
        <input type="email" id="email" placeholder="Email Address" />
        <input type="text" id="claimantAddress" placeholder="Your Address" />
      </div>
    </div>
    
    <div class="card">
      <h3>Paste Insurer Letter / Email</h3>
      <textarea id="input" placeholder="Paste the insurer message here…"></textarea>
      <div style="display:flex;gap:8px;margin-top:8px">
        <button class="btn btn-primary" id="analyze">Analyze & Draft Reply</button>
        <button class="btn" id="export">Export PDF</button>
      </div>
      <div id="out" class="card" style="margin-top:12px"></div>
    </div>
  </main>

  <!-- Footer -->
  <footer class="bg-[#0f172a] text-white p-6 mt-16">
    <div class="max-w-6xl mx-auto text-center">
      <p class="text-sm text-gray-300">
        © 2025 ClaimNavigatorAI. All rights reserved. |
        <a href="/privacy.html" class="underline hover:text-blue-300">Privacy Policy</a> |
        <a href="/terms.html" class="underline hover:text-blue-300">Terms of Service</a>
      </p>
    </div>
  </footer>

  <script type="module">
    import {qs,on} from '/app/assets/js/ui-helpers.js';
    import { callAI, createDoc } from '/app/assets/js/api-client.js';
    const seed=sessionStorage.getItem('ai_seed'); if(seed){ qs('#input').value=seed; sessionStorage.removeItem('ai_seed'); }
    on(qs('#analyze'),'click', async ()=>{
      const v=qs('#input').value.trim(); if(!v) return;
      
      // Collect claim information
      const claimInfo = {
        claimantName: qs('#claimantName').value.trim(),
        policyNumber: qs('#policyNumber').value.trim(),
        claimNumber: qs('#claimNumber').value.trim(),
        dateOfLoss: qs('#dateOfLoss').value,
        insurerName: qs('#insurerName').value.trim(),
        phoneNumber: qs('#phoneNumber').value.trim(),
        email: qs('#email').value.trim(),
        claimantAddress: qs('#claimantAddress').value.trim()
      };
      
      // Generate claim header
      const claimHeader = `CLAIM INFORMATION
================
Policyholder: ${claimInfo.claimantName || 'Not provided'}
Address: ${claimInfo.claimantAddress || 'Not provided'}
Phone: ${claimInfo.phoneNumber || 'Not provided'}
Email: ${claimInfo.email || 'Not provided'}

Policy Number: ${claimInfo.policyNumber || 'Not provided'}
Claim Number: ${claimInfo.claimNumber || 'Not provided'}
Date of Loss: ${claimInfo.dateOfLoss || 'Not provided'}
Insurance Company: ${claimInfo.insurerName || 'Not provided'}

Generated: ${new Date().toLocaleDateString()}
Document Type: AI RESPONSE AGENT

========================================

`;
      
      qs('#out').innerHTML='Working…';
      try{ 
        const r=await callAI({inputText:v,type:'ai-agent'}); 
        const response = r.response||r.analysis||JSON.stringify(r)||'(no content)';
        qs('#out').innerHTML = claimHeader + response;
      }
      catch(e){ qs('#out').innerHTML='<div style="color:#ef4444">'+e.message+'</div>'; }
    });
    on(qs('#export'),'click', async ()=>{
      const html=qs('#out').innerHTML.trim(); if(!html) return alert('Analyze first.');
      const r=await createDoc({content:html,format:'pdf',type:'ai-agent',filename:'ai_'+Date.now()}); location.href=r.url||r.downloadUrl;
    });
  </script>
  <script type="module" src="/app/assets/js/diagnostics.js"></script>
</body>
</html>
